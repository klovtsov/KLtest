!| scenario|Prepare Environment|
|Set Permissions               |

!| scenario|Clear Environment|
|Remove Permissions          |


!| scenario                            |Set Permissions                                                                  |
|Set Group Permissions Account Level   |${GroupAccountRequestors}   ||\"${SessionRequestorPolicy}\"                      |
|Set Group Permissions Account Level   |${GroupAccountApprovers}    ||\"${SessionApproverPolicy}\"                       |
|Set Group Permissions Account Level   |${GroupAccountReviewers}    ||\"${SessionReviewerPolicy}\"                       |
|Set Group Permissions Account Level   |${GroupAccountIsas}         ||\"${SessionIsaPolicy}\"                            |
|Set Group Permissions Account Level   |${GroupAccountPacs}         ||\"${SessionPacPolicy}\"                            |
|Set Group Permissions System Level    |${GroupSystemRequestors}    ||\"${SessionRequestorPolicy}\"                      |
|Set Group Permissions System Level    |${GroupSystemApprovers}     ||\"${SessionApproverPolicy}\"                       |
|Set Group Permissions System Level    |${GroupSystemReviewers}     ||\"${SessionReviewerPolicy}\"                       |
|Set Group Permissions System Level    |${GroupSystemIsas}          ||\"${SessionIsaPolicy}\"                            |
|Set Group Permissions System Level    |${GroupSystemPacs}          ||\"${SessionPacPolicy}\"                            |
|Set Group Permissions Collection Level|${GroupCollectionRequestors}||\"${SessionRequestorPolicy}\"||${AccountCollection}|
|Set Group Permissions Collection Level|${GroupCollectionApprovers} ||\"${SessionApproverPolicy}\" ||${AccountCollection}|
|Set Group Permissions Collection Level|${GroupCollectionReviewers} ||\"${SessionReviewerPolicy}\" ||${AccountCollection}|
|Set Group Permissions Collection Level|${GroupCollectionIsas}      ||\"${SessionIsaPolicy}\"      ||${AccountCollection}|
|Set Group Permissions Collection Level|${GroupCollectionPacs}      ||\"${SessionPacPolicy}\"      ||${AccountCollection}|
|Set User Permissions Account Level    |${UserAccountRequestor}     ||\"${SessionRequestorPolicy}\"                      |
|Set User Permissions Account Level    |${UserAccountApprover}      ||\"${SessionApproverPolicy}\"                       |
|Set User Permissions Account Level    |${UserAccountReviewer}      ||\"${SessionReviewerPolicy}\"                       |
|Set User Permissions Account Level    |${UserAccountIsa}           ||\"${SessionIsaPolicy}\"                            |
|Set User Permissions Account Level    |${UserAccountPac}           ||\"${SessionPacPolicy}\"                            |
|Set User Permissions System Level     |${UserSystemRequestor}      ||\"${SessionRequestorPolicy}\"                      |
|Set User Permissions System Level     |${UserSystemApprover}       ||\"${SessionApproverPolicy}\"                       |
|Set User Permissions System Level     |${UserSystemReviewer}       ||\"${SessionReviewerPolicy}\"                       |
|Set User Permissions System Level     |${UserSystemIsa}            ||\"${SessionIsaPolicy}\"                            |
|Set User Permissions System Level     |${UserSystemPac}            ||\"${SessionPacPolicy}\"                            |
|Set User Permissions Collection Level |${UserCollectionRequestor}  ||\"${SessionRequestorPolicy}\"||${SystemCollection} |
|Set User Permissions Collection Level |${UserCollectionApprover}   ||\"${SessionApproverPolicy}\" ||${SystemCollection} |
|Set User Permissions Collection Level |${UserCollectionReviewer}   ||\"${SessionReviewerPolicy}\" ||${SystemCollection} |
|Set User Permissions Collection Level |${UserCollectionIsa}        ||\"${SessionIsaPolicy}\"      ||${SystemCollection} |
|Set User Permissions Collection Level |${UserCollectionPac}        ||\"${SessionPacPolicy}\"      ||${SystemCollection} |
|Set User Permissions On Fake Account  |${UserWithoutPermissions}   ||\"${SessionRequestorPolicy}\"                      |
|pause                                 |${ApplyNewPoliciesInterval}                                                      |


!| scenario                             |Remove Permissions                                                               |
|Remove Group Permissions On Account    |${GroupAccountRequestors}   ||\"${SessionRequestorPolicy}\"                      |
|Remove Group Permissions On Account    |${GroupAccountApprovers}    ||\"${SessionApproverPolicy}\"                       |
|Remove Group Permissions On Account    |${GroupAccountReviewers}    ||\"${SessionReviewerPolicy}\"                       |
|Remove Group Permissions On Account    |${GroupAccountIsas}         ||\"${SessionIsaPolicy}\"                            |
|Remove Group Permissions On Account    |${GroupAccountPacs}         ||\"${SessionPacPolicy}\"                            |
|Remove Group Permissions On System     |${GroupSystemRequestors}    ||\"${SessionRequestorPolicy}\"                      |
|Remove Group Permissions On System     |${GroupSystemApprovers}     ||\"${SessionApproverPolicy}\"                       |
|Remove Group Permissions On System     |${GroupSystemReviewers}     ||\"${SessionReviewerPolicy}\"                       |
|Remove Group Permissions On System     |${GroupSystemIsas}          ||\"${SessionIsaPolicy}\"                            |
|Remove Group Permissions On System     |${GroupSystemPacs}          ||\"${SessionPacPolicy}\"                            |
|Remove Group Permissions On Collection |${GroupCollectionRequestors}||\"${SessionRequestorPolicy}\"||${AccountCollection}|
|Remove Group Permissions On Collection |${GroupCollectionApprovers} ||\"${SessionApproverPolicy}\" ||${AccountCollection}|
|Remove Group Permissions On Collection |${GroupCollectionReviewers} ||\"${SessionReviewerPolicy}\" ||${AccountCollection}|
|Remove Group Permissions On Collection |${GroupCollectionIsas}      ||\"${SessionIsaPolicy}\"      ||${AccountCollection}|
|Remove Group Permissions On Collection |${GroupCollectionPacs}      ||\"${SessionPacPolicy}\"      ||${AccountCollection}|
|Remove User Permissions On Account     |${UserAccountRequestor}     ||\"${SessionRequestorPolicy}\"                      |
|Remove User Permissions On Account     |${UserAccountReviewer}      ||\"${SessionReviewerPolicy}\"                       |
|Remove User Permissions On Account     |${UserAccountApprover}      ||\"${SessionApproverPolicy}\"                       |
|Remove User Permissions On Account     |${UserAccountIsa}           ||\"${SessionIsaPolicy}\"                            |
|Remove User Permissions On Account     |${UserAccountPac}           ||\"${SessionPacPolicy}\"                            |
|Remove User Permissions On System      |${UserSystemRequestor}      ||\"${SessionRequestorPolicy}\"                      |
|Remove User Permissions On System      |${UserSystemApprover}       ||\"${SessionApproverPolicy}\"                       |
|Remove User Permissions On System      |${UserSystemReviewer}       ||\"${SessionReviewerPolicy}\"                       |
|Remove User Permissions On System      |${UserSystemIsa}            ||\"${SessionIsaPolicy}\"                            |
|Remove User Permissions On System      |${UserSystemPac}            ||\"${SessionPacPolicy}\"                            |
|Remove User Permissions On Collection  |${UserCollectionRequestor}  ||\"${SessionRequestorPolicy}\"||${SystemCollection} |
|Remove User Permissions On Collection  |${UserCollectionApprover}   ||\"${SessionApproverPolicy}\" ||${SystemCollection} |
|Remove User Permissions On Collection  |${UserCollectionReviewer}   ||\"${SessionReviewerPolicy}\" ||${SystemCollection} |
|Remove User Permissions On Collection  |${UserCollectionIsa}        ||\"${SessionIsaPolicy}\"      ||${SystemCollection} |
|Remove User Permissions On Collection  |${UserCollectionPac}        ||\"${SessionPacPolicy}\"      ||${SystemCollection} |
|Remove User Permissions On Fake Account|${UserWithoutPermissions}   ||\"${SessionRequestorPolicy}\"                      |




!|scenario      |Session Approved|Requestor|            |Approver|  |Reviewer  |
|Login          |${TPAMURL}      |         |${TPAMAdmin}|        |${DefaultPwd}|
|$Requestor=    |getEval         |var s = "@Requestor";return s;               |
|$Approver=     |getEval         |var s = "@Approver";return s;                |
|$Reviewer=     |getEval         |var s = "@Reviewer";return s;                |
|Logout                                                                        |
|Request Session|$Requestor                                                    |
|Approve Session|$Approver                                                     |
|pause          |15000                                                         |
|Open Session   |$Requestor                                                    |
|Review Session |$Reviewer                                                     |


!|scenario      |Session Privileged|privUser                     |
|Login          |${TPAMURL}        | |${TPAMAdmin}||${DefaultPwd}|
|$Requestor=    |getEval           |var s = "@privUser";return s;|
|Logout                                                          |
|Request Session|$Requestor                                      |
|pause          |15000                                           |
|Open Session   |$Requestor                                      |
|Review Session |${Auditor}                                      |


!|scenario           |Session ISA|isaUser                                        |
|Add PSM-only Account|@isaUser   ||by_@isaUser|with password|${ManagedAccountPwd}|
|Check PSM Account   |by_@isaUser||${SystemName}                                 |


!|scenario         |Add PSM-only Account                        |userName|         |accountName|with password|accountPassword|
|Login             |${TPAMURL}                                  |        |@userName|           |${UserPwd}                   |
|pause             |10000                                                                                                    |
|clickOnLink       |link=Add Account                            |                                                            |
|type;             |id=SystemNm                                 |${SystemName}                                               |
|click             |id=System                                   |                                                            |
|click             |xpath=//td[contains(text(),'${SystemName}')]|                                                            |
|click             |id=Details                                  |                                                            |
|pause             |1000                                                                                                     |
|type;             |id=AccountName                              |@accountName                                                |
|type;             |id=sPswd                                    |@accountPassword                                            |
|type;             |id=sConfPswd                                |@accountPassword                                            |
|click             |id=PSMDetails                               |                                                            |
|pause             |1000                                                                                                     |
|click             |id=cb_EnableFl                              |                                                            |
|select;           |id=ProxyType                                |label=SSH - Automatic Login Using Password                  |
|type;             |id=NotifyFreq                               |60                                                          |
|type;             |id=NotifyThresh                             |1                                                           |
|select;           |id=EgpDurationQtrHrs                        |label=15                                                    |
|select;           |id=EgpDurationHrs                           |label=0                                                     |
|click             |id=cb_RecordingRequiredFl                   |                                                            |
|type;             |id=SessionStartNotifyEmail                  |${SessionStartContactEMail}                                 |
|click             |id=ReviewRequirements                       |                                                            |
|type;             |id=ReviewCnt                                |1                                                           |
|type;             |id=EscalationTime                           |1                                                           |
|type;             |id=EscalationEmail                          |${SessionReviewerEscalationEMail}                           |
|click             |id=SubmitChangesButton                      |                                                            |
|waitForTextPresent|Changes saved successfully for @accountName                                                              |
|Logout                                                                                                                      |


!|scenario                                   |Session Denied|deniedUser|           |restrictedObject|
|Login                                       |${TPAMURL}    |          |@deniedUser|   |${UserPwd}  |
|pause                                       |20000                                                 |
|clickOnLink                                 |link=Add Session Request                              |
|type;                                       |id=SystemNm   |${SystemName}                          |
|type;                                       |id=AccountNm  |${ManagedAccount}                      |
|click                                       |id=Accounts                                           |
|pause                                       |5000                                                  |
|$Where=                                     |getText       |xpath=//table[@id='accountsTable']     |
|Verify_Contain_OR                           |$Where;;${ManagedAccount}                             |
|Logout                                                                                             |
|Set User Permissions @restrictedObject Level|@deniedUser   |          |\"${SessionDeniedPolicy}\"  |
|Login                                       |${TPAMURL}    |          |@deniedUser|   |${UserPwd}  |
|pause                                       |20000                                                 |
|clickOnLink                                 |link=Add Session Request                              |
|waitForElementPresent                       |id=AccountNm                                          |
|type;                                       |id=SystemNm   |${SystemName}                          |
|type;                                       |id=AccountNm  |${ManagedAccount}                      |
|click                                       |id=Accounts                                           |
|pause                                       |5000                                                  |
|$Where=                                     |getText       |xpath=//table[@id='accountsTable']     |
|Verify_Contain_NOT                          |$Where;;${ManagedAccount}                             |
|Logout                                                                                             |
|Remove User Permissions On @restrictedObject|@deniedUser   |          |\"${SessionDeniedPolicy}\"  |


!|scenario                                   |Session Not Denied|deniedUser|           |restrictedObject|
|Login                                       |${TPAMURL}        |          |@deniedUser|   |${UserPwd}  |
|pause                                       |20000                                                     |
|clickOnLink                                 |link=Add Session Request                                  |
|type;                                       |id=SystemNm       |${SystemName}                          |
|type;                                       |id=AccountNm      |${ManagedAccount}                      |
|click                                       |id=Accounts                                               |
|pause                                       |5000                                                      |
|$Where=                                     |getText           |xpath=//table[@id='accountsTable']     |
|Verify_Contain_OR                           |$Where;;${ManagedAccount}                                 |
|Logout                                                                                                 |
|Set User Permissions @restrictedObject Level|@deniedUser       |          |\"${SessionDeniedPolicy}\"  |
|Login                                       |${TPAMURL}        |          |@deniedUser|   |${UserPwd}  |
|pause                                       |20000                                                     |
|clickOnLink                                 |link=Add Session Request                                  |
|waitForElementPresent                       |id=AccountNm                                              |
|type;                                       |id=SystemNm       |${SystemName}                          |
|type;                                       |id=AccountNm      |${ManagedAccount}                      |
|click                                       |id=Accounts                                               |
|pause                                       |5000                                                      |
|$Where=                                     |getText           |xpath=//table[@id='accountsTable']     |
|Verify_Contain_OR                           |$Where;;${ManagedAccount}                                 |
|Logout                                                                                                 |
|Remove User Permissions On @restrictedObject|@deniedUser       |          |\"${SessionDeniedPolicy}\"  |


!|scenario                            |Session Requires PPM  |requestorName  |                   |ppmObject                                |
|Change PSM Proxy                     |${SystemName}         |               |${ManagedAccount}  |  |SSH - Interactive Login               |
|Login                                |${TPAMURL}            |               |@requestorName     |  |${UserPwd}                            |
|pause                                |10000                                                                                               |
|clickOnLink                          |link=Add Session Request                                                                            |
|type;                                |id=SystemNm           |${SystemName}                                                                |
|type;                                |id=AccountNm          |${ManagedAccount}                                                            |
|click                                |id=Accounts           |                                                                             |
|click                                |xpath=//input[@type='checkbox']                                                                     |
|click                                |id=Details                                                                                          |
|type;                                |id=RequestReason      |session request reason                                                       |
|click                                |id=SubmitChanges                                                                                    |
|$res=                                |getText               |xpath=//div[@id='ResultsDiv']                                                |
|Verify_Contain_OR                    |$res;;This account requires the password to be released and you don't have the necessary permissions|
|pause                                |1000                                                                                                |
|Logout                                                                                                                                    |
|Set User Permissions @ppmObject Level|@requestorName        |               |\"${PasswordRequestorPolicy}\"                               |
|Login                                |${TPAMURL}            |               |@requestorName     |  |${UserPwd}                            |
|pause                                |10000                                                                                               |
|clickOnLink                          |link=Add Session Request                                                                            |
|type;                                |id=SystemNm           |${SystemName}                                                                |
|type;                                |id=AccountNm          |${ManagedAccount}                                                            |
|click                                |id=Accounts           |                                                                             |
|click                                |xpath=//input[@type='checkbox']                                                                     |
|click                                |id=Details                                                                                          |
|type;                                |id=RequestReason      |session request reason                                                       |
|click                                |id=SubmitChanges                                                                                    |
|pause                                |1000                                                                                                |
|type;                                |id=ResponseComment    |cancel                                                                       |
|click                                |id=SubmitChanges                                                                                    |
|waitForTextPresent                   |*The response * was submitted successfully*                                                         |
|Logout                                                                                                                                    |
|Remove User Permissions On @ppmObject|@requestorName        |               |\"${PasswordRequestorPolicy}\"                               |
|Change PSM Proxy                     |${SystemName}         |               |${ManagedAccount}  |  |SSH - Automatic Login Using Password  |



!|scenario        |Change PSM Proxy|systemName               |               |accountName               |              |proxyType              |
|$res=            |CLI             |${CLIBatch} UpdatePSMAccount --SystemName @systemName --AccountName @accountName --ProxyType \"@proxyType\"|
|Verify_Contain_OR|$res;;successful                                                                                                            |





!|scenario                            |Session Denied on Collection Level|deniedUser|                          |collectionName  |
|Login                                |${TPAMURL}                        |          |@deniedUser               ||${UserPwd}     |
|pause                                |10000                                                                                    |
|clickOnLink                          |link=Add Session Request                                                                 |
|type;                                |id=SystemNm                       |${SystemName}                                         |
|type;                                |id=AccountNm                      |${ManagedAccount}                                     |
|click                                |id=Accounts                                                                              |
|pause                                |5000                                                                                     |
|$Where=                              |getText                           |xpath=//table[@id='accountsTable']                    |
|Verify_Contain_OR                    |$Where;;${ManagedAccount}                                                                |
|Logout                                                                                                                         |
|Set User Permissions Collection Level|@deniedUser                       |          |\"${SessionDeniedPolicy}\"||@collectionName|
|Login                                |${TPAMURL}                        |          |@deniedUser               ||${UserPwd}     |
|pause                                |10000                                                                                    |
|clickOnLink                          |link=Add Session Request                                                                 |
|type;                                |id=SystemNm                       |${SystemName}                                         |
|type;                                |id=AccountNm                      |${ManagedAccount}                                     |
|click                                |id=Accounts                                                                              |
|pause                                |5000                                                                                     |
|$Where=                              |getText                           |xpath=//table[@id='accountsTable']                    |
|Verify_Contain_NOT                   |$Where;;${ManagedAccount}                                                                |
|Logout                                                                                                                         |
|Remove User Permissions On Collection|@deniedUser                       |          |\"${SessionDeniedPolicy}\"||@collectionName|



!|scenario                            |Session Not Denied on Collection Level|deniedUser|                          |collectionName  |
|Login                                |${TPAMURL}                            |          |@deniedUser               ||${UserPwd}     |
|pause                                |10000                                                                                        |
|clickOnLink                          |link=Add Session Request                                                                     |
|type;                                |id=SystemNm                           |${SystemName}                                         |
|type;                                |id=AccountNm                          |${ManagedAccount}                                     |
|click                                |id=Accounts                                                                                  |
|pause                                |5000                                                                                         |
|$Where=                              |getText                               |xpath=//table[@id='accountsTable']                    |
|Verify_Contain_OR                    |$Where;;${ManagedAccount}                                                                    |
|Logout                                                                                                                             |
|Set User Permissions Collection Level|@deniedUser                           |          |\"${SessionDeniedPolicy}\"||@collectionName|
|Login                                |${TPAMURL}                            |          |@deniedUser               ||${UserPwd}     |
|pause                                |10000                                                                                        |
|clickOnLink                          |link=Add Session Request                                                                     |
|type;                                |id=SystemNm                           |${SystemName}                                         |
|type;                                |id=AccountNm                          |${ManagedAccount}                                     |
|click                                |id=Accounts                                                                                  |
|pause                                |5000                                                                                         |
|$Where=                              |getText                               |xpath=//table[@id='accountsTable']                    |
|Verify_Contain_OR                    |$Where;;${ManagedAccount}                                                                    |
|Logout                                                                                                                             |
|Remove User Permissions On Collection|@deniedUser                           |          |\"${SessionDeniedPolicy}\"||@collectionName|


!|scenario                                |Session Without Permissions|deniedUser|             |allowedObject  |
|Login                                    |${TPAMURL}                 |          |@deniedUser  |  |${UserPwd}  |
|pause                                    |20000                                                               |
|clickOnLink                              |link=Add Session Request                                            |
|type;                                    |id=SystemNm                |${SystemName}                           |
|type;                                    |id=AccountNm               |${ManagedAccount}                       |
|click                                    |id=Accounts                                                         |
|pause                                    |5000                                                                |
|$Where=                                  |getText                    |xpath=//table[@id='accountsTable']      |
|Verify_Contain_NOT                       |$Where;;${ManagedAccount}                                           |
|Logout                                                                                                        |
|Set User Permissions @allowedObject Level|@deniedUser                |          |\"${SessionRequestorPolicy}\"|
|Login                                    |${TPAMURL}                 |          |@deniedUser  |  |${UserPwd}  |
|pause                                    |20000                                                               |
|clickOnLink                              |link=Add Session Request                                            |
|waitForElementPresent                    |id=AccountNm                                                        |
|type;                                    |id=SystemNm                |${SystemName}                           |
|type;                                    |id=AccountNm               |${ManagedAccount}                       |
|click                                    |id=Accounts                                                         |
|pause                                    |5000                                                                |
|$Where=                                  |getText                    |xpath=//table[@id='accountsTable']      |
|Verify_Contain_OR                        |$Where;;${ManagedAccount}                                           |
|Logout                                                                                                        |
|Remove User Permissions On @allowedObject|@deniedUser                |          |\"${SessionRequestorPolicy}\"|




############## Manage Sessions #####################



!|scenario        |Set Approvers Count|SystemName                                   |                                  |AccountName                                  |                                  |ApprCount                                  |
|$res=            |CLI                |${CLIBatch} UpdatePSMAccount --SystemName @SystemName --AccountName @AccountName --MinApprovers @ApprCount --EscalationEmail ${ReviewerEscalationEMail} --SessionStartNotifyEmail ${SessionStartContactEMail}|
|Verify_Contain_OR|$res;;successful                                                                                                                                                                                                                 |


!| scenario       |Request Session      |ForUser                                                                                                                            |
|$res=            |CLI                  |${CLIBatch} AddSessionRequest --SystemName ${SystemName} --AccountName ${ManagedAccount} --ForUserName @ForUser --RequestNotes test|
|Verify_Contain_OR|$res;;submitted                                                                                                                                          |
|$RequestID=      |get_session_RequestID|$res                                                                                                                               |

!| scenario        |Request Session via UI Not Immediate|System   |           |Account  |  |ForUser  |  |Result  |
|Login             |${TPAMURL}                          |         |@ForUser   |         |${UserPwd}              |
|pause             |20000                                                                                        |
|clickOnLink       |link=Add Session Request                                                                     |
|type;             |id=SystemNm                         |@System                                                 |
|type;             |id=AccountNm                        |@Account                                                |
|click             |id=Accounts                         |                                                        |
|click             |xpath=//input[@type='checkbox']                                                              |
|click             |id=Details                                                                                   |
|type;             |id=RequestReason                    |session request reason                                  |
|click             |id=cb_Immed                                                                                  |
|$Years=           |getEval                             |var d = new Date();var s= d.getUTCFullYear()+1;return s;|
|type;             |id=Year                             |$Years                                                  |
|click             |id=SubmitChanges                                                                             |
|waitForTextPresent|@Result                                                                                      |
|Logout                                                                                                          |

!|scenario         |Approve Session    |Approver               |
|Login             |${TPAMURL}         | |@Approver||${UserPwd}|
|pause             |10000                                      |
|click             |id=Approvals                               |
|click             |link=$RequestID                            |
|type;             |id=ResponseComment |ok to approve          |
|click             |id=ApproveReq                              |
|waitForTextPresent|*The response * was submitted successfully*|
|Logout                                                        |


!|scenario         |Review Session     |Reviewer              |
|Login             |${TPAMURL}         ||@Reviewer||${UserPwd}|
|pause             |10000                                     |
|click             |id=PendingReviews                         |
|click             |link=$RequestID                           |
|type;             |id=NewReviewComment|I saw it              |
|pause             |5000                                      |
|click             |id=CompleteReviewButton                   |
|waitForTextPresent|*Saved Successfully*                      |
|Logout                                                       |

!|scenario   |Open Session      |Requestor              |
|Login       |${TPAMURL}        ||@Requestor||${UserPwd}|
|pause       |10000                                     |
|click       |id=CurrentRequests                        |
|click       |link=$RequestID                           |
|click       |id=StartSessionButton                     |
|pause       |30000                                     |
|selectWindow|Quest Software PSM                        |
|stop                                                   |
|selectWindow|Quest Software TPAM                       |
|type;       |id=ResponseComment|cancel                 |
|pause       |5000                                      |
|click       |id=SubmitChanges                          |
|Logout                                                 |
#|waitForTextPresent|*The response * was submitted successfully*|


!|scenario                          |Change Settings                             |
|Login                              |${TPAMAdminURL}||${TPAMMaster}||${MasterPwd}|
|pause                              |20000                                       |
|Change Review Notification Settings|2              ||1                          |
|Logout                                                                          |

!|scenario            |Check PSM Account                          |accountName  |             |systemName      |
|Login                |${TPAMURL}                                 |             |${TPAMAdmin} | |${DefaultPwd} |
|clickOnLink          |link=Manage Accounts                                                                    |
|type;                |id=SystemNm                                |@systemName                                 |
|type;                |id=AccountNm                               |@accountName                                |
|click                |id=Listing                                 |                                            |
|click                |xpath=//td[contains(text(),'@accountName')]|                                            |
|click                |id=Details                                 |                                            |
|waitForElementPresent|xpath=//input[@id='RelNotifyEmail']                                                     |
|$res=                |isChecked                                  |id=cb_AcctLockFl                            |
|Verify_Contain_OR    |$res;;false                                                                             |
|$res=                |getSelectedLabel                           |id=PwdRule                                  |
|Verify_Contain_OR    |$res;;Default Password Rule                                                             |
|$res=                |isChecked                                  |id=cb_ChgSvc                                |
|Verify_Contain_OR    |$res;;false                                                                             |
|$res=                |isChecked                                  |id=cb_UseSelf                               |
|Verify_Contain_OR    |$res;;false                                                                             |
|$res=                |isChecked                                  |id=pwdMgmtNone                              |
|Verify_Contain_OR    |$res;;true                                                                              |
|$res=                |isChecked                                  |id=pwdMgmtAuto                              |
|Verify_Contain_OR    |$res;;false                                                                             |
|$res=                |isChecked                                  |id=pwdMgmtManual                            |
|Verify_Contain_OR    |$res;;false                                                                             |
|$res=                |getValue                                   |xpath=//input[@id='MinApprovers']           |
|Verify_Contain_OR    |$res;;0                                                                                 |
|$res=                |getSelectedLabel                           |id=MaxDurationDays                          |
|Verify_Contain_OR    |$res;;7                                                                                 |
|$res=                |getSelectedLabel                           |id=MaxDurationHrs                           |
|Verify_Contain_OR    |$res;;0                                                                                 |
|$res=                |getSelectedLabel                           |id=MaxDurationQtrHrs                        |
|Verify_Contain_OR    |$res;;0                                                                                 |
|$res=                |getValue                                   |xpath=//input[@id='SimulPrivAccReleases']   |
|Verify_Contain_OR    |$res;;1                                                                                 |
|$res=                |isChecked                                  |id=cb_OverrideAccountabilityFl              |
|Verify_Contain_OR    |$res;;false                                                                             |
|click                |id=Reviews                                 |                                            |
|waitForElementPresent|xpath=//input[@id='PwdEscalationEmail']                                                 |
|$res=                |getValue                                   |xpath=//input[@id='PwdReviewCnt']           |
|Verify_Contain_OR    |$res;;0                                                                                 |
|$res=                |isChecked                                  |id=PwdReviewerType0                         |
|Verify_Contain_OR    |$res;;true                                                                              |
|$res=                |isChecked                                  |id=PwdReviewerType1                         |
|Verify_Contain_OR    |$res;;false                                                                             |
|$res=                |isChecked                                  |id=PwdReviewerType2                         |
|Verify_Contain_OR    |$res;;false                                                                             |
|$res=                |isChecked                                  |id=PwdReviewerType3                         |
|Verify_Contain_OR    |$res;;false                                                                             |
|click                |id=TicketSystem                                                                         |
|$res=                |isChecked                                  |id=cb_ReqTixOverall                         |
|Verify_Contain_OR    |$res;;false                                                                             |
|$res=                |getSelectedLabel                           |id=TSID                                     |
|Verify_Contain_OR    |$res;;Any Ticket System                                                                 |
|$res=                |isChecked                                  |id=cb_ReqTixISA                             |
|Verify_Contain_OR    |$res;;false                                                                             |
|$res=                |isChecked                                  |id=cb_ReqTixCLI                             |
|Verify_Contain_OR    |$res;;false                                                                             |
|$res=                |isChecked                                  |id=cb_ReqTixAPI                             |
|Verify_Contain_OR    |$res;;false                                                                             |
|click                |id=PSMDetails                                                                           |
|waitForElementPresent|xpath=//input[@id='SessionStartNotifyEmail']                                            |
|$res=                |isChecked                                  |id=cb_EnableFl                              |
|Verify_Contain_OR    |$res;;true                                                                              |
|$res=                |getSelectedLabel                           |id=ProxyType                                |
|Verify_Contain_OR    |$res;;SSH - Automatic Login Using Password                                              |
|$res=                |getSelectedLabel                           |id=ConnectProfileID                         |
|Verify_Contain_OR    |$res;;Use Standard Settings                                                             |
|$res=                |getSelectedLabel                           |id=PostSessionProfileID                     |
|Verify_Contain_OR    |$res;;Use Standard Settings                                                             |
|$res=                |getValue                                   |xpath=//input[@id='EgpMinApprovers']        |
|Verify_Contain_OR    |$res;;0                                                                                 |
|$res=                |getValue                                   |xpath=//input[@id='MaxSessionCnt']          |
|Verify_Contain_OR    |$res;;1                                                                                 |
|$res=                |getSelectedLabel                           |id=EgpDurationDays                          |
|Verify_Contain_OR    |$res;;0                                                                                 |
|$res=                |getSelectedLabel                           |id=EgpDurationHrs                           |
|Verify_Contain_OR    |$res;;0                                                                                 |
|$res=                |getSelectedLabel                           |id=EgpDurationQtrHrs                        |
|Verify_Contain_OR    |$res;;15                                                                                |
|$res=                |getValue                                   |xpath=//input[@id='NotifyFreq']             |
|Verify_Contain_OR    |$res;;60                                                                                |
|$res=                |getValue                                   |xpath=//input[@id='NotifyThresh']           |
|Verify_Contain_OR    |$res;;1                                                                                 |
|$res=                |getValue                                   |xpath=//input[@id='SessionStartNotifyEmail']|
|Verify_Contain_OR    |$res;;${SessionStartContactEMail}                                                       |
|$res=                |isChecked                                  |id=cb_ClipboardFl                           |
|Verify_Contain_OR    |$res;;true                                                                              |
|$res=                |isChecked                                  |id=cb_ConsoleFl                             |
|Verify_Contain_OR    |$res;;false                                                                             |
|$res=                |isChecked                                  |id=cb_RecordingRequiredFl                   |
|Verify_Contain_OR    |$res;;false                                                                             |
|$res=                |isChecked                                  |id=cb_FileTransUpFl                         |
|Verify_Contain_OR    |$res;;false                                                                             |
|$res=                |isChecked                                  |id=cb_FileTransDownFl                       |
|Verify_Contain_OR    |$res;;false                                                                             |
|click                |id=SessionAuthentication                                                                |
|waitForElementPresent|id=PassMeth0                                                                            |
|$res=                |isChecked                                  |id=PassMeth0                                |
|Verify_Contain_OR    |$res;;true                                                                              |
|$res=                |isChecked                                  |id=PassMeth1                                |
|Verify_Contain_OR    |$res;;false                                                                             |
|click                |id=FileTransfer                                                                         |
|waitForElementPresent|id=FileTransTypeID                                                                      |
|$res=                |getSelectedLabel                           |id=FileTransTypeID                          |
|Verify_Contain_OR    |$res;;File Transfer Disabled                                                            |
|$res=                |isChecked                                  |id=FileTransAuthMeth0                       |
|Verify_Contain_OR    |$res;;true                                                                              |
|$res=                |isChecked                                  |id=FileTransAuthMeth1                       |
|Verify_Contain_OR    |$res;;false                                                                             |
|click                |id=ReviewRequirements                                                                   |
|waitForElementPresent|xpath=//input[@id='EscalationEmail']                                                    |
|$res=                |getValue                                   |xpath=//input[@id='ReviewCnt']              |
|Verify_Contain_OR    |$res;;1                                                                                 |
|$res=                |isChecked                                  |id=ReviewerType0                            |
|Verify_Contain_OR    |$res;;true                                                                              |
|$res=                |isChecked                                  |id=ReviewerType1                            |
|Verify_Contain_OR    |$res;;false                                                                             |
|$res=                |isChecked                                  |id=ReviewerType2                            |
|Verify_Contain_OR    |$res;;false                                                                             |
|$res=                |isChecked                                  |id=ReviewerType3                            |
|Verify_Contain_OR    |$res;;false                                                                             |
|$res=                |getValue                                   |xpath=//input[@id='EscalationTime']         |
|Verify_Contain_OR    |$res;;1                                                                                 |
|$res=                |getValue                                   |xpath=//input[@id='EscalationEmail']        |
|Verify_Contain_OR    |$res;;${SessionReviewerEscalationEMail}                                                 |
|Logout                                                                                                        |


!|scenario         |Disable-Enable PPM                                 |
|Choose system                                                         |
|pause             |3000                                               |
|click             |id=cb_EgpOnlyFl                                    |
|pause             |1000                                               |
|click             |id=bt_Save                                         |
|waitForTextPresent|System changes for ${SystemName} saved successfully|

!|scenario         |BFERs 6965 7015 Check Refresh Policy Button                                                                                                          |
|$res=             |GroovyWebDriver|CheckRefreshPolicyButton;${TPAMHost};${TPAMAdmin};${DefaultPwd};${SystemName};${ManagedAccount};${FileName};${SessionRequestorPolicy}|
|Verify_Contain_OR |$res;;System Policy Details Refreshed Successfully                                                                                                   |
|Verify_Contain_OR |$res;;User Policy Details Refreshed Successfully                                                                                                     |
|Verify_Contain_OR |$res;;Account Policy Details Refreshed Successfully                                                                                                  |
|Verify_Contain_OR |$res;;File Policy Details Refreshed Successfully                                                                                                     |
|Verify_Contain_NOT|$res;;Wrong Policy Selected                                                                                                                          |
|Verify_Contain_NOT|$res;;something went wrong                                                                                                                           |

!|scenario         |BFER 6965 Check Refresh Policy Button                                                                                                    |
|$res=             |GroovyWebDriver|CheckRefreshPolicyButton;${TPAMHost};${TPAMAdmin};${DefaultPwd};${SystemName};${ManagedAccount};${SessionRequestorPolicy}|
|Verify_Contain_OR |$res;;System Policy Details Refreshed Successfully                                                                                       |
|Verify_Contain_OR |$res;;User Policy Details Refreshed Successfully                                                                                         |
|Verify_Contain_OR |$res;;Account Policy Details Refreshed Successfully                                                                                      |
|Verify_Contain_NOT|$res;;Wrong Policy Selected                                                                                                              |
|Verify_Contain_NOT|$res;;something went wrong                                                                                                               |




