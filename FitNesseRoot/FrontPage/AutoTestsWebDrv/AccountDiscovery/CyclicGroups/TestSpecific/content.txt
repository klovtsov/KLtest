!|scenario                  |Create Groups with Account on System|Account      |           |GroupName1||GroupName2|
|Create Account on AD System|@Account                            |with password|acntpwd                           |
|Manage Groups on AD System |@Account                            |             |@GroupName1|          |@GroupName2|

!|scenario        |Manage Groups on AD System|accntName                |                |GroupName1                |                |GroupName2               |
|$res=            |PowerShellScript          |manageADgroups.ps1 create ${dcName} ${NETBIOSDomainName}\${FunctAcct} ${FunctAcctPwd} @GroupName1               |
|Verify_Contain_OR|$res;;successful                                                                                                                           |
|$res=            |PowerShellScript          |manageADgroups.ps1 create ${dcName} ${NETBIOSDomainName}\${FunctAcct} ${FunctAcctPwd} @GroupName2               |
|Verify_Contain_OR|$res;;successful                                                                                                                           |
|$res=            |PowerShellScript          |manageADgroups.ps1 addmember ${dcName} ${NETBIOSDomainName}\${FunctAcct} ${FunctAcctPwd} @GroupName1 @accntName |
|Verify_Contain_OR|$res;;successful                                                                                                                           |
|$res=            |PowerShellScript          |manageADgroups.ps1 addmember ${dcName} ${NETBIOSDomainName}\${FunctAcct} ${FunctAcctPwd} @GroupName2 @accntName |
|Verify_Contain_OR|$res;;successful                                                                                                                           |
|$res=            |PowerShellScript          |manageADgroups.ps1 addmember ${dcName} ${NETBIOSDomainName}\${FunctAcct} ${FunctAcctPwd} @GroupName1 @GroupName2|
|Verify_Contain_OR|$res;;successful                                                                                                                           |
|$res=            |PowerShellScript          |manageADgroups.ps1 addmember ${dcName} ${NETBIOSDomainName}\${FunctAcct} ${FunctAcctPwd} @GroupName2 @GroupName1|
|Verify_Contain_OR|$res;;successful                                                                                                                           |


!|scenario                  |Delete Groups and Account on System|Account||GroupName1||GroupName2|
|Delete Account on AD System|@Account                                                           |
|Delete Groups on AD System |@GroupName1                        |       |@GroupName2            |

!|scenario        |Delete Groups on AD System|GroupName1                         |                         |GroupName2                         |
|$res=            |PowerShellScript          |manageADgroups.ps1 delete ${dcName} ${NETBIOSDomainName}\${FunctAcct} ${FunctAcctPwd} @GroupName1|
|Verify_Contain_OR|$res;;successful                                                                                                            |
|$res=            |PowerShellScript          |manageADgroups.ps1 delete ${dcName} ${NETBIOSDomainName}\${FunctAcct} ${FunctAcctPwd} @GroupName2|
|Verify_Contain_OR|$res;;successful                                                                                                            |



!|scenario                         |New Account Action           |
|Remove account                    |${UserName1}                 |
|Set AccDiscovery profile to System|${ProfileName}||${SystemName}|
|Run AccDiscovery                                                |
|Check results                     |${UserName1}  ||${SystemName}|

!|scenario                           |Create Environment                        |
|Create Groups with Account on System|${UserName1}||${GroupName1}||${GroupName2}|
|Create Template                                                                |
|Create Account Discovery Profile                                               |

!|scenario                    |Create Account Discovery Profile                                                                                                                                         |
|clickOnLink                  |link=Profile Management                                                                                                                                                  |
|select;                      |id=ProfileType          |label=Account Discovery                                                                                                                         |
|waitForElementPresent        |id=NewButton            |                                                                                                                                                |
|click                        |id=NewButton                                                                                                                                                             |
|type;                        |id=ProfileName          |${ProfileName}                                                                                                                                  |
|type;                        |id=Description          |Description                                                                                                                                     |
|Set Delete Account properties|Both (Notify & Turn Off)||${DeleteAccountDiscoveryEmail1},:System:,:Functional:                                                                                          |
|Add Detail                   |0                       ||Both (Notify & Create)||${TemplateName}/${AutoDiscoveryAccount1}||${NewAccountDiscoveryEmail1},:System:,:Functional:||||||||${GroupName1}|||||||
|click                        |className=autoServiceFl                                                                                                                                                  |
|click                        |className=autoSchedTaskFl                                                                                                                                                |
|click                        |id=SaveButton                                                                                                                                                            |
|waitForTextPresent           |The profile saved successfully                                                                                                                                           |

!|scenario                          |Delete Environment                                                 |
|Set AccDiscovery profile to System |No Account Discovery Profile selected||${SystemName}               |
|Remove system                      |${SystemName}                                                      |
|Delete Account Discovery Profile   |${ProfileName}                                                     |
|Remove system                      |${TemplateName}                                                    |
|Delete Groups and Account on System|${UserName1}                         ||${GroupName1}||${GroupName2}|

!|scenario|Account Discovery                      |
|Open     |${TPAMURL}||${TPAMAdmin}||${DefaultPwd}|
|Create Environment                               |
|New Account Action                               |
|Delete Environment                               |



!|scenario|Add Detail                  |Index||NewAccountAction||TemplateAccount||EmailAddresses||UID||SID||Name||Group||Role||Task||Service|
|click    |id=btnAddRow                                                                                                                     |
|select;  |className=autoNewAction     |label=@NewAccountAction                                                                             |
|select;  |className=autoAcctTemplate  |label=@TemplateAccount                                                                              |
|type;    |className=autoEmailAddresses|@EmailAddresses                                                                                     |
|type;    |className=autoSIDFilter     |@SID                                                                                                |
|type;    |className=autoNameFilter    |@Name                                                                                               |
|type;    |className=autoGroupFilter   |@Group                                                                                              |
