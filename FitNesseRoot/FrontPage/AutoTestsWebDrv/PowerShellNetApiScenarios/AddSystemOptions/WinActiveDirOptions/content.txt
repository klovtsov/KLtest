!* Test Description
Options -DomainName and -NetBiosName are tested.
First test checks Non-Privileged Functional Account value by listSystem command
Second one tests that it is possible to manage passwords on system using Non-Privileged Functional Account and UseSelf flags.
*!
!include <AutoTestsWebDrv.PlatformsTesting.EdmzSpcwDc2
!define SystemName {${prefix}_winad}
!define SystemPlatform {Windows Active Dir}
!define dcName {w2k8r2DC}

!include -c  <PowerShellNetApiScenarios.ScenarioLibrary

!|script                                                                                                                                                                                                                                                                                        |
|Add system     |${SystemName}            |with address |${SystemAddress}                               |platform|"${SystemPlatform}"|managed by|${FunctAcct}|additional parameters|-functAcctPwd ${FunctAcctPwd} -domainName ${DomainName} -NetBiosName ${NETBIOSDomainName} -NonPrivFuncFlag Y|
|Test System    |${TestSystemSuccessful}                                                                                                                                                                                                                                                        |
|List Systems by|-systemName ${SystemName}|output params|SystemName,DomainName,NetBiosName,nonPrivFuncFl|contain |${SystemName}.*${DomainName}.*${NETBIOSDomainName}.*Y                                                                                                                         |
|Delete System  |${SystemName}                                                                                                                                                                                                                                                                  |

!3 Test how setting works
!define NonPrivelegedFuncAcct {Wasser}

!|script                                                                                                                                                                                                                                                                 |
|Create Account on AD System|${NonPrivelegedFuncAcct}|with password|${FunctAcctPwd}                                                                                                                                                                                         |
|Create Account on AD System|${ManagedAccount}       |with password|${ManagedAccountPwdNew}                                                                                                                                                                                |
|Add system              |${SystemName}           |with address |${SystemAddress}       |platform|"${SystemPlatform}"|managed by|${NonPrivelegedFuncAcct}|additional parameters|-functAcctPwd ${FunctAcctPwd} -domainName ${DomainName} -NetBiosName ${NETBIOSDomainName}|
|Test System             |${TestSystemSuccessful}                                                                                                                                                                                                                        |
|Add account             |${ManagedAccount}       |with password|${ManagedAccountPwdNew}                                                                                                                                                                                 |
|Reset Password          |${ResetPasswordFailed}                                                                                                                                                                                                                         |
!note Label the functional account as non-privileged and update the managed account to use their password 
!|script                                                                                                 |
|Update System        |${SystemName}    ||-NonPrivFuncFlag Y|by user|${API_user_1}                       |
|Try to Update Account|${ManagedAccount}||-UseSelfFlag Y    |by user|${API_user_1}|with result|successful|
|Test System          |${TestSystemSuccessful}                                                           |
|Reset Password       |${ResetPasswordSuccessful}                                                        |
!*> Delete system and accounts
!|script                                          |
|Delete System           |${SystemName}           |
|Delete Account on AD System|${NonPrivelegedFuncAcct}|
|Delete Account on AD System|${ManagedAccount}       |
*!
