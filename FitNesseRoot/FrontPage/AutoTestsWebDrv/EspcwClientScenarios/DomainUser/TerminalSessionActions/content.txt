!include -c <AutoTestsWebDrv.ScenarioLibrary
!include -c <AutoTestsWebDrv.CliScenarios.ScenarioLibrary
!include -c <AutoTestsWebDrv.EspcwClientScenarios.LocalUser.TerminalSessionActions.PlatformSpecific
!note Terminal Session Actions: N - None, D - Disconnect, L - Logout

!|script                                                                                                                       |
|Add                              |${ManagedAccountDomain}\${ManagedAccount}|to the group |Remote Desktop Users   |on|${DMSystemAddress}|
|Change Account Password on System|${ManagedAccountPwdNew}                                                                     |
|Create Terminal Session for      |${ManagedAccountDomain}\${ManagedAccount} |with password|${ManagedAccountPwdNew}|on|${DMSystemAddress}|
|pause                            |100000                                                                                      |
|Check Terminal session is        |Active                          |for          |${ManagedAccount}      |on|${DMSystemAddress}|
|Set Terminal Session Action      |N                               |for user     |DEFAULT                |on|${DMSystemAddress}|
|Reset Password                   |${ManagedAccount}               |             |${ResetPasswordSuccessful}                   |
|pause                            |${ExecDelay}                                                                                |
|Check Terminal session is        |Active                          |for          |${ManagedAccount}      |on|${DMSystemAddress}|
|Set Terminal Session Action      |D                               |for user     |DEFAULT                |on|${DMSystemAddress}|
|Reset Password                   |${ManagedAccount}               |             |${ResetPasswordSuccessful}                   |
|pause                            |${ExecDelay}                                                                                |
|TSDisconnectionConfirmation                                                                                                   |
|Check Terminal session is        |Disc                            |for          |${ManagedAccount}      |on|${DMSystemAddress}|
|Change Account Password on System|${ManagedAccountPwdNew}                                                                     |
|Create Terminal Session for      |${ManagedAccountDomain}\${ManagedAccount} |with password|${ManagedAccountPwdNew}|on|${DMSystemAddress}|
|pause                            |100000                                                                                      |
|Check Terminal session is        |Active                          |for          |${ManagedAccount}      |on|${DMSystemAddress}|
|Set Terminal Session Action      |L                               |for user     |DEFAULT                |on|${DMSystemAddress}|
|Check Password                   |${ManagedAccount}               |             |${CheckPasswordNotMatch}                     |
|pause                            |${ExecDelay}                                                                                |
|TSLogoffConfirmation                                                                                                          |
|Set Terminal Session Action      |N                               |for user     |DEFAULT                |on|${DMSystemAddress}|

