!include -c <AutomatedTesting.ScenarioLibrary
!include -c <AutomatedTesting.CliScenarios.ScenarioLibrary
!include -c <AutomatedTesting.EspcwClientScenarios.DomainUser.ScenarioLibrary
!include -c <AutomatedTesting.EspcwClientScenarios.LocalUser.ChangeComObjects.TestSpecific

!define ServiceAccount {${ManagedAccountDomain}\${ManagedAccount}}
!define SuccessAppStartResult {EXIT 0}
!define FailAppStartResult {EXIT -2147467238}

!|script                                                                                                                                |
|Change Account Password on System     |${ManagedAccountPwdNew}                                                                         |
|Create Com Application which is run by|${ServiceAccount}       |and run under password is|${ManagedAccountPwdNew}|on|${DMSystemAddress}|
|Check Checkbox                        |changecomplus           |for user                 |DEFAULT                                      |
|Reset Password                        |${ManagedAccount}       |                         |${ResetPasswordSuccessful}                   |
|pause                                 |${ExecDelay}                                                                                    |
|Start Com Application                 |${SuccessAppStartResult}|on                       |${DMSystemAddress}                           |
|Stop Com Application on               |${DMSystemAddress}                                                                              |
|Uncheck Checkbox                      |changecomplus           |for user                 |DEFAULT                                      |
|Reset Password                        |${ManagedAccount}       |                         |${ResetPasswordSuccessful}                   |
|pause                                 |${ExecDelay}                                                                                    |
|Start Com Application                 |${FailAppStartResult}   |on                       |${DMSystemAddress}                           |
|Delete Com Application on             |${DMSystemAddress}                                                                              |


