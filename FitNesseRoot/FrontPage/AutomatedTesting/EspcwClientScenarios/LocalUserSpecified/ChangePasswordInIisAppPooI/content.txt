!define AppPoolName {TpamAppPool}
!include -c <AutomatedTesting.ScenarioLibrary
!include -c <AutomatedTesting.CliScenarios.ScenarioLibrary
!include -c <AutomatedTesting.EspcwClientScenarios.LocalUser.ScenarioLibrary
!include -c <AutomatedTesting.EspcwClientScenarios.LocalUser.ChangePasswordInIisMetabase.PlatformSpecific

!|script                                                                                                                                                  |
|Create Application Pool          |${AppPoolName}   |on      |${SystemAddress}|with identity           |${ManagedAccount}|password|${ManagedAccountPwdNew}|
|Uncheck Checkbox                 |changemeta                               |for user     |${ManagedAccount}                                                     |
|Check Checkbox                   |changemeta                               |for user     |DEFAULT                                                               |
|Change Account Password on System|${ManagedAccountPwdNew}                                                                                                |
|Check Password                   |${ManagedAccount}|        |${CheckPasswordNotMatch}                                                                    |
|pause                            |45000                                                                                                                  |
|Check Application Pool           |${AppPoolName}   |on      |${SystemAddress}|password is equal to    |${ManagedAccountPwdNew}                           |
|Uncheck Checkbox                 |changemeta                               |for user     |DEFAULT                                                               |
|Check Checkbox                   |changemeta                               |for user     |${ManagedAccount}                                                     |
|Change Account Password on System|${ManagedAccountPwdNew}                                                                                                |
|Check Password                   |${ManagedAccount}|        |${CheckPasswordNotMatch}                                                                    |
|pause                            |45000                                                                                                                  |
|Check Application Pool           |${AppPoolName}   |on      |${SystemAddress}|password is NOT equal to|${ManagedAccountPwdNew}                           |
|Uncheck Checkbox                 |changemeta       |for user|DEFAULT                                                                                     |
|Remove Application Pool          |${AppPoolName}   |on      |${SystemAddress}                                                                            |
