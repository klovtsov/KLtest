!********> Test Description
This test checks that Dublicate button for file is working.
Check that new file has same membership and permissions.
**************!
!include <AutomatedTesting.PlatformsTesting.WindowsLocalHost
!define FileName {${UserPrefix}TestFile}
!define dblFileName {${FileName}Two}
!define FilePath {c:\}
!define FileDesc {${UserPrefix}FileDesc} 
!define FileEmailAddr {${UserPrefix}FileEmailAddr0@tpam.spb.qsft}
!define psConnectOptions {-tpamAddress ${TPAMHost} -keyFile ${API_user_1} -apiUser ${API_user_1}}

!define CollectionName {${prefix}FileColtn}

!include -c <AutomatedTesting.PowerShellNetApiScenarios.ScenarioLibrary
!include -c <AutomatedTesting.EmailScenarios.ScenarioLibrary
!include -c <AutomatedTesting.EmailScenarios.FilesNotifications.ScenarioLibrary
!include -c <AutomatedTesting.CliScenarios.ScenarioLibrary
!include -c <AutomatedTesting.PermissionHierarchy.ScenarioLibrary
!include -c ScenarioLibrary

!* Create Envirinment
!|script                                                                            |
|Add system                                                                         |
|Add Collection        |${CollectionName}                                           |
|Create File           |${FilePath}  |       |${FileName}                           |
|Add File                                                                           |
|Add File To Collection|${SystemName}|       |${FileName}|        |${CollectionName}|
|Set policy            |Approver     |on file|${FileName}|for user|${CLI_user_2}    |
|pause                 |${ApplyNewPoliciesInterval}                                 |
*!
!* Duplicate and check results
!|script                                                                                                         |
|Duplicate  File                     |${FileName}                  |to                 |${dblFileName}           |
|pause                               |${ApplyNewPoliciesInterval}                                                |
|List Collection Membership by filter|-collection ${CollectionName}|and result contains|${dblFileName}           |
|List Policies by filter             |-FileName  ${dblFileName}    |contains           |${CLI_user_2}.*Approver.*|
*!
!*> Clear Environment
!|script                                      |
|Delete File      |${FilePath}||${FileName}   |
|Delete File      |${FilePath}||${dblFileName}|
|Remove system    |${SystemName}              |
|Delete Collection|${CollectionName}          |
*!