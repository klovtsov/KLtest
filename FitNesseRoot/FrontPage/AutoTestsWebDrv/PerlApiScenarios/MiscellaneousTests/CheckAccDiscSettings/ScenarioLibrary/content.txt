!contents

!|scenario|Open Browser and Login to TPAM         |
|Open     |${TPAMURL}||${TPAMAdmin}||${DefaultPwd}|

!|scenario|Close Browser|
|stop                   |
|pause    |5000         |


!|scenario    |Create Template|
|Choose System|${SystemName}  |
|Set Template                 |

!|scenario            |Choose system                               |SystemName |
|clickOnLink          |link=Manage Systems                                     |
|waitForElementPresent|id=SystemNm                                             |
|type;                |id=SystemNm                                 |@SystemName|
|click                |id=Listing                                              |
|waitForElementPresent|xpath=//td[contains(text(),'${SystemName}')]            |
|click                |xpath=//td[contains(text(),'${SystemName}')]|           |

!|scenario         |Set Template                                         |
|click             |id=Template                                          |
|pause             |10000                                                |
|click             |id=cbxTemplateFl                                     |
|pause             |5000                                                 |
|click             |id=cbxRetainAccounts                                 |
|pause             |5000                                                 |
|click             |id=cb_acct_acctrow_1                                 |
|pause             |5000                                                 |
|click             |id=Details                                           |
|type;             |id=SystemName            |${TemplateName}            |
|pause             |5000                                                 |
|click             |id=bt_Save                                           |
|waitForTextPresent|System changes for ${TemplateName} saved successfully|

!|scenario         |Remove template |TemplateName|
|Choose system     |@TemplateName                |
|click             |id=bt_Del       |            |
|getConfirmation                                 |
|waitForTextPresent|has been successfully deleted|


!|scenario                    |Create Account Discovery Profile                                                                                                                                   |
|clickOnLink                  |link=Profile Management                                                                                                                                            |
|select;                      |id=ProfileType          |label=Account Discovery                                                                                                                   |
|waitForElementPresent        |id=NewButton                                                                                                                                                       |
|click                        |id=NewButton                                                                                                                                                       |
|type;                        |id=ProfileName          |${ProfileName}                                                                                                                            |
|type;                        |id=Description          |Description                                                                                                                               |
|Set Delete Account properties|Both (Notify & Turn Off)||abc@quest.com,:System:,:Functional:                                                                                                      |
|Add Detail                   |0                       ||Both (Notify & Create)||${TemplateName}/${AutoDiscoveryAccount}||abc@quest.com,:System:,:Functional:||||||${AutoDiscoveryAccount}|||||||||
|click                        |id=SaveButton                                                                                                                                                      |
|waitForTextPresent           |The profile saved successfully                                                                                                                                     |

!|scenario|Set Delete Account properties|Action||EmailAddresses|
|select;  |id=DelAcctAction             |label=@Action         |
|type;    |id=DelAcctEmail              |@EmailAddresses       |

!|scenario|Add Detail                  |Index||NewAccountAction||TemplateAccount||EmailAddresses||UID||SID||Name||Group||Role||Task||Service|
|click    |id=btnAddRow                                                                                                                     |
|select;  |className=autoNewAction     |label=@NewAccountAction                                                                             |
|select;  |className=autoAcctTemplate  |label=@TemplateAccount                                                                              |
|type;    |className=autoEmailAddresses|@EmailAddresses                                                                                     |
|type;    |className=autoUIDFilter     |@UID                                                                                                |
|type;    |className=autoSIDFilter     |@SID                                                                                                |
|type;    |className=autoNameFilter    |@Name                                                                                               |
|type;    |className=autoGroupFilter   |@Group                                                                                              |
|type;    |className=autoRoleFilter    |@Role                                                                                               |

!|scenario            |Delete Account Discovery Profile|ProfileName            |
|clickOnLink          |link=Profile Management                                 |
|select;              |id=ProfileType                  |label=Account Discovery|
|waitForElementPresent|id=DeleteButton                                         |
|select;              |id=ProfileID                    |label=@ProfileName     |
|click                |id=DeleteButton                                         |
|getConfirmation                                                               |
|waitForTextPresent   |The profile was deleted successfully                    |

!|scenario         |Hard-Delete System|systemName                              |
|$res=             |GroovyWebDriver   |hardDeleteSystem;${TPAMHost};@systemName|
|Verify_Contain_NOT|$res;;Something went wrong                                 |
|Verify_Contain_OR |$res;;System hard-deleted                                  |
