!*> Includes
!include -c <AutomatedTesting.UsersTests.ScenarioLibrary
!include -c <AutomatedTesting.UsersTests.UserTypes.ScenarioLibrary
*!


!*> Prepare
!|script                                                                                                                                                                            |
|Open                 |${TPAMURL}             ||${TPAMAdmin}                                                                                                         ||${DefaultPwd}|
|Add API User         |${ApiUserAdministrator}||User Administrator                                                                                                                  |
|Add CLI User         |${UserName}3           ||Basic                                                                                                                               |
|Add System           |${CLIBatch}            ||--SystemName ${SystemName2} --PlatformName ${PlatformName} --NetworkAddress ${NetworkAddress}                        ||successfully |
|Add Account          |${CLIBatch}            ||--SystemName ${SystemName2} --AccountName ${AccountName}2                                                            ||successfully |
|Add Group            |${CLIBatch}            ||--GroupName ${GroupName}2                                                                                            ||successfully |
|Add Collection       |${CLIBatch}            ||--CollectionName ${CollectionName}                                                                                   ||successfully |
|Add Collection member|${CLIBatch}            ||--CollectionName ${CollectionName} --SystemName ${SystemName2}                                                       ||successfully |
|Add User             |${CLIBatch}            ||--UserName ${UserName}2 --LastName test --FirstName test                                                             ||successfully |
|Update PSM Account   |${CLIBatch}            ||--System ${SystemName2} --Account ${AccountName}2 --EnableFlag Y --ProxyType \"RDP - Automatic Login Using Password\"||successfully |
|Add Grp member       |${CLIBatch}            ||--GroupName ${GroupName}2 --UserName ${UserName}2                                                                    ||successfully |


*!
!|script                                                                                                                                                                                                                                                                                       |
|Add System via api                    |SystemName=${SystemName};PlatformName=${PlatformName};NetworkAddress=${NetworkAddress}                                ||${ApiUserAdministrator}||You do not have a valid UserID to perform this operation                                              |
|Add Account via api                   |SystemName=${SystemName2};AccountName=${AccountName}                                                                  ||${ApiUserAdministrator}||${ApiUserAdministrator} is not authorized                                                             |
|Add User via api                      |UserName=${UserName};FirstName=Keyser;LastName=Sozo                                                                   ||${ApiUserAdministrator}||User added successfully                                                                               |
|Add Group via api                     |GroupName=${GroupName}                                                                                                ||${ApiUserAdministrator}||${ApiUserAdministrator} is not authorized to save groups.                                             |
|Add Grp member via api                |GroupName=${GroupName}2;GroupMember=${BasicUserName}                                                                  ||${ApiUserAdministrator}||is not authorized to update group membership                                                          |
|Add Collection via api                |CollectionName=${CollectionName}2                                                                                     ||${ApiUserAdministrator}||${ApiUserAdministrator} is not authorized save collections.                                           |
|Add Collection member via api         |CollectionName=${CollectionName};SystemName=${SystemName2}                                                            ||${ApiUserAdministrator}||${ApiUserAdministrator} is not authorized to add collection members                                   |
|Add Collection member via api         |CollectionName=${CollectionName};SystemName=${SystemName2};AccountName=${AccountName}2                                ||${ApiUserAdministrator}||${ApiUserAdministrator} is not authorized to add collection members                                   |
|Add PwdRequest via api                |SystemName=${SystemName2};AccountName=${AccountName}2;UserName=${ApiUserAdministrator}                                ||${ApiUserAdministrator}||${ApiUserAdministrator} is not authorized to add requests                                             |
|Add SyncPass via api                  |SyncPassName=${SyncPassName};Password=Password1                                                                       ||${ApiUserAdministrator}||${ApiUserAdministrator} is not authorized.                                                            |
|List Systems via api                  |SystemName=${SystemName2}                                                                                             ||${ApiUserAdministrator}||No Systems to list                                                                                    |
|List Accounts via api                 |SystemName=${SystemName2};AccountName=${AccountName}2                                                                 ||${ApiUserAdministrator}||No Accounts to list                                                                                   |
|List Users via api                    |UserName=${UserName}2                                                                                                 ||${ApiUserAdministrator}||${UserName}2                                                                                          |
|List Groups via api                   |GroupName=${GroupName}2                                                                                               ||${ApiUserAdministrator}||is not authorized to list Groups                                                                      |
|List Group Membership via api         |GroupName=${GroupName}2                                                                                               ||${ApiUserAdministrator}||is not authorized to group membership                                                                 |
|List Dependent Systems via api        |SystemName=Fake;AccountName=Fake                                                                                      ||${ApiUserAdministrator}||${ApiUserAdministrator} is not currently authorized                                                   |
|List Synchronized Passwords via api   |                                                                                                                      ||${ApiUserAdministrator}||${ApiUserAdministrator} is not authorized.                                                            |
|List Reason Codes via api             |                                                                                                                      ||${ApiUserAdministrator}||${PersistentReasonCodeName}                                                                           |
|Delete Account via api                |SystemName=${SystemName2};AccountName=${AccountName}2                                                                 ||${ApiUserAdministrator}||You are not authorized to perform this operation                                                      |
|Drop Collection via api               |CollectionName=${CollectionName}                                                                                      ||${ApiUserAdministrator}||${ApiUserAdministrator} is not authorized save collections.                                           |
|Drop Collection Member via api        |CollectionName=${CollectionName};CollectionMember=${SystemName2}                                                      ||${ApiUserAdministrator}||You do not have the necessary permissions to modify Collection assignments for System: ${SystemName2}.|
|Drop Group via api                    |GroupName=${GroupName}2                                                                                               ||${ApiUserAdministrator}||${ApiUserAdministrator} is not authorized to save groups.                                             |
|Drop Group Member via api             |GroupName=${GroupName}2;GroupMember=${UserName}                                                                       ||${ApiUserAdministrator}||is not authorized to update group membership                                                          |
|Update Account via api                |SystemName=${SystemName2};AccountName=${AccountName}2;Description=test                                                ||${ApiUserAdministrator}||${ApiUserAdministrator} is not authorized                                                             |
|Update System via api                 |SystemName=${SystemName2};Description=test                                                                            ||${ApiUserAdministrator}||You do not have a valid UserID to perform this operation                                              |
|Update Dependent Systems via api      |SystemName=Fake;ADAccountName=Fake;ADSystemName=Fake                                                                  ||${ApiUserAdministrator}||${ApiUserAdministrator} is not currently authorized                                                   |
|Update SyncPass via api               |SyncPassName=${SyncPassName};Password=Password2                                                                       ||${ApiUserAdministrator}||${ApiUserAdministrator} is not authorized.                                                            |
|Change User Password via api          |UserName=${UserName}2;Password=Password1                                                                              ||${ApiUserAdministrator}||successfully                                                                                          |
|Force Reset via api                   |SystemName=${SystemName2};AccountName=${AccountName}2                                                                 ||${ApiUserAdministrator}||Failure                                                                                               |
|Set Access Policy via api             |SystemName=${SystemName2};AccountName=${AccountName}2;Action=ADD;AccessPolicyName=ISA;UserName=${ApiUserAdministrator}||${ApiUserAdministrator}||User Name is not valid                                                                                |
|Sync Pass Force Reset via api         |SyncPassName=${SyncPassName};SyncPass=SyncPass                                                                        ||${ApiUserAdministrator}||${ApiUserAdministrator} is not authorized.                                                            |
|Test System via api                   |SystemName=${SystemName2}                                                                                             ||${ApiUserAdministrator}||You are not authorized to perform this operation                                                      |
|Unlock User via api                   |UserName=${UserName}2                                                                                                 ||${ApiUserAdministrator}||${UserName}2 is not currently locked                                                                  |
|Report Activity via api               |UserName=${ApiUserAdministrator}                                                                                      ||${ApiUserAdministrator}||${ApiUserAdministrator}                                                                               |
|Retrieve via api                      |SystemName=${SystemName2};AccountName=${AccountName}2                                                                 ||${ApiUserAdministrator}||You are not authorized to perform this operation                                                      |
|Add Session Request via api           |SystemName=${SystemName2};AccountName=${AccountName}2;UserName=${ApiUserAdministrator}                                ||${ApiUserAdministrator}||${ApiUserAdministrator} is not authorized to add requests                                             |
|List Accts For Session Request via api|                                                                                                                      ||${ApiUserAdministrator}||No Accounts to list                                                                                   |
|List PSM Accounts via api             |SystemName=${SystemName2};AccountName=${AccountName}2                                                                 ||${ApiUserAdministrator}||No PSM Accounts to list                                                                               |
|Update PSM Account via api            |SystemName=${SystemName2};AccountName=${AccountName}2;SessionStartNotifyEmail=mail@mail.mail                          ||${ApiUserAdministrator}||You are not authorized to perform this operation                                                      |
|List Collections via api              |                                                                                                                      ||${ApiUserAdministrator}||No Collections to list                                                                                |
|Delete System via api                 |SystemName=${SystemName2}                                                                                             ||${ApiUserAdministrator}||${ApiUserAdministrator} is not authorized to delete systems.                                          |
|Check Password via api                |SystemName=${SystemName2};AccountName=${AccountName}2                                                                 ||${ApiUserAdministrator}||Failure                                                                                               |
|Update User via api                   |UserName=${UserName}2;Description=test;Disable=Y                                                                      ||${ApiUserAdministrator}||successfully                                                                                          |
|Update User via api                   |UserName=${UserName}2;Description=test;Disable=N                                                                      ||${ApiUserAdministrator}||successfully                                                                                          |
|Delete User via api                   |UserName=${UserName}2                                                                                                 ||${ApiUserAdministrator}||${UserName}2 has been successfully deleted                                                            |
|Update User via api                   |UserName=${ApiUserAdministrator};Description=test                                                                     ||${ApiUserAdministrator}||User Admins can only add and modify basic users                                                       |
|Update User via api                   |UserName=${UserName}3;Description=test                                                                                ||${ApiUserAdministrator}||User Admins can not modify non-web users                                                              |
|List Collection Membership via api    |CollectionName=${CollectionName}                                                                                      ||${ApiUserAdministrator}||No Collection Memberships to list                                                                     |



#|List Collection Membership via api    |                                                                                                               ||${ApiUserAdministrator}||No Collection Memberships to list                                                                                               |
#|Set Access Policy             |${CLIBatch}                                                                                                   ||--SystemName ${SystemName2} --AccountName ${AccountName}2 --Action ADD --AccessPolicyNam Approver-Requestor --UserNam ${BasicUserName}||pprover-Requestor assigned to.*${BasicUserName}.*successfully                                                                   |
#|List Accts For Pwd Request    |                                                                                                              ||No Accounts to list                                                                                                                              |
 		



!*> Clenup
!|script                                                                      |
|Remove user    |${ApiUserAdministrator}                                      |
|Remove Keys    |${ApiUserAdministrator}*                                     |
|Delete System  |${CLIBatch}||--SystemName ${SystemName2}       ||successfully|
|Drop Group     |${CLIBatch}||--GroupName ${GroupName}2         ||successfully|
|Drop Collection|${CLIBatch}||--CollectionName ${CollectionName}||successfully|
|Delete User    |${CLIBatch}||--UserName ${UserName}            ||successfully|
|Remove user    |${UserName}3                                                 |
|Remove Keys    |${UserName}3 *                                               |

*!