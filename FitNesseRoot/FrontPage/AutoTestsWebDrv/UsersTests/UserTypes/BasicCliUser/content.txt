!*> Includes
!include -c <AutomatedTesting.UsersTests.ScenarioLibrary
!include -c <AutomatedTesting.UsersTests.UserTypes.ScenarioLibrary
*!


!*> Prepare
!|script                                                                                                                                                                     |
|Open                 |${TPAMURL}      ||${TPAMAdmin}                                                                                                         ||${DefaultPwd}|
|Add CLI User         |${BasicUserName}||Basic                                                                                                                               |
|Add System           |${CLIBatch}     ||--SystemName ${SystemName2} --PlatformName ${PlatformName} --NetworkAddress ${NetworkAddress}                        ||successfully |
|Add Account          |${CLIBatch}     ||--SystemName ${SystemName2} --AccountName ${AccountName}2                                                            ||successfully |
|Add Group            |${CLIBatch}     ||--GroupName ${GroupName}2                                                                                            ||successfully |
|Add Collection       |${CLIBatch}     ||--CollectionName ${CollectionName}                                                                                   ||successfully |
|Add Collection member|${CLIBatch}     ||--CollectionName ${CollectionName} --SystemName ${SystemName2}                                                       ||successfully |
|Add User             |${CLIBatch}     ||--UserName ${UserName}2 --LastName test --FirstName test                                                             ||successfully |
|Update PSM Account   |${CLIBatch}     ||--System ${SystemName2} --Account ${AccountName}2 --EnableFlag Y --ProxyType \"RDP - Automatic Login Using Password\"||successfully |
#|Add Grp member       |${CLIBatch}     ||--GroupName ${GroupName}2 --UserName ${UserName}                                                                     ||successfully |


*!
!|script                                                                                                                                                                                                                                                                                                                      |
|Add System                    |${CLIBatchBasicUser}||--SystemName ${SystemName} --PlatformName ${PlatformName} --NetworkAddress ${NetworkAddress}                                          ||You must have PPM or PSM ISA permission on a system or non-empty collection to perform this operation                           |
|Add Account                   |${CLIBatchBasicUser}||--SystemName ${SystemName2} --AccountName ${AccountName}                                                                              ||You are not authorized to perform this operation.                                                                               |
|Add User                      |${CLIBatchBasicUser}||--UserName ${UserName} --FirstName Kaizer --LastName Sozo                                                                             ||${BasicUserName} is not authorized to modify users.                                                                             |
|Add Group                     |${CLIBatchBasicUser}||--GroupName ${GroupName}                                                                                                              ||${BasicUserName} is not authorized to save groups.                                                                              |
|Add Grp member                |${CLIBatchBasicUser}||--GroupName ${GroupName}2 --UserName ${BasicUserName}                                                                                 ||${BasicUserName} is not authorized to update group membership.                                                                  |
|Add Collection                |${CLIBatchBasicUser}||--CollectionName ${CollectionName}2                                                                                                   ||${BasicUserName} is not authorized save collections.                                                                            |
|Add Collection member         |${CLIBatchBasicUser}||--CollectionName ${CollectionName} --SystemName  ${SystemName2}                                                                       ||You do not have the necessary permissions to modify Collection assignments for System:                                          |
|Add Collection member         |${CLIBatchBasicUser}||--CollectionName ${CollectionName} --SystemName  ${SystemName2} --AccountName  ${AccountName}2                                        ||You do not have the necessary permissions to modify Collection assignments for System: ${SystemName2}.*Account: ${AccountName}2.|
|Add PwdRequest                |${CLIBatchBasicUser}||--SystemName ${SystemName2} --AccountName ${AccountName}2                                                                             ||You do not have permissions to create a Password Request for this account .*${SystemName2}.*${AccountName}2                     |
|Add SyncPass                  |${CLIBatchBasicUser}||--SyncPassName ${SyncPassName}                                                                                                        ||${BasicUserName} is not authorized.                                                                                             |
|List Systems                  |${CLIBatchBasicUser}||                                                                                                                                      ||No Systems to list                                                                                                              |
|List Accounts                 |${CLIBatchBasicUser}||                                                                                                                                      ||No Accounts to list                                                                                                             |
|List Users                    |${CLIBatchBasicUser}||                                                                                                                                      ||${BasicUserName} is not authorized to list users.                                                                               |
|List Groups                   |${CLIBatchBasicUser}||                                                                                                                                      ||${BasicUserName} is not authorized to list Groups                                                                               |
|List Group Membership         |${CLIBatchBasicUser}||                                                                                                                                      ||${BasicUserName} is not authorized to group membership.                                                                         |
|List Accts For Pwd Request    |${CLIBatchBasicUser}||                                                                                                                                      ||No Accounts to list                                                                                                             |
|List Dependent Systems        |${CLIBatchBasicUser}||--System Fake --Account Fake                                                                                                          ||${BasicUserName} is not currently authorized                                                                                    |
|List Synchronized Passwords   |${CLIBatchBasicUser}||                                                                                                                                      ||${BasicUserName} is not authorized.                                                                                             |
|List Reason Codes             |${CLIBatchBasicUser}||                                                                                                                                      ||${PersistentReasonCodeName}                                                                                                     |
|Delete Account                |${CLIBatchBasicUser}||--SystemName ${SystemName2} --AccountName ${AccountName}2                                                                             ||You are not authorized to perform this operation                                                                                |
|Drop Collection               |${CLIBatchBasicUser}||--CollectionName ${CollectionName}                                                                                                    ||${BasicUserName} is not authorized save collections.                                                                            |
|Drop Collection Member        |${CLIBatchBasicUser}||--CollectionName ${CollectionName} --SystemName ${SystemName2}                                                                        ||You do not have the necessary permissions to modify Collection assignments for System: ${SystemName2}.                          |
|Drop Group                    |${CLIBatchBasicUser}||--GroupName ${GroupName}2                                                                                                             ||${BasicUserName} is not authorized to save groups.                                                                              |
|Drop Group Member             |${CLIBatchBasicUser}||--GroupName ${GroupName}2 --UserName ${UserName}                                                                                      ||${BasicUserName} is not authorized to update group membership.                                                                  |
|Delete User                   |${CLIBatchBasicUser}||--UserName ${UserName}2                                                                                                               ||is not authorized                                                                                                               |
|Update Account                |${CLIBatchBasicUser}||--SystemName ${SystemName2} --AccountName ${AccountName}2 --Description test                                                          ||You are not authorized to perform this operation.                                                                               |
|Update System                 |${CLIBatchBasicUser}||--SystemName ${SystemName2} --Description test                                                                                        ||You are not authorized to perform this operation                                                                                |
|Update Dependent Systems      |${CLIBatchBasicUser}||--System Fake --Account Fake --Assign test                                                                                            ||${BasicUserName} is not currently authorized                                                                                    |
|Update SyncPass               |${CLIBatchBasicUser}||--SyncPassName ${SyncPassName}                                                                                                        ||${BasicUserName} is not authorized.                                                                                             |
|Update User                   |${CLIBatchBasicUser}||--UserName ${UserName}2 --Description test                                                                                            ||${BasicUserName} is not authorized to modify users.                                                                             |
|Change User Password          |${CLIBatchBasicUser}||--UserName ${UserName}2 --Password Password1                                                                                          ||is not authorized                                                                                                               |
|Force Reset                   |${CLIBatchBasicUser}||--SystemName ${SystemName2} --AccountName ${AccountName}2                                                                             ||You are not authorized to perform this operation                                                                                |
|Set Access Policy             |${CLIBatchBasicUser}||--SystemName ${SystemName2} --AccountName ${AccountName}2 --Action ADD --AccessPolicyNam ISA --UserNam ${BasicUserName}               ||You do not have sufficient permissions on the owning Account to change Access Policy assignments                                |
|Sync Pass Force Reset         |${CLIBatchBasicUser}||--SyncPassName ${SyncPassName}                                                                                                        ||${BasicUserName} is not authorized.                                                                                             |
|Test System                   |${CLIBatchBasicUser}||--SystemName ${SystemName2}                                                                                                           ||You are not authorized to perform this operation                                                                                |
|Unlock User                   |${CLIBatchBasicUser}||--UserName Fake                                                                                                                       ||${BasicUserName} is not authorized to unlock users.                                                                             |
|Report Activity               |${CLIBatchBasicUser}||                                                                                                                                      ||${BasicUserName}                                                                                                                |
|Retrieve                      |${CLIBatchBasicUser}||--SystemName ${SystemName2} --AccountName ${AccountName}2                                                                             ||You are not authorized to perform this operation                                                                                |
|Add Session Request           |${CLIBatchBasicUser}||--SystemName ${SystemName2} --AccountName ${AccountName}2                                                                             ||Web Interface access is required in order to create a Session Request for user ${BasicUserName}                                 |
|List Accts For Session Request|${CLIBatchBasicUser}||                                                                                                                                      ||No Accounts to list                                                                                                             |
|List PSM Accounts             |${CLIBatchBasicUser}||                                                                                                                                      ||No PSM Accounts to list                                                                                                         |
|Update PSM Account            |${CLIBatchBasicUser}||--System ${SystemName2} --Account ${AccountName}2 --SessionStartNotifyEmail mail@mail.mail                                            ||You are not authorized to perform this operation                                                                                |
|Set Access Policy             |${CLIBatch}         ||--SystemName ${SystemName2} --AccountName ${AccountName}2 --Action ADD --AccessPolicyNam Approver-Requestor --UserNam ${BasicUserName}||pprover-Requestor assigned to.*${BasicUserName}.*successfully                                                                   |
|List Collections              |${CLIBatchBasicUser}||                                                                                                                                      ||No Collections to list                                                                                                          |
|Delete System                 |${CLIBatchBasicUser}||--SystemName ${SystemName2}                                                                                                           ||${BasicUserName} is not authorized to delete systems.                                                                           |
|Check Password                |${CLIBatchBasicUser}||--SystemName ${SystemName2} --AccountName ${AccountName}2                                                                             ||You are not authorized to perform this operation                                                                                |
|List Collection Membership    |${CLIBatchBasicUser}||--CollectionName ${CollectionName}                                                                                                    ||No Collection Memberships to list                                                                                               |
|List Collection Membership    |${CLIBatchBasicUser}||                                                                                                                                      ||No Collection Memberships to list                                                                                               |
	
 		

# temporarily bisabled.
#|List Collections          |${CLIBatchBasicUser}||                                                                                              ||is not authorized                                                                                                               |
#|Delete System              |${CLIBatchBasicUser}||--SystemName ${SystemName2}                                                                   ||You are not authorized to perform this operation.                                                                               |
#|Check PAssword        |
#|List Assigned policies|


!*> Clenup
!|script                                                                      |
|Delete System  |${CLIBatch}||--SystemName ${SystemName2}       ||successfully|
|Drop Group     |${CLIBatch}||--GroupName ${GroupName}2         ||successfully|
|Drop Collection|${CLIBatch}||--CollectionName ${CollectionName}||successfully|
|Delete User    |${CLIBatch}||--UserName ${UserName}2           ||successfully|
|Remove user    |${BasicUserName}                                             |
|Remove Keys    |${BasicUserName}*                                            |

*!