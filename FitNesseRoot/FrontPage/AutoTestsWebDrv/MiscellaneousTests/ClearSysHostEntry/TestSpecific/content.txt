!| scenario       |Clear Known Hosts|CLIBatch  |  |options  |  |result |
|$res=            |CLI              |@CLIBatch ClearKnownHosts @options|
|Verify_Contain_OR|$res;;@result                                       |

!| scenario       |Clear Known Hosts With Perl API|PerlAPIparams        |       |options       |       |result       |
|$res=            |RunBatchGetOutput              |PerlAPI\perl_runner.bat;ClearKnownHosts.pl;@PerlAPIparams;@options|
|Verify_Contain_OR|$res;;@result                                                                                     |

!| scenario       |Clear Known Hosts With dotNET API|PerlAPIparams               |               |result               |
|$res=            |PowerShellScript                 |clearKnownHosts.ps1 ${psConnectOptions}  -systemName ${SystemName}|
|Verify_Contain_OR|$res;;@result                                                                                       |

!| scenario       |Clear Known Hosts With Java API|JavaAPIparams          |          |options          |         |result         |
|$res=            |RunBatchGetOutput              |GroovyJavaAPI\groovy_runner.bat;clearKnownHosts.groovy;@JavaAPIparams;@options|
|Verify_Contain_OR|$res;;@result                                                                                                 |

!| scenario        |GetSysHostEntry                                      |
|$res=             |GroovyWebDriver|GetHostKeyEntries;${FrontPageContent}|
|Verify_Contain_NOT|$res;;Exception                                      |

!| scenario       |Check SysHostEntry exist|SystemAddress|
|Verify_Contain_OR|$res;;@SystemAddress                  |


!| scenario        |Check SysHostEntry not exist|SystemAddress|
|Verify_Contain_NOT|$res;;@SystemAddress                      |

!| scenario           |Prepare                                                                                                                                                                                               |
|Open                 |${TPAMURL}         ||${TPAMAdmin}                                                                                                                                                      ||${DefaultPwd}|
|Add CLI User         |${Administrator}   ||Administrator                                                                                                                                                                    |
|Add API User         |${AdminAPI}        ||Administrator                                                                                                                                                                    |
|Add System           |${CLIAdministrator}||--SystemName ${SystemName} --PlatformName \"${SystemPlatform}\" --NetworkAddress ${SystemAddress} --FunctionalAccount ${FunctAcct} --FuncAcctCred DSS --Timeout 60||successfully |
|Retrieve Standard Key|OpenSSH                                                                                                                                                                                               |
|Copy key to system   |OpenSSH                                                                                                                                                                                               |


!| scenario                  |Clear System Host Entry                                                                   |
|Test System                 |${CLIAdministrator}||--SystemName ${SystemName}||successful                               |
|GetSysHostEntry                                                                                                        |
|Check SysHostEntry exist    |${SystemAddress}                                                                          |
|Clear Known Hosts           |${CLIAdministrator}||--SystemName ${SystemName}||Cleared ${SystemAddress} from known_hosts|
|GetSysHostEntry                                                                                                        |
|Check SysHostEntry not exist|${SystemAddress}                                                                          |

!| scenario       |Clear System Host Entry DPA                                                                            |
|Set Affinity                                                                                                             |
|pause            |5000                                                                                                   |
|Test System      |${CLIAdministrator}||--SystemName ${SystemName}||successful                                            |
|stop                                                                                                                     |
|Get DPA Name and IP Address                                                                                              |
|Open             |${TPAMURL}         ||${TPAMAdmin}              ||${DefaultPwd}                                         |
|Clear Known Hosts|${CLIAdministrator}||--SystemName ${SystemName}||$DPAAddress.*Cleared ${SystemAddress} from known_hosts|


!| scenario                     |Clear System Host Entry With Perl API                                                            |
|Test System                    |${CLIAdministrator}||--SystemName ${SystemName}||successful                                      |
|GetSysHostEntry                                                                                                                  |
|Clear Known Hosts With Perl API|${PerlAPIparams}   ||--SystemName=${SystemName}||rc: 0.*Cleared ${SystemAddress} from known_hosts|
|GetSysHostEntry                                                                                                                  |
|Check SysHostEntry not exist   |${SystemAddress}                                                                                 |

!| scenario                     |Clear System Host Entry With Java API                                             |
|Test System                    |${CLIAdministrator}||--SystemName ${SystemName}||successful                       |
|GetSysHostEntry                                                                                                   |
|Clear Known Hosts With Java API|${JavaAPIparams}   ||SystemName=${SystemName}  ||${SystemAddress} from known_hosts|
|GetSysHostEntry                                                                                                   |
|Check SysHostEntry not exist   |${SystemAddress}                                                                  |


!|scenario                        |Clear System Host Entry With dotNET DPA                                            |
|Set Affinity                                                                                                         |
|pause                            |5000                                                                               |
|Test System                      |${CLIAdministrator}||--SystemName ${SystemName}       |       |successful          |
|stop                                                                                                                 |
|Get DPA Name and IP Address                                                                                          |
|Open                             |${TPAMURL}         ||${TPAMAdmin}                     |       |${DefaultPwd}       |
|Clear Known Hosts With dotNET API|${psConnectOptions}||rc = 0.*$DPAAddress.*Cleared ${SystemAddress} from known_hosts|

!| scenario   |Cleanup                                               |
|Remove Keys  |${Administrator}*                                     |
|Delete User  |${CLIBatch}||--UserName ${Administrator}||successfully|
|Delete User  |${CLIBatch}||--UserName ${AdminAPI}     ||successfully|
|Delete System|${CLIBatch}||--SystemName ${SystemName} ||successfully|
