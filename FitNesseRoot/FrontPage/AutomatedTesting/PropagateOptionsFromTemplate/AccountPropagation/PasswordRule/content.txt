!define ManagedAccount {Ruller}
!define pwdRuleName {${prefix}NewPwdRule}
!include -c <AutomatedTesting.PasswordRules.ScenarioLibrary
!include -c <AutomatedTesting.PowerShellNetApiScenarios.ScenarioLibrary

!|script                                                                                                                                                                                                                                                  |
|Login                  |${TPAMAdminURL}                                                                                   |               |${TPAMMaster}                      |            |${MasterPwd}                                                 |
|pause                  |5000                                                                                                                                                                                                                             |
|Create Password Rule   |${pwdRuleName}                                                                                                                                                                                                                   |
|Add account            |${ManagedAccount}                                                                                 |on system      |${TemplateName}                    |with options|-description "${accDescription}" -PasswordRule ${pwdRuleName}|
|Add account            |${ManagedAccount}2                                                                                |on system      |${TemplateName}                    |with options|-description "${accDescription}"                             |
|Try to Add system      |${newSystemName}                                                                                  |with parameters|-templateSystemName ${TemplateName}|with result |System changes for ${newSystemName} saved successfully       |
|List Accounts by filter|-systemName ${newSystemName} -AccountName ${ManagedAccount} -propsToList accountname,passwordRule |contains       |${ManagedAccount}\s+${pwdRuleName}                                                                            |
|List Accounts by filter|-systemName ${newSystemName} -AccountName ${ManagedAccount}2 -propsToList accountname,passwordRule|contains       |${ManagedAccount}2\s+Default Password Rule                                                                    |
|Delete System          |${newSystemName}                                                                                                                                                                                                                 |
#|Delete Password Rule   |${pwdRuleName}                                                                                                                                                                                                                   |
