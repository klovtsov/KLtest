!* Test description
DEN at any level "takes hold" as long as nothing from a lower-numbered level overrides it.
*!

!define CollectionName {${prefix}AccntColtn}
!define CollectionName2 {${prefix}SysColtn}

!*> Include section
!include -c <AutoTestsWebDrv.ScenarioLibrary
!include -c <AutoTestsWebDrv.EmailScenarios.ScenarioLibrary
!include -c <AutoTestsWebDrv.CliScenarios.ScenarioLibrary
!include -c ScenarioLibrary
*!

!*> Create Environment
!|script                                                                                          |
|Add Group                |${GroupName}                                                           |
|Add User To Group        |${CLI_user_2}    |             |${GroupName}                           |
|Add system                                                                                       |
|Add account              |${ManagedAccount}|with password|${ManagedAccountPwd}||${NotFailed}     |
|Add Collection           |${CollectionName}                                                      |
|Add Collection           |${CollectionName2}                                                     |
|Add System To Collection |${SystemName}    |             |${CollectionName2}                     |
|Add Account To Collection|${SystemName}    |             |${ManagedAccount}   ||${CollectionName}|
|Change User Type         |Basic            |for user     |${CLI_user_2}                          |
*!

!|script                                                                                                                      |
|Set policy           |Denied           |on collection|${CollectionName2}|for user |${CLI_user_2}                             |
|Set policy           |ISA              |on collection|${CollectionName} |for group|${GroupName}                              |
|pause                |${ApplyNewPoliciesInterval}                                                                            |
|Try to Update Account|${ManagedAccount}|by user      |${CLI_user_2}     |params   |--Description AaA|with result|You are not |
|Set policy           |ISA              |on system    |${SystemName}     |for user |${CLI_user_2}                             |
|pause                |${ApplyNewPoliciesInterval}                                                                            |
|Try to Update Account|${ManagedAccount}|by user      |${CLI_user_2}     |params   |--Description AaA|with result|successfully|

!*> Clear Environment
!|script                                       |
|Change User Type |Admin|for user|${CLI_user_2}|
|Remove account   |${ManagedAccount}           |
|Remove system    |${SystemName}               |
|Delete Collection|${CollectionName}           |
|Delete Collection|${CollectionName2}          |
|Delete Group     |${GroupName}                |
*!
