!contents

!|scenario                          |Prepare Environment                                                                                                     |
|Login                              |${TPAMURL}       |               |${TPAMAdmin}    |             |${DefaultPwd}                                          |
|Add System                         |${SystemName}    |               |${SystemAddress}|             |${SystemPlatform}|         |${FunctAcct}||${FuncAccPwd}|
|Add User To Group                  |${CLI_user_1}    |               |\"Global Requestor Group\"                                                            |
|Prepare Account                    |${ManagedAccount}|               |${SystemName}   |             |${SystemAddress}                                       |
|Prepare User                       |${Requestor}     |with first name|${Requestor}    |and last name|Smith            |with type|Basic                      |
|Prepare User                       |${Approver}      |with first name|${Approver}     |and last name|Smith            |with type|Basic                      |
|Prepare User                       |${Reviewer1}     |with first name|${Reviewer1}    |and last name|Smith            |with type|Basic                      |
|Prepare User                       |${Reviewer2}     |with first name|${Reviewer2}    |and last name|Smith            |with type|Basic                      |
|Prepare User                       |${Auditor}       |with first name|${Auditor}      |and last name|Smith            |with type|Auditor                    |
|Prepare User                       |${ISA}           |with first name|${ISA}          |and last name|Smith            |with type|Basic                      |
|Add Group                          |${ReviewerGroup}                                                                                                        |
|Add User To Group                  |${Reviewer2}     |               |${ReviewerGroup}                                                                      |
|Set Group Permissions Account Level|${ReviewerGroup} |               |Reviewer        |             |${ManagedAccount}                                      |
|Set User Permissions System Level  |${Reviewer1}     |               |Reviewer                                                                              |
|Set User Permissions System Level  |${Requestor}     |               |Requestor                                                                             |
|Set User Permissions System Level  |${Approver}      |               |Approver                                                                              |
|Set User Permissions System Level  |${ISA}           |               |ISA                                                                                   |
|Logout                                                                                                                                                      |


!|scenario         |Review Session        |
|Session Reviewed By Any Reviewer         |
|Session Reviewed By Specific Reviewer    |
|Session Reviewed By Specific Group Member|
|Session Reviewed By Auditor              |
|Replay Session Log And Complete Review   |


!|scenario     |Review Password Release    |
|Password Reviewed By Any Reviewer         |
|Password Reviewed By Specific Reviewer    |
|Password Reviewed By Specific Group Member|
|Password Reviewed By Auditor              |
|Multiple Reviews Required                 |
|Review ISA Password Release               |
#|Workaround BFER 6595 Review ISA Password Release|


!|scenario                   |Password Reviewed By Any Reviewer |
|Release Password                                               |
|Check Password Review Status|${Reviewer1}||$RequestID||Pending |
|Submit Comment              |${Reviewer1}||$RequestID          |
|Check Password Review Status|${Reviewer1}||$RequestID||Pending |
|Submit Comment              |${Reviewer2}||$RequestID          |
|Check Password Review Status|${Reviewer2}||$RequestID||Pending |
|Submit Comment              |${Auditor}  ||$RequestID          |
|Check Password Review Status|${Auditor}  ||$RequestID||Pending |
|BFER 6596 Prevent Deletion of System with Pending Review       |
|Complete Review             |${Reviewer1}||$RequestID          |
|Check Password Review Status|${Reviewer1}||$RequestID||Complete|


!|scenario                  |Session Reviewed By Any Reviewer  |
|Request And Open Session                                      |
|Check Session Review Status|${Reviewer1}||$RequestID||Overdue |
|Submit Comment             |${Reviewer1}||$RequestID          |
|Check Session Review Status|${Reviewer1}||$RequestID||Overdue |
|Submit Comment             |${Reviewer2}||$RequestID          |
|Check Session Review Status|${Reviewer2}||$RequestID||Overdue |
|Submit Comment             |${Auditor}  ||$RequestID          |
|Check Session Review Status|${Auditor}  ||$RequestID||Overdue |
|BFER 6596 Prevent Deletion of System with Pending Review      |
|Complete Review            |${Reviewer1}||$RequestID          |
|Check Session Review Status|${Reviewer1}||$RequestID||Complete|



!|scenario                        |Password Reviewed By Specific Reviewer                                       |
|Change PPM Reviewer Type And Name|${ManagedAccount}|on system|${SystemName}|to type|User|with name|${Reviewer1}|
|Release Password                                                                                               |
|Check Password Review Status     |${Reviewer1}     |         |$RequestID   |       |Pending                    |
|Submit Comment                   |${Reviewer1}     |         |$RequestID                                       |
|Check Password Review Status     |${Reviewer1}     |         |$RequestID   |       |Pending                    |
|BFER 6596 Prevent Deletion of System with Pending Review                                                       |
|Cannot Submit Comment            |${Reviewer2}     |         |$RequestID                                       |
|Cannot Submit Comment            |${Auditor}       |         |$RequestID                                       |
|Complete Review                  |${Reviewer1}     |         |$RequestID                                       |
|Check Password Review Status     |${Reviewer1}     |         |$RequestID   |       |Complete                   |



!|scenario                        |Session Reviewed By Specific Reviewer                                        |
|Change PSM Reviewer Type And Name|${ManagedAccount}|on system|${SystemName}|to type|User|with name|${Reviewer1}|
|Request And Open Session                                                                                       |
|Check Session Review Status      |${Reviewer1}     |         |$RequestID   |       |Overdue                    |
|Submit Comment                   |${Reviewer1}     |         |$RequestID                                       |
|Check Session Review Status      |${Reviewer1}     |         |$RequestID   |       |Overdue                    |
|Cannot Submit Comment            |${Reviewer2}     |         |$RequestID                                       |
|Cannot Submit Comment            |${Auditor}       |         |$RequestID                                       |
|BFER 6596 Prevent Deletion of System with Pending Review                                                       |
|Complete Review                  |${Reviewer1}     |         |$RequestID                                       |
|Check Session Review Status      |${Reviewer1}     |         |$RequestID   |       |Complete                   |


!|scenario                        |Password Reviewed By Specific Group Member                                        |
|Change PPM Reviewer Type And Name|${ManagedAccount}|on system|${SystemName}|to type|Group|with name|${ReviewerGroup}|
|Release Password                                                                                                    |
|Check Password Review Status     |${Reviewer2}     |         |$RequestID   |       |Pending                         |
|Cannot Submit Comment            |${Reviewer1}     |         |$RequestID                                            |
|Submit Comment                   |${Reviewer2}     |         |$RequestID                                            |
|Check Password Review Status     |${Reviewer1}     |         |$RequestID   |       |Pending                         |
|Submit Comment                   |${Auditor}       |         |$RequestID                                            |
|Check Password Review Status     |${Reviewer1}     |         |$RequestID   |       |Pending                         |
|Cannot Complete Review           |${Auditor}       |         |$RequestID                                            |
|BFER 6596 Prevent Deletion of System with Pending Review                                                            |
|Complete Review                  |${Reviewer2}     |         |$RequestID                                            |
|Check Password Review Status     |${Reviewer1}     |         |$RequestID   |       |Complete                        |



!|scenario                        |Session Reviewed By Specific Group Member                                         |
|Change PSM Reviewer Type And Name|${ManagedAccount}|on system|${SystemName}|to type|Group|with name|${ReviewerGroup}|
|Request And Open Session                                                                                            |
|Check Session Review Status      |${Reviewer2}     |         |$RequestID   |       |Overdue                         |
|Cannot Submit Comment            |${Reviewer1}     |         |$RequestID                                            |
|Submit Comment                   |${Reviewer2}     |         |$RequestID                                            |
|Check Session Review Status      |${Reviewer2}     |         |$RequestID   |       |Overdue                         |
|Submit Comment                   |${Auditor}       |         |$RequestID                                            |
|Check Session Review Status      |${Auditor}       |         |$RequestID   |       |Overdue                         |
|BFER 6596 Prevent Deletion of System with Pending Review                                                            |
|Cannot Complete Review           |${Auditor}       |         |$RequestID                                            |
|Complete Review                  |${Reviewer2}     |         |$RequestID                                            |
|Check Session Review Status      |${Reviewer2}     |         |$RequestID   |       |Complete                        |


!|scenario                   |Password Reviewed By Auditor                              |
|Change PPM Reviewer Type    |${ManagedAccount}|on system|${SystemName}|to type|Auditor |
|Release Password                                                                       |
|Check Password Review Status|${Reviewer1}     |         |$RequestID   |       |Pending |
|BFER 6596 Prevent Deletion of System with Pending Review                               |
|Cannot Submit Comment       |${Reviewer1}     |         |$RequestID                    |
|Cannot Submit Comment       |${Reviewer2}     |         |$RequestID                    |
|Submit Comment              |${Auditor}       |         |$RequestID                    |
|Check Password Review Status|${Reviewer1}     |         |$RequestID   |       |Pending |
|Complete Review             |${Auditor}       |         |$RequestID                    |
|Check Password Review Status|${Reviewer1}     |         |$RequestID   |       |Complete|


!|scenario                  |Session Reviewed By Auditor                               |
|Change PSM Reviewer Type   |${ManagedAccount}|on system|${SystemName}|to type|Auditor |
|Request And Open Session                                                              |
|Check Session Review Status|${Auditor}       |         |$RequestID   |       |Overdue |
|Cannot Submit Comment      |${Reviewer1}     |         |$RequestID                    |
|Cannot Submit Comment      |${Reviewer2}     |         |$RequestID                    |
|BFER 6596 Prevent Deletion of System with Pending Review                              |
|Submit Comment             |${Auditor}       |         |$RequestID                    |
|Check Session Review Status|${Auditor}       |         |$RequestID   |       |Overdue |
|Complete Review            |${Auditor}       |         |$RequestID                    |
|Check Session Review Status|${Auditor}       |         |$RequestID   |       |Complete|



!|scenario                   |Multiple Reviews Required                                      |
|Change PPM Reviewer Type    |${ManagedAccount}|on system|${SystemName}|to type     |Any     |
|Change PPM Review Count     |${ManagedAccount}|on system|${SystemName}|review count|3       |
|Release Password                                                                            |
|Check Password Review Status|${Reviewer1}     |         |$RequestID   |            |Pending |
|Complete Review             |${Reviewer1}     |         |$RequestID                         |
|Check Password Review Status|${Reviewer1}     |         |$RequestID   |            |Pending |
|Submit Comment              |${Reviewer1}     |         |$RequestID                         |
|Check Password Review Status|${Reviewer2}     |         |$RequestID   |            |Pending |
|Complete Review             |${Reviewer2}     |         |$RequestID                         |
|Check Password Review Status|${Reviewer2}     |         |$RequestID   |            |Pending |
|Submit Comment              |${Reviewer2}     |         |$RequestID                         |
|Check Reviews Count         |${Reviewer2}     |         |$RequestID   |            |4       |
|Check Password Review Status|${Auditor}       |         |$RequestID   |            |Pending |
|BFER 6596 Prevent Deletion of System with Pending Review                                    |
|Complete Review             |${Auditor}       |         |$RequestID                         |
|Check Password Review Status|${Auditor}       |         |$RequestID   |            |Complete|
|Cannot Submit Comment       |${Auditor}       |         |$RequestID                         |


!|scenario           |BFER 6596 Prevent Deletion of System with Pending Review|
|Cannot Remove System|${SystemName}   |   |unsatisfied.*review requirements   |


!|scenario                        |Review ISA Password Release                                 |
|Change PPM Review Count          |${ManagedAccount}|on system|${SystemName}    |review count|2|
|ISA Release Password                                                                          |
|Complete ISA Release Review      |${Reviewer2}     |         |${ManagedAccount}               |
|Submit ISA Release Comment       |${Reviewer2}     |         |${ManagedAccount}               |
|BFER 6185 Check ISA Reviews Count|${Reviewer1}     |         |${ManagedAccount}|            |2|
|BFER 6596 Prevent Deletion of System with Pending Review                                      |
|Complete ISA Release Review      |${Auditor}       |         |${ManagedAccount}               |
|Cannot Submit ISA Release Comment|${Auditor}       |         |${ManagedAccount}               |


!|scenario                        |Workaround BFER 6595 Review ISA Password Release        |
|Change PPM Review Count          |${ManagedAccount}|on system|${SystemName}|review count|2|
|ISA Release Password                                                                      |
|Cannot Submit ISA Release Comment|${Reviewer2}     |         |${ManagedAccount}           |
|Cannot Submit ISA Release Comment|${Reviewer2}     |         |${ManagedAccount}           |
|Complete ISA Release Review      |${Auditor}       |         |${ManagedAccount}           |
|Submit ISA Release Comment       |${Auditor}       |         |${ManagedAccount}           |




!|scenario                       |Replay Session Log And Complete Review                    |
|Enable-Disable Session Recording|${ManagedAccount}|on system|${SystemName}|enabled|Y       |
|Request And Open Session                                                                   |
|Check Session Review Status     |${Reviewer1}     |         |$RequestID   |       |Overdue |
|BFER 6596 Prevent Deletion of System with Pending Review                                   |
|Replay And Complete Review      |${Reviewer2}     |         |$RequestID                    |
|Check Session Review Status     |${Auditor}       |         |$RequestID   |       |Complete|


!|scenario        |Release Password                              |
|Request Password |${SystemName}||${ManagedAccount}||${Requestor}|
|Retrieve Password|${Requestor}                                  |
|Cancel Password Request                                         |


!|scenario      |Request And Open Session                          |
|Request Session|${SystemName}    ||${ManagedAccount}||${Requestor}|
|Open Sessions  |${Requestor}                                      |
|Cancel Sessions|${ManagedAccount}||${Requestor}                   |

!|scenario     |BFER6346              |
|Submit Comment|${Auditor}||$RequestID|

!|scenario        |Submit Comment |reviewerName                            |                            |requestID                            |
|$res=            |GroovyWebDriver|SubmitReviewComment;${TPAMHost};@reviewerName;${UserPwd};@requestID;This comment submitted by @reviewerName|
|Verify_Contain_OR|$res;;Comment submitted                                                                                                    |
|Verify_Contain_OR|$res;;Smith, @reviewerName.*N.*This comment submitted by @reviewerName                                                     |


!|scenario        |Complete Review|reviewerName                          |                          |requestID                          |
|$res=            |GroovyWebDriver|CompleteReview;${TPAMHost};@reviewerName;${UserPwd};@requestID;This review completed by @reviewerName|
|Verify_Contain_OR|$res;;Review completed                                                                                               |
|Verify_Contain_OR|$res;;Smith, @reviewerName.*Y.*This review completed by @reviewerName                                                |

!|scenario        |Submit ISA Release Comment|reviewerName                                |                               |accountName                               |
|$res=            |GroovyWebDriver           |SubmitISAReleaseReviewComment;${TPAMHost};@reviewerName;${UserPwd};@accountName;This comment submitted by @reviewerName|
|Verify_Contain_OR|$res;;Comment submitted                                                                                                                           |
|Verify_Contain_OR|$res;;Smith, @reviewerName.*N.*This comment submitted by @reviewerName                                                                            |


!|scenario        |Complete ISA Release Review|reviewerName                              |                             |accountName                             |
|$res=            |GroovyWebDriver            |CompleteISAReleaseReview;${TPAMHost};@reviewerName;${UserPwd};@accountName;This review completed by @reviewerName|
|Verify_Contain_OR|$res;;Review completed                                                                                                                       |
|Verify_Contain_OR|$res;;Smith, @reviewerName.*Y.*This review completed by @reviewerName                                                                        |


!|scenario        |BFER 6185 Check ISA Reviews Count|reviewerName         |         |accountName         |         |reviewsCount         |
|$res=            |GroovyWebDriver                  |CheckIsaReviewsCount;${TPAMHost};@reviewerName;${UserPwd};@accountName;@reviewsCount|
|Verify_Contain_OR|$res;;Rows count is right                                                                                             |


!|scenario        |Check Reviews Count|reviewerName         |         |accountName        |        |reviewsCount        |
|$res=            |GroovyWebDriver    |CheckReviewsCount;${TPAMHost};@reviewerName;${UserPwd};@accountName;@reviewsCount|
|Verify_Contain_OR|$res;;Rows count is right                                                                            |




!|scenario        |Replay And Complete Review|reviewerName                              |                              |requestID                              |
|$res=            |GroovyWebDriver           |ReplayLogAndCompleteReview;${TPAMHost};@reviewerName;${UserPwd};@requestID;This review completed by @reviewerName|
|Verify_Contain_OR|$res;;Need to replay session log                                                                                                            |
|Verify_Contain_OR|$res;;Review completed                                                                                                                      |
|Verify_Contain_OR|$res;;Smith, @reviewerName.*Y.*This review completed by @reviewerName                                                                       |


!|scenario        |Cannot Submit Comment|reviewerName                            |                            |requestID                            |
|$res=            |GroovyWebDriver      |SubmitReviewComment;${TPAMHost};@reviewerName;${UserPwd};@requestID;This comment submitted by @reviewerName|
|Verify_Contain_OR|$res;;Request ID unavailable                                                                                                     |


!|scenario        |Cannot Submit ISA Release Comment|reviewerName                                |                               |accountName                               |
|$res=            |GroovyWebDriver                  |SubmitISAReleaseReviewComment;${TPAMHost};@reviewerName;${UserPwd};@accountName;This comment submitted by @reviewerName|
|Verify_Contain_OR|$res;;Request ID unavailable                                                                                                                             |


!|scenario        |Cannot Complete Review|reviewerName                          |                          |requestID                          |
|$res=            |GroovyWebDriver       |CompleteReview;${TPAMHost};@reviewerName;${UserPwd};@requestID;This review completed by @reviewerName|
|Verify_Contain_OR|$res;;Complete Review Button Disabled                                                                                       |

!|scenario        |Check Password Review Status|reviewerName          |          |requestID          |          |status          |
|$res=            |GroovyWebDriver             |CheckPasswordReviewStatus;${TPAMHost};@reviewerName;${UserPwd};@requestID;@status|
|Verify_Contain_OR|$res;;${ManagedAccount}.*@status                                                                              |

!|scenario        |Check Session Review Status|reviewerName          |          |requestID          |          |status         |
|$res=            |GroovyWebDriver            |CheckSessionReviewStatus;${TPAMHost};@reviewerName;${UserPwd};@requestID;@status|
|Verify_Contain_OR|$res;;${ManagedAccount}.*@status                                                                            |

!|scenario               |Clear Objects                             |
|Login                   |${TPAMURL}   ||${TPAMAdmin}||${DefaultPwd}|
|Remove User From Group  |${CLI_user_1}||\"Global Requestor Group\" |
|Remove System           |${SystemName}                             |
|Session Cleanup         |${ManagedAccount}                         |
|Delete Account on System|${ManagedAccount}                         |
|Hard-Delete System      |${SystemName}                             |
|Remove User             |${Requestor}                              |
|Remove User             |${Approver}                               |
|Remove User             |${Reviewer1}                              |
|Remove User             |${Reviewer2}                              |
|Remove User             |${Auditor}                                |
|Remove User             |${ISA}                                    |
|Remove Group            |${ReviewerGroup}                          |
|Logout                                                             |

!|scenario               |Prepare Account|accountName  |                         |systemName||systemAddress|
|Add Account             |@accountName   |on system    |@systemName                                        |
|pause                   |3000                                                                             |
|Update PSM Details      |@accountName   |on system    |@systemName                                        |
|Create Account on System|@accountName   |with password|${ManagedAccountPassword}|on system |@systemAddress|


!| scenario       |Add System|systemName                   |                   |systemAddress                   |                   |systemPlatform                   |                   |functAcct                   |                  |funcAccPwd                  |
|$res=            |CLI       |${CLIBatch} AddSystem --SystemName @systemName --NetworkAddress @systemAddress --PlatformName \"@systemPlatform\" --FunctionalAccount @functAcct --FuncAcctCred @funcAccPwd --DomainName ${DomainName} --NetBiosName ${NETBIOSDomainName}|
|Verify_Contain_OR|$res;;successful                                                                                                                                                                                                                                    |


!| scenario       |Add Account|accountName                                                                   |on system                                                                   |systemName                                                                  |
|$res=            |CLI        |${CLIBatch} AddAccount --SystemName @systemName --AccountName @accountName --Password ${ManagedAccountPassword}  --Description \"@accountName description\" --MinimumApprovers 0 --ReleaseDuration 15 --ReviewerType Any --ReviewCount 1|
|Verify_Contain_OR|$res;;successful                                                                                                                                                                                                                                    |


!| scenario       |Update PSM Details|accountName                                                                              |on system                                                                             |systemName                                                                             |
|$res=            |CLI               |${CLIBatch} UpdateEGPAccount --System @systemName --Account @accountName  --ProxyType \"RDP - Automatic Login Using Password\" --ColorDepth 16 --DefaultSessionDuration 15 --EnableFlag Y  --MinApprovers 0 --RecordingRequiredFlag N --ReviewCount 1 --ReviewerType Any|
|Verify_Contain_OR|$res;;successful                                                                                                                                                                                                                                                                           |
#--RecordingRequiredFlag Y

!| scenario       |Enable-Disable Session Recording|accountName                                             |on system                                             |systemName                                             |enabled                                            |enable                                            |
|$res=            |CLI                             |${CLIBatch} UpdateEGPAccount --System @systemName --Account @accountName  --ProxyType \"RDP - Automatic Login Using Password\" --ColorDepth 16 --DefaultSessionDuration 15 --EnableFlag Y  --MinApprovers 0 --RecordingRequiredFlag @enable --ReviewCount 1 --ReviewerType Any|
|Verify_Contain_OR|$res;;successful                                                                                                                                                                                                                                                                                               |
#--RecordingRequiredFlag Y



!| scenario       |Change PPM Review Count|accountName          |on system          |systemName         |review count         |reviewCount         |
|$res=            |CLI                    |${CLIBatch} UpdateAccount --SystemName @systemName --AccountName @accountName --ReviewCount @reviewCount|
|Verify_Contain_OR|$res;;successful                                                                                                                |

!| scenario       |Change PPM Review Escalation settings|accountName          |on system          |systemName          |time          |hours          |e-mail          |email          |
|$res=            |CLI                                  |${CLIBatch} UpdateAccount --SystemName @systemName --AccountName @accountName --EscalationTime @hours --EscalationEmail @email|
|Verify_Contain_OR|$res;;successful                                                                                                                                                    |

!| scenario       |Change PPM Reviewer Type And Name|accountName         |on system         |systemName         |to type        |type        |with name        |reviewerName        |
|$res=            |CLI                              |${CLIBatch} UpdateAccount --SystemName @systemName --AccountName @accountName --ReviewerType @type --ReviewerName @reviewerName|
|Verify_Contain_OR|$res;;successful                                                                                                                                                 |

!| scenario       |Change PPM Reviewer Type|accountName           |on system           |systemName           |to type          |type          |
|$res=            |CLI                     |${CLIBatch} UpdateAccount --SystemName @systemName --AccountName @accountName --ReviewerType @type|
|Verify_Contain_OR|$res;;successful                                                                                                           |


!| scenario       |Change PSM Review Count|accountName          |on system          |systemName          |review count          |reviewCount          |
|$res=            |CLI                    |${CLIBatch} UpdatePSMAccount --SystemName @systemName --AccountName @accountName --ReviewCount @reviewCount|
|Verify_Contain_OR|$res;;successful                                                                                                                   |


!| scenario       |Change PSM Reviewer Type And Name|accountName         |on system         |systemName         |to type         |type         |with name         |reviewerName        |
|$res=            |CLI                              |${CLIBatch} UpdatePSMAccount --SystemName @systemName --AccountName @accountName --ReviewerType @type --ReviewerName @reviewerName|
|Verify_Contain_OR|$res;;successful                                                                                                                                                    |


!| scenario       |Change PSM Reviewer Type|accountName            |on system           |systemName           |to type           |type           |
|$res=            |CLI                     |${CLIBatch} UpdatePSMAccount --SystemName @systemName --AccountName @accountName --ReviewerType @type|
|Verify_Contain_OR|$res;;successful                                                                                                              |


!|scenario        |Set Group Permissions Account Level|groupName                       |                       |groupPermission                       |                       |accountName                      |
|$res=            |CLI                                |${CLIBatch} SetAccessPolicy --AccessPolicyName @groupPermission --Action ADD --SystemName ${SystemName} --AccountName @accountName --GroupName @groupName|
|Verify_Contain_OR|$res;;successful                                                                                                                                                                             |

!|scenario        |Set User Permissions System Level|userName                                 |                                 |userPermission                                 |
|$res=            |CLI                              |${CLIBatch} SetAccessPolicy --AccessPolicyName @userPermission --Action ADD --SystemName ${SystemName} --UserName @userName|
|Verify_Contain_OR|$res;;successful                                                                                                                                             |


!|scenario    |Create Account on System  |accountName  |with password  |pwd  |on system  |systemAddress  |
|accountAction|${SystemPlatform};;create;;@systemAddress;;${FunctAcct};;${FuncAccPwd};;@accountName;;@pwd|

!|scenario    |Delete Account on System                         |accountName                         |
|accountAction|${SystemPlatform};;delete;;${SystemAddress};;${FunctAcct};;${FuncAccPwd};;@accountName|



!|scenario |Prepare User|userName|with first name|firstName|and last name|lastName|with type|userType  |
|Add User  |@userName   |        |${DefaultPwd}  |         |@firstName   |        |@lastName||@userType|
|pause     |5000                                                                                       |
|Change Pwd|@userName   |        |${DefaultPwd}  |         |${UserPwd}                                 |



!|scenario        |Add User|userName         |         |password         |         |firstName         |        |lastName        |        |userType        |
|$res=            |CLI     |${CLIBatch} AddUser --UserName @userName --FirstName @firstName --LastName @lastName --Password @password --UserType @userType|
|Verify_Contain_OR|$res;;successful                                                                                                                       |


!|scenario        |Add Group|GroupName                                        |
|$res=            |CLI      |${CLIBatch} AddGroup @GroupName,"TPAM Test Group"|
|Verify_Contain_OR|$res;;successful                                           |


!|scenario        |Add User To Group|UserName          |         |GroupName         |
|$res=            |CLI              |${CLIBatch} AddGroupMember @UserName,@GroupName|
|Verify_Contain_OR|$res;;successful                                                 |


!|scenario        |Remove User From Group|UserName          |          |GroupName         |
|$res=            |CLI                   |${CLIBatch} DropGroupMember @UserName,@GroupName|
|Verify_Contain_OR|$res;;successful                                                       |


!| scenario       |Remove System|sysName                          |
|$res=            |CLI          |${CLIBatch} DeleteSystem @sysName|
|Verify_Contain_OR|$res;;successful                               |

!| scenario       |Cannot Remove System|sysName      |      |reason      |
|$res=            |CLI                 |${CLIBatch} DeleteSystem @sysName|
|Verify_Contain_OR|$res;;@reason                                         |


!| scenario       |Remove User|userName                        |
|$res=            |CLI        |${CLIBatch} DeleteUser @userName|
|Verify_Contain_OR|$res;;successful                            |

!|scenario        |Remove Group|GroupName                       |
|$res=            |CLI         |${CLIBatch} DropGroup @GroupName|
|Verify_Contain_OR|$res;;successful                             |



#!|scenario            |Open Session         |requestorName                   |                   |systemName                  |                  |accountName                  |
#|$res=                |CLI                  |${CLIBatch} AddSessionRequest --SystemName @systemName --AccountName @accountName --ForUserName @requestorName --RequestNotes test|
#|Verify_Contain_OR    |$res;;submitted                                                                                                                                         |
#|$RequestID=          |get_session_RequestID|$res                                                                                                                              |
#|Login                |${TPAMURL}||@requestorName       |                                |${UserPwd}                                                                                       |
#|pause                |20000                                                                                                                                                   |
#|click                |id=CurrentRequests                                                                                                                                      |
#|click         |link=$RequestID                                                                                                                                         |
#|click                |id=StartSessionButton                                                                                                                                   |
#|pause                |10000                                                                                                                                                   |
#|type;                |id=ResponseComment     |cancel             |
#|click                |id=SubmitChanges                           |
#|waitForTextPresent   |*The response * was submitted successfully*|
#|click                |id=TerminateSessionButton|
#|pause                |10000                    |


!|scenario        |Request Password|systemName                  |                  |accountName                  |                 |requestorName                 |
|$res=            |CLI             |${CLIBatch} AddPwdRequest --SystemName @systemName --AccountName @accountName --ForUserName @requestorName --RequestNotes test|
|Verify_Contain_OR|$res;;submitted                                                                                                                                |
|$RequestID=      |get_RequestID   |$res                                                                                                                          |



!|scenario        |Request Session      |systemName                   |                   |accountName                  |                  |requestorName                  |
|$res=            |CLI                  |${CLIBatch} AddSessionRequest --SystemName @systemName --AccountName @accountName --ForUserName @requestorName --RequestNotes test|
|Verify_Contain_OR|$res;;submitted                                                                                                                                         |
|$RequestID=      |get_session_RequestID|$res                                                                                                                              |


!|scenario   |Open Sessions|requestorName              |
|Login       |${TPAMURL}   ||@requestorName||${UserPwd}|
|pause       |20000                                    |
|click       |id=CurrentRequests                       |
|click       |link=$RequestID                          |
|click       |id=StartSessionButton                    |
|pause       |40000                                    |
|click       |id=TerminateSessionButton                |
|pause       |15000                                    |
|Logout                                                |
|selectWindow|Quest Software PSM                       |
|stop                                                  |


!|scenario  |Terminate Session|reqID                       |
|Login      |${TPAMURL}       ||${TPAMAdmin}||${DefaultPwd}|
|pause      |5000                                          |
|clickOnLink|link=Manage Sessions                          |
|click      |xpath=//td[contains(text(),'@reqID')]         |
|pause      |1000                                          |
|click      |id=TerminateButton                            |
|pause      |15000                                         |
|Logout                                                    |

!|scenario         |Cancel Sessions   |accountName|              |requestorName|
|Login             |${TPAMURL}        |           |@requestorName| |${UserPwd} |
|pause             |10000                                                      |
|click             |id=CurrentRequests                                         |
|click             |link=Sess(@accountName)                                    |
|click             |xpath=//td[contains(text(),'@accountName')]                |
|click             |id=Details                                                 |
|type;             |id=ResponseComment|cancel                                  |
|click             |id=SubmitChanges                                           |
|waitForTextPresent|*The response * was submitted successfully*                |
|Logout                                                                        |


!|scenario  |Replay Sessions|systemName|             |reviewerName|
|Login      |${TPAMURL}     |          |@reviewerName| |${UserPwd}|
|pause      |10000                                                |
|clickOnLink|link=Session Logs                                    |
|type;      |id=SystemNm    |@systemName                          |
|type;      |id=AccountNm   |${prefix}remote0                     |
|click      |id=Listing                                           |
|pause      |10000                                                |
|click      |xpath=//td[contains(text(),'${prefix}remote0')]      |
|pause      |2000                                                 |
|click      |id=ReplayButton                                      |
|pause      |30000                                                |
|click      |id=homeButton                                        |
|pause      |5000                                                 |
|Logout                                                           |


!|scenario         |Hard-Delete System                        |systemName |
|pause             |5000                                                  |
|clickOnLink       |link=Deleted Systems                                  |
|type;             |id=SystemNm                               |@systemName|
|click             |id=Listing                                |           |
|click             |xpath=//td[contains(text(),'@systemName')]|           |
|pause             |1000                                                  |
|click             |id=HardDeleteButton                       |           |
|getConfirmation                                                          |
|waitForTextPresent|has been successfully deleted                         |


!|scenario|Retrieve Password|requestorName              |
|Login    |${TPAMURL}       ||@requestorName||${UserPwd}|
|pause    |10000                                        |
|click    |id=CurrentRequests                           |
|click    |link=$RequestID                              |
|click    |id=Password                                  |
|pause    |20000                                        |
|Logout                                                 |

!|scenario     |ISA Release Password                    |
|Login         |${TPAMURL}          ||${ISA}||${UserPwd}|
|pause         |10000                                   |
|Choose Account|${ManagedAccount}                       |
|pause         |2000                                    |
|click         |id=Passwords                            |
|pause         |2000                                    |
|type;         |id=ReleaseReasonText|${ISA} pwd release |
|click         |id=Password                             |
|pause         |20000                                   |
|Logout                                                 |
|pause         |1000000                                 |



!| scenario        |Cancel Password Request                                       |
|Login             |${TPAMURL}            |    |${Requestor}    |   |${UserPwd}   |
|pause             |10000                                                         |
|click             |id=CurrentRequests    |                                       |
|click             |xpath=//table[@id='requestsTable']//tr[contains(@id,'P')]/td/a|
|type;             |id=ResponseComment    |Decline                                |
|click             |id=SubmitChanges                                              |
|waitForTextPresent|*The response* was submitted successfully*                    |
|Logout                                                                           |

!|scenario|Session Cleanup  |accountName                                                            |
|$res=    |RunBatchGetOutput|CleanupSession;${SystemAddress};${FunctAcct};${FuncAccPwd};@accountName|

!|scenario         |Check password review status of account|accnt    |on system      |systemName   |is   |status   |review started   |started   |
|Login             |${TPAMURL}                             |         |${Reviewer2}   |             |${UserPwd}                                  |
|click             |id=PendingReviews                                                                                                           |
|waitForTextPresent|*rows meeting filter criteria*                                                                                              |
|$sts=             |getText                                |xpath=//table[@id='requestsTable']/*/tr[td='Pwd(@accnt)' and td='@systemName']/td[6]|
|Verify_Contain_OR |$sts;;@status                                                                                                               |
|$sts=             |getText                                |xpath=//table[@id='requestsTable']/*/tr[td='Pwd(@accnt)' and td='@systemName']/td[7]|
|Verify_Contain_OR |$sts;;@started                                                                                                              |
|Logout                                                                                                                                         |
