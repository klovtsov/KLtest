!define ManagedAccount {${prefix}psAcnt}
!include -c <AutomatedTesting.ScenarioLibrary
!include -c <PowerShellNetApiScenarios.ScenarioLibrary

!|script                                                                                                                                                                                                                                                                                       |
|Create Account on System                                                                                                                                                                                                                                                                      |
|Add system             |${SystemName}                                                                                            |with address |${SystemAddress}    |platform|${SystemPlatform}|managed by|${FunctAcct}|additional parameters|-functAcctPwd ${FunctAcctPwd} -ChangeFrequency 0|
|Test System            |${TestSystemSuccessful}                                                                                                                                                                                                                                               |
|Add account            |${ManagedAccount}                                                                                        |with password|${ManagedAccountPwd}|                                                                                                                         |
|Schedule Reset Password|${CheckPasswordSuccessful}                                                                                                                                                                                                                                            |
|Calculate next month                                                                                                                                                                                                                                                                          |
|List Accounts by filter|-systemName ${SystemName} -AccountName ${ManagedAccount} -propsToList accountname,changefreq,nextChangeDt|contains     |${ManagedAccount}.*0.*$NextYear-$NextMonth-01                                                                                                      |

!*> Clean Up
!|script                                   |
|Delete Account on System|${ManagedAccount}|
|Delete Account          |${ManagedAccount}|
|Delete System           |${SystemName}    |
*!