!define checkRegexp {!-.*([0-9])\1+.*-!}

!include -c <AutoTestsWebDrv.ScenarioLibrary
!include -c <AutoTestsWebDrv.CliScenarios.ScenarioLibrary
!include -c <AutoTestsWebDrv.SynchronizedPasswords.ScenarioLibrary
!include -c ScenarioLibrary

!|script                                                                         |
|Login               |${TPAMAdminURL}       |        |${TPAMMaster}||${MasterPwd}|
|Select Password Rule|${PasswdRuleName}                                          |
|Set                 |MinChars              |equal to|20                         |
|Set                 |MaxChars              |equal to|50                         |
|Select value        |AlphaNumeric Permitted|for     |ReqFirst                   |
|Select value        |AlphaNumeric Permitted|for     |ReqLast                    |
|Select value        |Not Permitted         |for     |ReqUpper                   |
|Select value        |Not Permitted         |for     |ReqLower                   |
|Select value        |Permitted             |for     |ReqNum                     |
|Select value        |Not Permitted         |for     |CRepeat                    |
|click               |id=SubmitChangesButton                                     |

!3 Test the Rule for accounts
!|script                                                                                                                               |
|Test password generator                    |${checkRegexp}     |should present    |N                                                  |
|Generated account password does not contain|${checkRegexp}                                                                            |
|Check that Synchronized Password           |${SyncPasswordName}|with Password Rule|${PasswdRuleName}||does not contain||${checkRegexp}|
