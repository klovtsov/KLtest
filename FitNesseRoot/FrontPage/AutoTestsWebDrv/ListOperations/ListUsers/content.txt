!include -c <AutoTestsWebDrv.FailoverScenarios.ScenarioLibrary
!include -c <AutoTestsWebDrv.UsersTests.UserTypes.ScenarioLibrary

!define CSVEthalonFile {${ProjDir}\Scripts\Ethalons\ListOperations\Export\ExportUsers.csv}
!define ASPEthalonFile {${ProjDir}\Scripts\Ethalons\ListOperations\Export\ExportUsers.xls}
!define CSVResultFile {${ProjDir}\Scripts\Ethalons\ListOperations\ExportUsers.csv}
!define ASPResultFile {${ProjDir}\Scripts\Ethalons\ListOperations\ExportUsers.xls}
!define PathResultFile {${ProjDir}\Scripts\Ethalons\ListOperations\}

!define SystemName {${prefix}ListSystem}
!define SystemName1 {${SystemName}1}
!define SystemName2 {${SystemName}12}
!define SystemName3 {${SystemName}13}

!define UserName {${prefix}ListUser}
!define UserName1 {${UserName}1}
!define UserName2 {${UserName}2}
!define UserName3 {${UserName}3}
!define UserName4 {${UserName}4}

!define GroupName {${prefix}ListGroup}
!define GroupName1 {${GroupName}1}
!define GroupName2 {${GroupName}12}

!define SysAdminName {${prefix}CLIAdmin}
!define CLISysAdmBatch {-i ${SysAdminName}.ppk -C ${SysAdminName}@${TPAMHost}}

!include -c <AutoTestsWebDrv.ListOperations.ScenarioLibrary

!|script                                                                                                                                                                 |
|Add User         |${CLIBatch}   ||--UserName ${UserName1} --FirstName Mr --LastName White --Email Email@mail.com              ||successfully                            |
|Add User         |${CLIBatch}   ||--UserName ${UserName2} --FirstName Mr --LastName Black --Email Email@mail.com              ||successfully                            |
|Add User         |${CLIBatch}   ||--UserName ${UserName3} --FirstName Mr --LastName Red  --Email Email@mail.com               ||successfully                            |
|Add Group        |${CLIBatch}   ||--GroupName ${GroupName1}                                                                   ||successfully                            |
|Add Grp member   |${CLIBatch}   ||--GroupName ${GroupName1} --UserName ${UserName1}                                           ||successfully                            |
|Add Grp member   |${CLIBatch}   ||--GroupName ${GroupName1} --UserName ${UserName2}                                           ||successfully                            |
|Add Grp member   |${CLIBatch}   ||--GroupName ${GroupName1} --UserName ${UserName3}                                           ||successfully                            |
|Add Group        |${CLIBatch}   ||--GroupName ${GroupName2}                                                                   ||successfully                            |
|Add Grp member   |${CLIBatch}   ||--GroupName ${GroupName2} --UserName ${UserName1}                                           ||successfully                            |
|Add System       |${CLIBatch}   ||--SystemName ${SystemName1} --Platform Windows --NetworkAddress 1.1.1.1                     ||successfully                            |
|Add System       |${CLIBatch}   ||--SystemName ${SystemName2} --Platform Windows --NetworkAddress 1.1.1.1                     ||successfully                            |
|Add System       |${CLIBatch}   ||--SystemName ${SystemName3} --Platform Windows --NetworkAddress 1.1.1.1                     ||successfully                            |
|Set Access Policy|${CLIBatch}   ||--SystemName ${SystemName1} --Action ADD --AccessPolicyNam Approver --UserName ${UserName1} ||successfully                            |
|Set Access Policy|${CLIBatch}   ||--SystemName ${SystemName2} --Action ADD --AccessPolicyNam Requestor --UserName ${UserName1}||successfully                            |
|Set Access Policy|${CLIBatch}   ||--SystemName ${SystemName3} --Action ADD --AccessPolicyNam Requestor --UserName ${UserName1}||successfully                            |
|pause            |30000                                                                                                                                                 |
|List Users                                                                                                                                                              |
|Check Users Export                                                                                                                                                      |
|Open             |${TPAMURL}    ||${TPAMAdmin}                                                                                ||${DefaultPwd}                           |
|User Listing     |!=${UserName2}||${GroupName1}                                                                               ||${UserName3}.*${UserName1}||${UserName2}|
|stop                                                                                                                                                                    |
|Delete System    |${CLIBatch}   ||--SystemName ${SystemName1}                                                                 ||successfully                            |
|Delete System    |${CLIBatch}   ||--SystemName ${SystemName2}                                                                 ||successfully                            |
|Delete System    |${CLIBatch}   ||--SystemName ${SystemName3}                                                                 ||successfully                            |
|Delete User      |${CLIBatch}   ||--UserName ${UserName1}                                                                     ||successfully                            |
|Delete User      |${CLIBatch}   ||--UserName ${UserName2}                                                                     ||successfully                            |
|Delete User      |${CLIBatch}   ||--UserName ${UserName3}                                                                     ||successfully                            |
|Drop Group       |${CLIBatch}   ||--GroupName ${GroupName1}                                                                   ||successfully                            |
|Drop Group       |${CLIBatch}   ||--GroupName ${GroupName2}                                                                   ||successfully                            |


List Sys Admin Users.

!|script                                                                                                                                                                                                              |
|Add Web-disabled Sys-Admin User|${SysAdminName}                                                                                                                                                                      |
|Update Admin User              |${CLISysAdmBatch}||--UserName ${SysAdminName} --FirstName test --LastName test --Email testEmail@mail.com --Phone 123456789 --Mobile 987654321 --Description descriptor||successfully|
|List Sys Admin Users                                                                                                                                                                                                 |
|stop                                                                                                                                                                                                                 |
|Delete Sys-Admin User          |${SysAdminName}                                                                                                                                                                      |
|stop                                                                                                                                                                                                                 |

