!|scenario            |Open Session Do Nothing|requestorName         |                       |systemName         |         |accountName         |         |responceAction        |
|$res=                |CLI                    |${CLIBatch} AddSessionRequest --SystemName @systemName --AccountName @accountName --ForUserName @requestorName --RequestNotes test|
|Verify_Contain_OR    |$res;;submitted                                                                                                                                           |
|$RequestID=          |get_session_RequestID  |$res                                                                                                                              |
|stop                                                                                                                                                                            |
|Login                |${TPAMURL}             |                      |@requestorName         |                   |${UserPwd}                                                     |
|pause                |5000                                                                                                                                                      |
|click                |id=CurrentRequests                                                                                                                                        |
|waitForElementPresent|link=$RequestID                                                                                                                                           |
|clickOnLink          |link=$RequestID                                                                                                                                           |
|waitForElementPresent|id=StartSessionButton                                                                                                                                     |
|click                |id=StartSessionButton                                                                                                                                     |
|pause                |30000                                                                                                                                                     |
|selectWindow         |Quest Software PSM Session (${SystemName}/${ManagedAccount}/$RequestID)                                                                                   |
|pause                |150000                                                                                                                                                    |
|Try to Delete Account|${SystemName}          |                      |${ManagedAccount}                                                                                          |
|stop                                                                                                                                                                            |
|selectWindow         |Quest Software TPAM                                                                                                                                       |
|stop                                                                                                                                                                            |
|Cancel Session Request                                                                                                                                                          |

!|scenario        |Prepare Test                                                                                                     |
|Login            |${TPAMURL}       |          |${TPAMAdmin}     |         |${DefaultPwd}                                           |
|Add System       |${SystemName}    |          |${SystemAddress} |         |${SystemPlatform}|        |${FunctAcct}||${FunctAcctPwd}|
|Set Affinity                                                                                                                       |
|Prepare Account  |${ManagedAccount}|          |${SystemName}    |         |${SystemAddress}                                        |
|Prepare Requestor|${Requestor}                                                                                                     |
|Assign Policy    |${PolicyName}    |To Account|${ManagedAccount}|On System|${SystemName}    |And User|${Requestor}                 |
|Assign Policy    |Requestor        |To Account|${ManagedAccount}|On System|${SystemName}    |And User|${CLI_user_1}                |
|pause            |${ApplyNewPoliciesInterval}                                                                                      |
|Create logon script                                                                                                                |

!|scenario            |Set Affinity                                                                |
|Choose system        |${SystemName}                                                               |
|click                |id=Affinity                                                                 |
|waitForElementPresent|id=rbEGPAffinitySelected                                                    |
|click                |id=rbEGPAffinitySelected                                                    |
|type;                |xpath=//table[@id='tblEGPDPAAffinity']/*/tr[not(td='LocalServer')]/*/input|1|
|click                |id=bt_Save                                                                  |
|waitForTextPresent   |System changes for * saved successfully                                     |

