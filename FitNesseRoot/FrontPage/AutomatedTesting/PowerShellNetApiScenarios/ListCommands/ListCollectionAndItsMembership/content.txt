!define CollectionName {${prefix}ABXV}
!define CollectionName2 {${prefix}VXBV}
!define AnotherAccount {AliBaba}
!define collDescription {Collection for a list checking}

!include -c <PowerShellNetApiScenarios.ScenarioLibrary

!3 Prepare Environment
!|script                                                                                      |
|Add System                                                                                   |
|Add account   |${ManagedAccount}|with password|${ManagedAccountPwdNew}                       |
|Add Collection|${CollectionName}                                                             |
|Add Collection|${CollectionName2}                                                            |
|Add System    |${SystemName}    |to collection|${CollectionName}                             |
|Add Account   |${ManagedAccount}|from system  |${SystemName}|to collection|${CollectionName2}|


!3 List Collection
!|script                                                                                                                      |
|List Collection by filter           |-collection ${CollectionName2}|and result contains|${CollectionName2}                   |
|List Collection by filter           |-system ${SystemName}         |and result contains|${CollectionName}                    |
|List Collection Membership by filter|-collection ${CollectionName2}|and result contains|${CollectionName2}.*${ManagedAccount}|
|List Collection Membership by filter|-system ${SystemName}         |and result contains|${CollectionName}.*${SystemName}     |


!3 Modify Collection and list again
!|script                                                                                                                                       |
|Add account                         |${AnotherAccount}             |with password              |${ManagedAccountPwdNew}                       |
|Add Account                         |${AnotherAccount}             |from system                |${SystemName}|to collection|${CollectionName2}|
|List Collection Membership by filter|-collection ${CollectionName2}|and result contains        |${CollectionName2}.*${AnotherAccount}         |
|Drop Account                        |${ManagedAccount}             |from collection            |${CollectionName2}                            |
|List Collection Membership by filter|-collection ${CollectionName2}|and result does not contain|${ManagedAccount}                             |


!3 Clean Up
!|script                             |
|Delete Collection|${CollectionName} |
|Delete Collection|${CollectionName2}|
|Delete System    |${SystemName}     |
