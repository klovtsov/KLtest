!define pwdRegexp {!-[a-zA-Z0-9]{5,9}[a-zA-Z]$-!}

!include -c <AutoTestsWebDrv.ScenarioLibrary
!include -c <AutoTestsWebDrv.CliScenarios.ScenarioLibrary
!include -c <AutoTestsWebDrv.SynchronizedPasswords.ScenarioLibrary
!include -c ScenarioLibrary

!4 Set the password rule settings.
!|script                                                                          |
|Login               |${TPAMAdminURL}        |        |${TPAMMaster}||${MasterPwd}|
|Select Password Rule|${PasswdRuleName}                                           |
|Set                 |MaxChars               |equal to|10                         |
|Set                 |MinChars               |equal to|6                          |
|Select value        |Permitted              |for     |ReqUpper                   |
|Select value        |Permitted              |for     |ReqLower                   |
|Select value        |Permitted              |for     |ReqNum                     |
|Select value        |Any Character Permitted|for     |ReqFirst                   |
|Select value        |Alpha Characters Only  |for     |ReqLast                    |
|Select value        |Not Permitted          |for     |ReqNonAN                   |
|click               |id=SubmitChangesButton                                      |
!4 Test the Rule
!|script                                                                                                             |
|Test password generator            |${pwdRegexp}       |should present    |Y                                        |
|Generated account password contains|${pwdRegexp}                                                                    |
|Check that Synchronized Password   |${SyncPasswordName}|with Password Rule|${PasswdRuleName}||contains||${pwdRegexp}|
