!|scenario    |Prepare AD System                                                                                                                                                                     |
|Add ADSystem |${CLIBatch}||--SystemName ${SystemNameAD} --PlatformName \"${SystemPlatformAD}\" --NetworkAddress ${SystemAddressAD} --DomainName ${DomainName} --NetBiosName ${NETBIOS}||successfully|
|Add ADAccount|${CLIBatch}||--SystemName ${SystemNameAD} --AccountName ${QasFunctAcctAD} --Password ${QasFunctAcctPwdAD} --ReleaseNotifyEmail ${FuncAccEMail}                          ||successfully|
|Update System|${CLIBatch}||--SystemName ${SystemName} --DomainFuncAccount ${DomainName}\${QasFunctAcctAD}                                                                             ||successfully|

!| scenario       |Add ADSystem|CLIBatch | |options ||result|
|$res=            |CLI         |@CLIBatch AddSystem @options|
|Verify_Contain_OR|$res;;@result                            |

!| scenario       |Add ADAccount|CLIBatch | |options | |result|
|$res=            |CLI          |@CLIBatch AddAccount @options|
|Verify_Contain_OR|$res;;@result                              |

!|scenario               |Create Environment                       |
|Create Account on System|${ManagedAccount1}                       |
|Create Mailbox          |${NewAccountDiscoveryEmail1}   ||password|
|Create Mailbox          |${DeleteAccountDiscoveryEmail1}||password|
|Create Mailbox          |${SystemEMail}                 ||password|
|Create Mailbox          |${FuncAccEMail}                ||password|
|Create Template                                                   |
|Create Account Discovery Profile                                  |
|Prepare AD System                                                 |


!|scenario                         |Delete Environment                                  |
|Delete Mails                                                                           |
|Delete Mailbox                    |${NewAccountDiscoveryEmail1}                        |
|Delete Mailbox                    |${DeleteAccountDiscoveryEmail1}                     |
|Delete Mailbox                    |${SystemEMail}                                      |
|Delete Mailbox                    |${FuncAccEMail}                                     |
|Set AccDiscovery profile to System|No Account Discovery Profile selected||${SystemName}|
|Remove system                     |${SystemName}                                       |
|Delete Account Discovery Profile  |${ProfileName}                                      |
|Remove system                     |${TemplateName}                                     |
|Remove system                     |${SystemNameAD}                                     |

!|scenario|Add Detail                  |Index||NewAccountAction||TemplateAccount||EmailAddresses||UID||SID||Name||Group||Role||Task||Service|
|click    |id=btnAddRow                                                                                                                     |
|select;  |className=autoNewAction     |label=@NewAccountAction                                                                             |
|select;  |className=autoAcctTemplate  |label=@TemplateAccount                                                                              |
|type;    |className=autoEmailAddresses|@EmailAddresses                                                                                     |
|type;    |className=autoUIDFilter     |@UID                                                                                                |
|type;    |className=autoNameFilter    |@Name                                                                                               |
|type;    |className=autoGroupFilter   |@Group                                                                                              |
