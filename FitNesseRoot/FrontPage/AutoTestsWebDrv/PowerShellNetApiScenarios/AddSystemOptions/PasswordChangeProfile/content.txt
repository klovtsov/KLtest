!define pwdChangeFreq {10}
!define pwdChangeProfile {First of Month}
!define ManagedAccount {${prefix}psAcnt}
!include -c <AutoTestsWebDrv.ScenarioLibrary
!include -c <PowerShellNetApiScenarios.ScenarioLibrary

!|script                                                                                                                                                                                                                                                                                                      |
|Create Account on System                                                                                                                                                                                                                                                                                     |
|Add system             |${SystemName}                                                                                 |with address |${SystemAddress}    |platform|${SystemPlatform}|managed by|${FunctAcct}|additional parameters|-functAcctPwd ${FunctAcctPwd} -passwordChangeProfile "${pwdChangeProfile}"|
|Test System            |${TestSystemSuccessful}                                                                                                                                                                                                                                                              |
|Add account            |${ManagedAccount}                                                                             |with password|${ManagedAccountPwd}|                                                                                                                                                   |
|Reset Password         |${ResetPasswordSuccessful}                                                                                                                                                                                                                                                           |
|Calculate next month                                                                                                                                                                                                                                                                                         |
|List Accounts by filter|-systemName ${SystemName} -AccountName ${ManagedAccount} -propsToList accountname,nextChangeDt|contains     |${ManagedAccount}.*$NextYear-$NextMonth-01                                                                                                                              |

!*> Clean Up
!|script                                   |
|Delete Account on System|${ManagedAccount}|
|Delete Account          |${ManagedAccount}|
|Delete System           |${SystemName}    |
*!
