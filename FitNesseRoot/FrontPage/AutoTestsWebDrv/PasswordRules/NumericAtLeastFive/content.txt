!define checkRegexp {!-.*([0-9].+){5,}.*-!}

!include -c <AutoTestsWebDrv.ScenarioLibrary
!include -c <AutoTestsWebDrv.CliScenarios.ScenarioLibrary
!include -c <AutoTestsWebDrv.SynchronizedPasswords.ScenarioLibrary
!include -c ScenarioLibrary
!4 Set the password rule settings.
!|script                                                                        |
|Login               |${TPAMAdminURL}      |        |${TPAMMaster}||${MasterPwd}|
|Select Password Rule|${PasswdRuleName}                                         |
|Set                 |MinChars             |equal to|13                         |
|Set                 |MaxChars             |equal to|16                         |
|Select value        |Alpha Characters Only|for     |ReqFirst                   |
|Select value        |Alpha Characters Only|for     |ReqLast                    |
|Select value        |Permitted            |for     |ReqUpper                   |
|Select value        |Permitted            |for     |ReqLower                   |
|Select value        |Not Permitted        |for     |ConsecutiveNumeric         |
|Select value        |Require at least 5   |for     |ReqNum                     |
|click               |id=SubmitChangesButton                                    |

!3 Test the Rule
!|script                                                                                                               |
|Test password generator            |${checkRegexp}     |should present    |Y                                          |
|Generated account password contains|${checkRegexp}                                                                    |
|Check that Synchronized Password   |${SyncPasswordName}|with Password Rule|${PasswdRuleName}||contains||${checkRegexp}|
