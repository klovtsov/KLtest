!define newAccontName {Nura}
!*> Test description
In order to enable this option the password minimum length must be at least 10, the max length at least 20,
and must require at least 1 of each uppercase, lowercase, and numeric characters.
*!

!include -c <AutoTestsWebDrv.ScenarioLibrary
!include -c <AutoTestsWebDrv.CliScenarios.ScenarioLibrary
!include -c <AutoTestsWebDrv.SynchronizedPasswords.ScenarioLibrary
!include -c ScenarioLibrary

!3 Check option enabling.
!|script                                                                         |
|Login                      |${TPAMAdminURL}|        |${TPAMMaster}||${MasterPwd}|
|Let Off                                                                         |
|Set                        |MaxChars       |equal to|20                         |
|Set                        |MinChars       |equal to|10                         |
|click                      |id=SubmitChangesButton                              |
|Check Password reuse global|enabled                                             |

!4 If min password length less then 10 
!|script                                           |
|Set                        |MinChars |equal to |9 |
|click                      |id=SubmitChangesButton|
|Check Password reuse global|disabled              |

!4 If max password length less then 20 
!|script                                           |
|Set                        |MinChars |equal to |11|
|Set                        |MaxChars |equal to |19|
|click                      |id=SubmitChangesButton|
|Check Password reuse global|disabled              |

!4 If uppercase requirement is too weak 
!|script                                                |
|Set                        |MaxChars |equal to|20      |
|Select value               |Permitted|for     |ReqUpper|
|click                      |id=SubmitChangesButton     |
|Check Password reuse global|disabled                   |

!4 If lowercase requirement is too weak 
!|script                                                    |
|Select value               |Require at least 3|for|ReqUpper|
|Select value               |Permitted         |for|ReqLower|
|click                      |id=SubmitChangesButton         |
|Check Password reuse global|disabled                       |

!4 If numeric requirement is too weak 
!|script                                                    |
|Select value               |Require at least 2|for|ReqLower|
|Select value               |Permitted         |for|ReqNum  |
|click                      |id=SubmitChangesButton         |
|Check Password reuse global|disabled                       |

!4 Restore 
!|script                                                             |
|Select value               |Require at least 2|for|ReqNum           |
|click                      |id=SubmitChangesButton                  |
|Check Password reuse global|enabled                                 |
|Select value               |Not Permitted     |for|AllowRepeatGlobal|
|click                      |id=SubmitChangesButton                  |

!3 Check that password reuse prohibition applies only to passwords generated by TPAM.
!4 It is possible to manually set the reused password to an account 
!|script                                                                                                                                    |
|Reset Password                           |${ManagedAccount}|             |${ResetPasswordSuccessful}                                       |
|Get Generated Password                                                                                                                     |
|Add manual account                       |${newAccontName} |with password|$GeneratedPwd|password rule|${PasswdRuleName}|result|${NotFailed}|
|Force Reset manual password              |${newAccontName} |from         |${SystemName}                                                    |
|Confirm Manual Password reset with status|success          |and result is|Successful commit                                                |
|Set password                             |$GeneratedPwd    |for account  |${newAccontName}                                                 |

!4 It is possible to manually set the reused password to an synchronized password. 
!|script                                                                                                                                                                                      |
|Add Sync Password          |${SyncPasswordName}|with value|${SincPwdInitialValue}|Password Rule|${PasswdRuleName}|change profile|${syncPwdChangeProfile}|check profile|${syncPwdCheckProfile}|
|Set new Sync Password value|$GeneratedPwd      |          |Synchronized Password Updated successfully                                                                                        |
|Delete Sync Password       |${SyncPasswordName}                                                                                                                                              |
|Remove account             |${newAccontName}                                                                                                                                                 |
