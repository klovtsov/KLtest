!|scenario    |Add User to srvrole                                  |Account                                 |
|accountAction|${SystemPlatform};;addsrvrolemember;;${SystemAddress};;${FunctAcct};;${FunctAcctPwd};;@Account|

!|scenario    |Drop User to srvrole                                  |Account                                 |
|accountAction|${SystemPlatform};;dropsrvrolemember;;${SystemAddress};;${FunctAcct};;${FunctAcctPwd};;@Account|

!|scenario               |Create Environment                       |
|Create Account on System|${ManagedAccount1}                       |
|Create Account on System|${AutoDiscoveryAccount2}                 |
|Add User to srvrole     |${AutoDiscoveryAccount2}                 |
|Create Mailbox          |${NewAccountDiscoveryEmail1}   ||password|
|Create Mailbox          |${DeleteAccountDiscoveryEmail1}||password|
|Create Mailbox          |${SystemEMail}                 ||password|
|Create Mailbox          |${FuncAccEMail}                ||password|
|Create Template                                                   |
|Create Account Discovery Profile                                  |

!|scenario                    |Create Account Discovery Profile                                                                                                                                                             |
|click                        |link=Profile Management                                                                                                                                                                      |
|pause                        |5000                                                                                                                                                                                         |
|waitForElementPresent        |id=NewButton            |                                                                                                                                                                    |
|click                        |id=NewButton                                                                                                                                                                                 |
|type;                        |id=ProfileName          |${ProfileName}                                                                                                                                                      |
|type;                        |id=Description          |Description                                                                                                                                                         |
|Set Delete Account properties|Both (Notify & Turn Off)||${DeleteAccountDiscoveryEmail1},:System:,:Functional:                                                                                                              |
|Add Detail                   |0                       ||Both (Notify & Create)||${TemplateName}/${AutoDiscoveryAccount1}||${NewAccountDiscoveryEmail1},:System:,:Functional:||||||${AutoDiscoveryAccount1}||||dbcreator|||||
|click                        |id=SaveButton                                                                                                                                                                                |
|waitForTextPresent           |The profile saved successfully                                                                                                                                                               |

!|scenario                         |Delete Environment                                  |
|Delete Mails                                                                           |
|Delete Mailbox                    |${NewAccountDiscoveryEmail1}                        |
|Delete Mailbox                    |${DeleteAccountDiscoveryEmail1}                     |
|Delete Mailbox                    |${SystemEMail}                                      |
|Delete Mailbox                    |${FuncAccEMail}                                     |
|Set AccDiscovery profile to System|No Account Discovery Profile selected||${SystemName}|
|Remove system                     |${SystemName}                                       |
|Delete Account Discovery Profile  |${ProfileName}                                      |
|Remove system                     |${TemplateName}                                     |
|Drop User to srvrole              |${AutoDiscoveryAccount2}                            |
|Delete Account on System          |${AutoDiscoveryAccount2}                            |

!|scenario                         |New Account Action                                                                                  |
|Remove account                    |${AutoDiscoveryAccount1}                                                                            |
|Set AccDiscovery profile to System|${ProfileName}          ||${SystemName}                                                             |
|Run AccDiscovery                                                                                                                       |
|Check results                     |${AutoDiscoveryAccount1}||${SystemName}                                                             |
|Check results                     |${AutoDiscoveryAccount2}||${SystemName}                                                             |
|pause                             |180000                                                                                              |
|Check Mail                        |${MailServer}           ||${NewAccountDiscoveryEmail1}||password||${FromMail}||${AADNAN}||${AADNANb}|
|Check Mail                        |${MailServer}           ||${SystemEMail}              ||password||${FromMail}||${AADNAN}||${AADNANb}|
|Check Mail                        |${MailServer}           ||${FuncAccEMail}             ||password||${FromMail}||${AADNAN}||${AADNANb}|


