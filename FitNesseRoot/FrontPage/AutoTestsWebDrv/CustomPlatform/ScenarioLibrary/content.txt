!contents



!|scenario|Test CLI Custom Platform|
|Prepare CLI Test                  |
|PPM CLI Regular Activity          |
|Clear CLI Test                    |


!|scenario|PPM UI Regular Activity|
|Managed UI System                |
|Managed UI Account               |
|Request UI Password and Login    |


!|scenario|PPM CLI Regular Activity|
|Managed CLI System                |
|Managed CLI Account               |
|Request CLI Password and Login    |


!|scenario    |PSM Activity   |
|Enable PSM on Custom Platform|
|Enable PSM for Account       |
|Request and Open Session     |
|Cancel Session               |
#|Check Transfer File          |


!|scenario         |Deactivate Platform Automation                      |
|Login             |${TPAMURL}   |    |${TPAMAdmin}  |  |${DefaultPwd}  |
|pause             |10000                                               |
|clickOnLink       |link=Custom Platforms                               |
|click             |id=Listing                                          |
|pause             |1000                                                |
|click             |xpath=//td[contains(text(),'${CustomPlatformName}')]|
|pause             |1000                                                |
|click             |id=Details                                          |
|pause             |1000                                                |
|click             |id=AutomationActiveFl                               |
|pause             |1000                                                |
|click             |id=btnSavePlatform                                  |
|waitForTextPresent|saved successfully                                  |
|$res=             |getText      |xpath=//div[@id='ResultsDiv']         |
|Verify_Contain_OR |$res;;saved successfully                            |
|pause             |1000                                                |
|Logout                                                                 |


!|scenario         |Activate Platform Automation                        |
|Login             |${TPAMURL}   |    |${TPAMAdmin}  |  |${DefaultPwd}  |
|pause             |10000                                               |
|clickOnLink       |link=Custom Platforms                               |
|click             |id=Listing                                          |
|pause             |1000                                                |
|click             |xpath=//td[contains(text(),'${CustomPlatformName}')]|
|pause             |1000                                                |
|click             |id=Details                                          |
|pause             |1000                                                |
|click             |id=AutomationActiveFl                               |
|pause             |1000                                                |
|click             |id=btnSavePlatform                                  |
|waitForTextPresent|saved successfully                                  |
|$res=             |getText      |xpath=//div[@id='ResultsDiv']         |
|Verify_Contain_OR |$res;;saved successfully                            |
|pause             |1000                                                |
|Logout                                                                 |


!|scenario         |Check Manual PPM Still Working               |
|Check CLI Password|${ManagedAccount}||matches the managed system|
|Reset CLI Password|${ManagedAccount}||successfully              |
|Request CLI Password and Login                                  |


!|scenario                        |Check Automated PPM Do Not Work              |
|Schedule Failed Reset CLI Password                                             |
|Login Account to System          |$GeneratedPwd                                |
|Change Account Password on System|Ch4ngedPa$$                                  |
|Check CLI Password               |${ManagedAccount}||DOES NOT MATCH            |
|pause                            |300000                                       |
|Login Account to System          |Ch4ngedPa$$                                  |
|Reset CLI Password               |${ManagedAccount}||successfully              |
|Check CLI Password               |${ManagedAccount}||matches the managed system|

 


!|scenario         |Update UI Account Description|accountName||accountDescription|
|Choose Account    |@accountName                                                 |
|pause             |1000                                                         |
|click             |id=Details                   |                               |
|type;             |id=AcctDesc                  |@accountDescription            |
|pause             |1000                                                         |
|click             |id=SubmitChangesButton       |                               |
|waitForTextPresent|Changes saved successfully for                               |


!|scenario            |Add UI System                                   |
|pause                |5000                                            |
|clickOnLink          |link=Add System                                 |
|waitForElementPresent|id=SystemName                                   |
|type;                |id=SystemName       |${SystemName}              |
|type;                |id=NetworkAddress   |${SystemAddress}           |
|select;              |id=PlatformID       |label=${CustomPlatformName}|
|type;                |id=PlatSpecificValue|${PlatformSpecificValue}   |
|click                |id=Connection       |                           |
|type;                |id=PARFuncAcct      |${FuncAcct}                |
|type;                |id=pword            |${FuncAcctPassword}        |
|type;                |id=ConfPword        |${FuncAcctPassword}        |
|type;                |id=EnablePwd        |${EnablePassword}          |
|type;                |id=ConfEnablePwd    |${EnablePassword}          |
|type;                |id=DomainName       |${DomainName}              |
|type;                |id=NetBiosName      |${NetBIOSDomainName}       |
|type;                |id=Port             |${SystemPort}              |
|click                |id=bt_Save          |                           |
|waitForTextPresent   |System changes for * saved successfully         |

!|scenario         |Remove UI System|
|Remove system     |${SystemName}   |
|Hard-Delete System|${SystemName}   |

!|scenario            |Add UI Account                              |accountName              |
|pause                |5000                                                                  |
|clickOnLink          |link=Add Account                            |                         |
|pause                |5000                                                                  |
|type;                |id=SystemNm                                 |${SystemName}            |
|click                |id=System                                   |                         |
|waitForElementPresent|xpath=//td[contains(text(),'${SystemName}')]|                         |
|mouseMoveOver        |xpath=//td[contains(text(),'${SystemName}')]|                         |
|click                |xpath=//td[contains(text(),'${SystemName}')]|                         |
|pause                |2000                                                                  |
|click                |id=Details                                  |                         |
|pause                |2000                                                                  |
|type;                |id=AccountName                              |@accountName             |
|type;                |id=sPswd                                    |${ManagedAccountPassword}|
|type;                |id=sConfPswd                                |${ManagedAccountPassword}|
|pause                |1000                                                                  |
|click                |id=SubmitChangesButton                      |                         |
|waitForTextPresent   |Changes saved successfully for @accountName                           |

!| scenario       |Add CLI account|acc                                                                                                                                                         |
|$res=            |CLI            |${CLIBatch} AddAccount --SystemName ${SystemName} --AccountName @acc --Password \"${ManagedAccountPassword}\" --Description \"${ManagedAccountDescription}\"|
|Verify_Contain_OR|$res;;successfully                                                                                                                                                          |

!| scenario       |Add CLI account With Profiles|acc                                        |                                        |passCheck                                        |                                        |passChange                                        |
|$res=            |CLI                          |${CLIBatch} AddAccount --SystemName ${SystemName} --AccountName @acc --Password \"${ManagedAccountPassword}\" --Description \"${ManagedAccountDescription}\" --PasswordCheckProfile @passCheck --PasswordChangeProfile @passChange|
|Verify_Contain_OR|$res;;successfully                                                                                                                                                                                                                                              |


!|scenario            |XXXXXXXChoose Account                                         |accountName  |
|pause                |5000                                                                        |
|click                |link=Manage Accounts                                          |             |
|pause                |6000                                                                        |
|waitForElementPresent|id=SystemNm                                                   |             |
|type;                |id=SystemNm                                                   |${SystemName}|
|pause                |1000                                                                        |
|click                |id=Listing                                                    |             |
|pause                |3000                                                                        |
|waitForElementPresent|xpath=//table[@id='AccountListing']//td[text()='@accountName']|             |
|mouseMoveOver        |xpath=//table[@id='AccountListing']//td[text()='@accountName']|             |
|click                |xpath=//table[@id='AccountListing']//td[text()='@accountName']|             |


!| scenario       |Add CLI System                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|$res=            |CLI|${CLIBatch} AddSystem --SystemName ${SystemName} --NetworkAddress ${SystemAddress} --PlatformName \"Custom Platform/${CustomPlatformName}\" --FunctionalAccount ${FuncAcct} --FuncAcctCred \"${FuncAcctPassword}\" --Timeout ${SystemTimeout} --DomainName ${DomainName} --NetBiosName ${NetBIOSDomainName} --PortNumber ${SystemPort} --EnablePassword ${EnablePassword} --PlatSpecificValue ${PlatformSpecificValue} --PasswordCheckProfile ${PpmCheckProfile} --PasswordChangeProfile ${PpmChangeProfile}|
|Verify_Contain_OR|$res;;successful                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |

!|scenario        |Remove CLI System                                      |
|$res=            |CLI|${CLIBatch} DeleteSystem --SystemName ${SystemName}|
|Verify_Contain_OR|$res;;successful                                       |


!|scenario        |Remove CLI Account|accountName                                                                    |
|$res=            |CLI               |${CLIBatch} DeleteAccount --SystemName ${SystemName} --AccountName @accountName|
|Verify_Contain_OR|$res;;successful                                                                                  |


!| scenario       |Update CLI Account Description|accountName                            |                           |accountDescription                           |
|$res=            |CLI                           |${CLIBatch} UpdateAccount --SystemName ${SystemName} --AccountName @accountName --Description @accountDescription|
|Verify_Contain_OR|$res;;successful                                                                                                                                |

!| scenario       |Update CLI Account Profiles|accountName                       |                       |checkProfile                       |                       |changeProfile                       |
|$res=            |CLI                        |${CLIBatch} UpdateAccount --SystemName ${SystemName} --AccountName @accountName --PasswordCheckProfile @checkProfile --PasswordChangeProfile @changeProfile|
|Verify_Contain_OR|$res;;successful                                                                                                                                                                       |


!| scenario       |Set CLI Password|acc                           |                          |passwd                          |
|$res=            |CLI             |${CLIBatch} UpdateAccount --System ${SystemName} --AccountName @acc --Password \"@passwd\"|
|Verify_Contain_OR|$res;;successful                                                                                           |



!|scenario   |Schedule Reset CLI Password|testResult          |
|pause       |240000                                          |
|Check Status|@testResult                |for reason|Scheduled|


!|scenario         |Schedule Failed Reset CLI Password|
|Remove CLI Account|${ManagedAccount}                 |
|Add CLI account   |${ManagedAccount}                 |
|pause             |240000                            |
#|Check Status      |failed   |for reason  |Scheduled  |



!| scenario    |Managed UI System                |
|Test System   |successful                       |
|Choose Account|${FuncAcct}                      |
|Set password  |${FuncAcct}||${FunctAcctWrongPwd}|
|Test System   |failed                           |
|Choose Account|${FuncAcct}                      |
|Check Password|DOES NOT MATCH                   |

!| scenario                       |Test DPA                                                  |
|Set Affinity                                                                                |
|pause                            |300000                                                    |
|Test DPA System                  |successful                                                |
|Choose Account                   |${ManagedAccount}                                         |
|Reset DPA Password               |successful                                                |
|Update CLI Account Profiles      |${ManagedAccount}||${PpmCheckProfile}||${PpmChangeProfile}|
|Check DPA Password               |matches the managed system                                |
|Change Account Password on System|${ManagedAccountPwdNew}                                   |
|Check DPA Password               |DOES NOT MATCH                                            |
|pause                            |60000                                                     |
|Check DPA Password               |matches the managed system                                |
|Logout                                                                                      |


!| scenario        |Managed CLI System               |
|Test CLI System   |successful                       |
|Set CLI password  |${FuncAcct}||${FunctAcctWrongPwd}|
|Test CLI System   |failed                           |
|Check CLI Password|${FuncAcct}||DOES NOT MATCH      |


!| scenario                       |Managed UI Account                                                                                                       |
|Choose Account                   |${ManagedAccount}                                                                                                        |
|Reset Password                   |error occurred changing the password                                                                                     |
|Remove account                   |${ManagedAccount}                                                                                                        |
|Add PPM account                  |${ManagedAccount}|with password|${ManagedAccountPwd}|and profiles|${PpmCheckProfile}                ||${PpmChangeProfile}|
|Schedule Reset Password          |Failed                                                                                                                   |
|Change Account Password on System|${ManagedAccountPwdNew}                                                                                                  |
|Choose Account                   |${FuncAcct}                                                                                                              |
|Set password                     |${FuncAcct}      |             |${FuncAcctPassword}                                                                      |
|pause                            |${RestoreFunctAcctPasswordTimeout}                                                                                       |
|Choose Account                   |${ManagedAccount}                                                                                                        |
|Check Password                   |DOES NOT MATCH                                                                                                           |
|pause                            |${RestoreFunctAcctPasswordTimeout}                                                                                       |
|Check Status                     |Success          |for reason   |Mismatch                                                                                 |
|Reset Password                   |successful                                                                                                               |
|Remove account                   |${ManagedAccount}                                                                                                        |
|Change Account Password on System|${ManagedAccountPwd}                                                                                                     |
|Add PPM account                  |${ManagedAccount}|with password|${ManagedAccountPwd}|and profiles|${PersistentPasswordCheckProfile1}||${PpmChangeProfile}|
|Forced Reset                     |Success                                                                                                                  |
|Logout                                                                                                                                                     |

!| scenario                       |Managed CLI Account                                                                 |
|Reset CLI Password               |${ManagedAccount}|          |error occurred changing the password                   |
|Remove CLI Account               |${ManagedAccount}                                                                   |
|Change Account Password on System|${ManagedAccountPwd}                                                                |
|Add CLI account With Profiles    |${ManagedAccount}|          |${PpmCheckProfile}                ||${PpmChangeProfile}|
|Schedule Reset CLI Password      |Failed                                                                              |
|Change Account Password on System|${ManagedAccountPwdNew}                                                             |
|Set CLI password                 |${FuncAcct}      |          |${FuncAcctPassword}                                    |
|pause                            |${RestoreFunctAcctPasswordTimeout}                                                  |
|Check CLI Password               |${ManagedAccount}|          |DOES NOT MATCH                                         |
|pause                            |${RestoreFunctAcctPasswordTimeout}                                                  |
|Choose Account                   |${ManagedAccount}                                                                   |
|Check Status                     |Success          |for reason|Mismatch                                               |
|Reset CLI Password               |${ManagedAccount}|          |successful                                             |
|Remove CLI Account               |${ManagedAccount}                                                                   |
|Change Account Password on System|${ManagedAccountPwd}                                                                |
|Add CLI account With Profiles    |${ManagedAccount}|          |${PersistentPasswordCheckProfile1}||${PpmChangeProfile}|
|Forced Reset                     |Success                                                                             |
|Logout                                                                                                                |

!| scenario          |Request UI Password and Login                    |
|Login               |${TPAMURL}|          |${TPAMAdmin}||${DefaultPwd}|
|pause               |4000                                             |
|Set User Permissions|${Requestor}                                     |
|Set User Permissions|${Approver}                                      |
|pause               |${ApplyNewPoliciesInterval}                      |
|Logout                                                                |
|Request Pwd                                                           |
|Approve Pwd                                                           |
|Get Login                                                             |
|pause               |120000                                           |
|Login               |${TPAMURL}|          |${TPAMAdmin}||${DefaultPwd}|
|pause               |10000                                            |
|Check Status        |Success   |for reason|Post Release Reset         |
|Logout                                                                |

!| scenario              |Request CLI Password and Login|
|Set CLI User Permissions|${CLI_user_1}                 |
|Set CLI User Permissions|${CLI_user_2}                 |
|Request CLI Pwd                                        |
|Approve CLI Pwd                                        |
|Get CLI Login                                          |


!|scenario|Check Automation Inactive Platform|
|Deactivate Platform Automation              |
|Prepare CLI Test                            |
|Check Manual PPM Still Working              |
|Check Automated PPM Do Not Work             |
|stop                                        |
|Clear CLI Test                              |
|Activate Platform Automation                |



!|scenario        |Set CLI User Permissions|userName                                                                                                                                                        |
|$res=            |CLI                     |${CLIBatch} SetAccessPolicy --AccessPolicyName "Approver-Requestor" --Action ADD --SystemName ${SystemName} --AccountName ${ManagedAccount} --UserName @userName|
|Verify_Contain_OR|$res;;successful                                                                                                                                                                         |

!|scenario        |Revoke CLI User Permissions|userName                                                                                                                                                         |
|$res=            |CLI                        |${CLIBatch} SetAccessPolicy --AccessPolicyName "Approver-Requestor" --Action DROP --SystemName ${SystemName} --AccountName ${ManagedAccount} --UserName @userName|
|Verify_Contain_OR|$res;;successful                                                                                                                                                                             |


!| scenario       |Request CLI Pwd                                                                                                                            |
|$res=            |CLI          |${CLIBatch} AddPwdRequest --SystemName ${SystemName} --AccountName ${ManagedAccount} --ReleaseDuration 15 --RequestNotes test|
|Verify_Contain_OR|$res;;submitted                                                                                                                            |
|$RequestID=      |get_RequestID|$res                                                                                                                         |

!| scenario       |Approve CLI Pwd                                             |
|$res=            |CLI|${CLIBatch2} Approve --RequestID $RequestID --Comment OK|
|Verify_Contain_OR|$res;;submitted                                             |

!| scenario             |Get CLI Login                                  |
|$GeneratedPwd=         |CLI|${CLIBatch} Retrieve --RequestID $RequestID|
|Login Account to System|$GeneratedPwd                                  |


!|scenario         |Remove system     |sysName     |
|Choose system     |@sysName                       |
|click             |id=Details        |            |
|click             |id=bt_Clear       |            |
|waitForTextPresent|*The results from the clearing*|
|click             |id=bt_Del         |            |
|getConfirmation                                   |
|waitForTextPresent|has been successfully deleted  |

!|scenario            |Choose system                          |sysName |
|clickOnLink          |link=Manage Systems                             |
|pause                |5000                                            |
|waitForElementPresent|id=SystemNm                                     |
|type;                |id=SystemNm                            |@sysName|
|click                |id=Listing                                      |
|waitForElementPresent|xpath=//td[contains(text(),'@sysName')]         |
|mouseMoveOver        |xpath=//td[contains(text(),'@sysName')]|        |
|click                |xpath=//td[contains(text(),'@sysName')]|        |

#!|scenario    |Create Account on System                                                                                                     |
#|accountAction|${SystemPlatform};;create;;${SystemIPAddress};;${FuncAcct};;${FuncAcctPassword};;${ManagedAccount};;${ManagedAccountPassword}|

#!|scenario    |Change Account Password on System                                   |NewPwd                                  |
#|accountAction|${SystemPlatform};;password;;${SystemIPAddress};;${FuncAcct};;${FuncAcctPassword};;${ManagedAccount};;@NewPwd|

#!|scenario    |Login Account to System                     |ManPwd                     |
#|accountAction|${SystemPlatform};;login;;${SystemIPAddress};;${ManagedAccount};;@ManPwd|

#!|scenario    |Delete Account on System                                                                          |
#|accountAction|${SystemPlatform};;delete;;${SystemIPAddress};;${FuncAcct};;${FuncAcctPassword};;${ManagedAccount}|





!|scenario            |Hard-Delete System                        |systemName |
|clickOnLink          |link=Deleted Systems                                  |
|type;                |id=SystemNm                               |@systemName|
|click                |id=Listing                                |           |
|waitForElementPresent|xpath=//td[contains(text(),'@systemName')]|           |
|mouseMoveOver        |xpath=//td[contains(text(),'@systemName')]|           |
|click                |xpath=//td[contains(text(),'@systemName')]|           |
|click                |id=HardDeleteButton                       |           |
|getConfirmation                                                             |
|waitForTextPresent   |has been successfully deleted                         |



!| scenario        |Request Pwd                                |
|Login             |${TPAMURL}       ||${Requestor}||${UserPwd}|
|pause             |5000                                       |
|clickOnLink       |link=Add Password Request                  |
|type;             |id=SystemNm      |${SystemName}            |
|type;             |id=AccountNm     |${ManagedAccount}        |
|click             |id=Accounts      |                         |
|click             |xpath=//input[@type='checkbox']            |
|click             |id=Details                                 |
|type;             |id=RequestReason |password request reason  |
|select;           |id=DurationQtrHrs|label=15                 |
|select;           |id=DurationHrs   |label=0                  |
|pause             |1000                                       |
|click             |id=SubmitChanges                           |
|waitForTextPresent|*RequestID:*has been submitted.*           |
|Logout                                                        |



!| scenario             |Get Login                                                                                                              |
|Login                  |${TPAMURL}                     |                |${Requestor}                |               |${UserPwd}               |
|pause                  |10000                                                                                                                  |
|click                  |id=CurrentRequests             |                                                                                       |
|waitForElementPresent  |xpath=//td[contains(text(),'${SystemName}')]/../td/a[contains(text(),'${ManagedAccount}')]                             |
|click                  |xpath=//td[contains(text(),'${SystemName}')]/../td/a[contains(text(),'${ManagedAccount}')]                             |
|waitForElementPresent  |xpath=//table[@id='MainListingTable']//td[contains(text(),'${SystemName}')]/../td[contains(text(),'${ManagedAccount}')]|
|mouseMoveOver          |xpath=//table[@id='MainListingTable']//td[contains(text(),'${SystemName}')]/../td[contains(text(),'${ManagedAccount}')]|
|click                  |xpath=//table[@id='MainListingTable']//td[contains(text(),'${SystemName}')]/../td[contains(text(),'${ManagedAccount}')]|
|click                  |id=Password                                                                                                            |
|pause                  |5000                                                                                                                   |
|waitForElementPresent  |xpath=//div[@class='displayPassword']                                                                                  |
|$passwordstr=          |getText                        |xpath=//div[@class='displayPassword']                                                  |
|$GeneratedPwd=         |get_password                   |$passwordstr                                                                           |
|Login Account to System|$GeneratedPwd                                                                                                          |
|pause                  |20000                                                                                                                  |
|click                  |id=Details                                                                                                             |
|pause                  |1000                                                                                                                   |
|type;                  |id=ResponseComment             |cancel                                                                                 |
|pause                  |1000                                                                                                                   |
|click                  |id=SubmitChanges                                                                                                       |
|pause                  |3000                                                                                                                   |
|waitForTextPresent     |*submitted successfully                                                                                                |
|Logout                                                                                                                                         |


!| scenario       |Add Java System                                                                                                                                                                                                        |
|$res=            |JavaAPI|${API_user_1};${API_user_1};${TPAMHost};addSystemWinAD;${SystemName};${SystemAddress};Custom Platform/${CustomPlatformName};${FuncAcct};${FuncAcctPassword};${SystemTimeout};${DomainName};${NetBIOSDomainName}|
|Verify_Contain_OR|$res;;successfully                                                                                                                                                                                                     |

!| scenario       |Remove Java System|sysName                                                      |
|$res=            |JavaAPI           |${API_user_1};${API_user_1};${TPAMHost};deleteSystem;@sysName|
|Verify_Contain_OR|$res;;uccess                                                                    |

!| scenario       |Add Perl System                                                                                                                                                                                                 |
|$res=            |PerlAPI|${APIBatch} addSystemCustomLDAP ${SystemName} ${SystemAddress} "Custom Platform/${CustomPlatformName}" ${FuncAcct} ${FuncAcctPassword} ${DomainName} ${NetBIOSDomainName} ${FuncAcctDN} ${SystemTimeout}|
|Verify_Contain_OR|$res;;successful                                                                                                                                                                                                |


!| scenario       |Remove Perl System|sysName                          |
|$res=            |PerlAPI           |${APIBatch} deleteSystem @sysName|
|Verify_Contain_OR|$res;;successful                                    |

!| scenario       |Add NET System                                                                                                                                                                                                                  |
|$res=            |NetAPI|${APIBatch} ${CommandTimeout} AddSystem ${SystemName} ${SystemAddress} "Custom Platform/${CustomPlatformName}" "${SystemDescription}" ${SystemTimeout} ${FuncAcct} ${FuncAcctPassword} ${NetBIOSDomainName} ${DomainName}|
|Verify_Contain_OR|$res;;successful                                                                                                                                                                                                                |


!| scenario       |Remove NET System|sysName                                            |
|$res=            |NetAPI           |${APIBatch} ${CommandTimeout} DeleteSystem @sysName|
|Verify_Contain_OR|$res;;successful                                                     |



!| scenario        |Check API Calls                        |
|Login             |${TPAMURL}||${TPAMAdmin}||${DefaultPwd}|
|Add Perl System                                           |
|Remove Perl System|${SystemName}                          |
|Hard-Delete System|${SystemName}                          |
|Add NET System                                            |
|Remove NET System |${SystemName}                          |
|Hard-Delete System|${SystemName}                          |
|Add Java System                                           |
|Remove Java System|${SystemName}                          |
|Hard-Delete System|${SystemName}                          |
|Logout                                                    |

!|scenario            |Set Affinity                                                              |
|Login                |${TPAMURL}                                   ||${TPAMAdmin}||${DefaultPwd}|
|pause                |20000                                                                     |
|Choose system        |${SystemName}                                                             |
|click                |id=Affinity                                                               |
|waitForElementPresent|id=rbPARAffinitySelected                                                  |
|click                |id=rbPARAffinitySelected                                                  |
|type;                |xpath=//table[@id='tblPARDPAAffinity']//input|1                           |
|click                |id=bt_Save                                                                |
|waitForTextPresent   |System changes for * saved successfully                                   |
|pause                |10000                                                                     |
|Check Affinity                                                                                  |


!|scenario            |Check Affinity                                         |
|pause                |10000                                                  |
|Choose system        |${SystemName}                                          |
|click                |id=Affinity                                            |
|waitForElementPresent|id=rbPARAffinitySelected                               |
|$res=                |isChecked|id=rbPARAffinitySelected                     |
|Verify_Contain_OR    |$res;;true                                             |
|$res=                |getValue |xpath=//table[@id='tblPARDPAAffinity']//input|
|Verify_Contain_OR    |$res;;1                                                |


!|scenario         |Enable PSM on Custom Platform                                                        |
|Deactivate Platform Automation                                                                          |
|Login             |${TPAMURL}         |          |${TPAMAdmin}         |         |${DefaultPwd}         |
|pause             |10000                                                                                |
|clickOnLink       |link=Custom Platforms                                                                |
|click             |id=Listing                                                                           |
|click             |xpath=//td[contains(text(),'${CustomPlatformName}')]                                 |
|pause             |1000                                                                                 |
|click             |id=Details                                                                           |
|pause             |1000                                                                                 |
|click             |id=PSMEnabledFl                                                                      |
|pause             |2000                                                                                 |
|click             |xpath=//select[@id='ProxyTypes']/option[.='SSH - Automatic Login Using Password']    |
|click             |xpath=//select[@id='ProxyTypes']/option[.='SSH - Interactive Login']                 |
|click             |xpath=//select[@id='ProxyTypes']/option[.='x3270 - Interactive Login Using Password']|
|click             |xpath=//select[@id='TransferTypes']/option[.='Secure Copy (SCP)']                    |
|pause             |1000                                                                                 |
|click             |id=btnSavePlatform                                                                   |
|getConfirmation                                                                                         |
|waitForTextPresent|saved successfully                                                                   |
|pause             |1000                                                                                 |
|click             |id=AutomationActiveFl                                                                |
|pause             |1000                                                                                 |
|click             |id=btnSavePlatform                                                                   |
|waitForTextPresent|saved successfully                                                                   |
|$res=             |getText            |xpath=//div[@id='ResultsDiv']                                    |
|Verify_Contain_OR |$res;;saved successfully                                                             |
|pause             |60000                                                                                |
|Check Proxy Types Available                                                                             |
|Check File Transfer Types Available                                                                     |
|Logout                                                                                                  |

#|addSelection;     |id=ProxyTypes        |label=SSH - Automatic Login Using Password                     |
#|click             |xpath=//select[@id='ProxyTypes']/option[.='SSH - Automatic Login Using Password']    |
#|addSelection;     |id=ProxyTypes        |label=SSH - Interactive Login                                  |
#|click             |xpath=//select[@id='ProxyTypes']/option[.='SSH - Interactive Login']                 |
#|addSelection;     |id=ProxyTypes        |label=x3270 - Interactive Login Using Password                 |
#|click             |xpath=//select[@id='ProxyTypes']/option[.='x3270 - Interactive Login Using Password']|
#|addSelection;     |id=TransferTypes     |label=Secure Copy (SCP)                                        |
#|click             |xpath=//select[@id='TransferTypes']/option[.='Secure Copy (SCP)']                    |


!| scenario       |Enable PSM for Account                                                                                                                                                                                                                                                                                                                                   |
|$res=            |CLI|${CLIBatch} UpdateEGPAccount --System ${SystemName} --Account ${ManagedAccount}  --ProxyType \"SSH - Automatic Login Using Password\" --DefaultSessionDuration 120 --EnableFlag Y  --MinApprovers 0 --RecordingRequiredFlag N --FileTransUpFlag Y --FileTransDownFlag Y --FileTransType SCP --FileTransAuthMethod Same --FileTransPath ${ShareFolder}|
|Verify_Contain_OR|$res;;successful                                                                                                                                                                                                                                                                                                                                         |


!| scenario               |Request and Open Session                                                                                      |
|Login                    |${TPAMURL}           |                |${Requestor}                |                |${UserPwd}               |
|pause                    |20000                                                                                                         |
|clickOnLink              |link=Add Session Request                                                                                      |
|type;                    |id=SystemNm          |${SystemName}                                                                           |
|type;                    |id=AccountNm         |${ManagedAccount}                                                                       |
|click                    |id=Accounts          |                                                                                        |
|click                    |xpath=//input[@type='checkbox']                                                                               |
|click                    |id=Details                                                                                                    |
|type;                    |id=RequestReason     |session request reason                                                                  |
|pause                    |1000                                                                                                          |
|click                    |id=SubmitChanges                                                                                              |
|waitForTextPresent       |submitted                                                                                                     |
|$res=                    |getText              |xpath=//div[@id='ResultsDiv']                                                           |
|Verify_Contain_OR        |$res;;submitted                                                                                               |
|$SessionRequestID=       |get_session_RequestID|$res                                                                                    |
|waitForElementPresent    |id=StartSessionButton                                                                                         |
|click                    |id=StartSessionButton                                                                                         |
|pause                    |20000                                                                                                         |
|selectWindow             |Quest Software PSM Session (${SystemName}/${ManagedAccount}/$SessionRequestID)                                |
|SWaitMultipleV2          |60;Accept2.png;Accept3.png;Accept.png                                                                         |
|SClickMultiple           |Accept2.png;Accept3.png;Accept.png                                                                            |
|pause                    |50000                                                                                                         |
|Prepare Files                                                                                                                           |
|click                    |id=FileTransfer                                                                                               |
|pause                    |10000                                                                                                         |
|type;                    |id=FQFN              |${FileToDownload}                                                                       |
|pause                    |2000                                                                                                          |
|click                    |id=downloadButton                                                                                             |
|waitForTextPresent       |Your file download has completed successfully                                                                 |
|pause                    |20000                                                                                                         |
|Check Downloaded File    |${BrowserDownloadDir}|                |${FileToDownload}                                                      |
|SWait                    |select_file.png                                                                                               |
|SClick                   |select_file.png                                                                                               |
|pause                    |2000                                                                                                          |
|SType                    |${ProjDir}\${FileToUpload}                                                                                    |
|pause                    |2000                                                                                                          |
|keytype                  |\n                                                                                                            |
|pause                    |10000                                                                                                         |
|SWait                    |upload.png                                                                                                    |
|SClick                   |upload.png                                                                                                    |
|pause                    |5000                                                                                                          |
|waitForTextPresent       |Your file transfer has completed successfully                                                                 |
|pause                    |5000                                                                                                          |
|Check file on system     |${FileToUpload}                                                                                               |
|pause                    |30000                                                                                                         |
|Delete File on Dispatcher|${ProjDir}\          |                |${FileToUpload}                                                        |
|stop                                                                                                                                    |
|$res=                    |RunBatchGetOutput    |CheckAccountLogin.bat;${SystemAddress};${FuncAcct};${FuncAcctPassword};${ManagedAccount}|
|Verify_Contain_OR        |$res;;1;;2                                                                                                    |
|selectWindow             |Quest Software TPAM                                                                                           |
|stop                                                                                                                                    |




!|scenario            |Cancel Session                                  |
|Login                |${TPAMURL}         | |${Requestor} | |${UserPwd}|
|pause                |10000                                           |
|click                |id=CurrentRequests                              |
|waitForElementPresent|link=Sess(${ManagedAccount})                    |
|clickOnLink          |link=Sess(${ManagedAccount})                    |
|waitForElementPresent|xpath=//td[contains(text(),'${ManagedAccount}')]|
|mouseMoveOver        |xpath=//td[contains(text(),'${ManagedAccount}')]|
|click                |xpath=//td[contains(text(),'${ManagedAccount}')]|
|click                |id=Details                                      |
|waitForElementPresent|id=ResponseComment                              |
|type;                |id=ResponseComment |cancel                      |
|click                |id=SubmitChanges                                |
|pause                |10000                                           |
|Logout                                                                |
#|waitForTextPresent   |*The response * was submitted successfully* |

!|scenario     |Create Users                                       |
|Login         |${TPAMURL}       ||${TPAMAdmin} ||${DefaultPwd}    |
|pause         |10000                                              |
|Add User      |${Requestor}     ||${DefaultPwd}||${RequestorEMail}|
|Add User      |${Approver}      ||${DefaultPwd}||${ApproverEMail} |
|Logout                                                            |
|Create Mailbox|${RequestorEMail}||${RequestorEMailPwd}            |
|Create Mailbox|${ApproverEMail} ||${ApproverEMailPwd}             |
|Change Pwd    |${Requestor}     ||${DefaultPwd}||${UserPwd}       |
|Change Pwd    |${Approver}      ||${DefaultPwd}||${UserPwd}       |


!| scenario       |Change PSM Proxy Type|proxyType                              |                              |result                              |
|$res=            |CLI                  |${CLIBatch} UpdatePSMAccount --System ${SystemName} --Account ${ManagedAccount}  --ProxyType \"@proxyType\"|
|Verify_Contain_OR|$res;;@result                                                                                                                    |


!| scenario       |Change File Transfer Type|transferType                                |                               |result                               |
|$res=            |CLI                      |${CLIBatch} UpdatePSMAccount --System ${SystemName} --Account ${ManagedAccount}  --FileTransType \"@transferType\"|
|Verify_Contain_OR|$res;;@result                                                                                                                               |

!| scenario           |Check Proxy Types Available                                             |
|Change PSM Proxy Type|SSH - Automatic Login Using DSS Key     ||Invalid Proxy Type            |
|Change PSM Proxy Type|SSH - Automatic Login Using Password    ||PSM Details saved successfully|
|Change PSM Proxy Type|x3270 - Interactive Login Using Password||PSM Details saved successfully|
|Change PSM Proxy Type|x5250 - Interactive Login               ||Invalid Proxy Type            |
|Change PSM Proxy Type|SSH - Interactive Login                 ||PSM Details saved successfully|


!| scenario               |Check File Transfer Types Available                      |
|Change File Transfer Type|SCP||PSM Details saved successfully                      |
|Change File Transfer Type|WFC||File Transfer Type not allowed for System's platform|

############################################### File Transfer Staff #################################


!| scenario|Check Transfer File|
|Prepare Files                 |
|click     |id=FileTransfer    |
|pause     |10000              |
|Check Download                |
|Check Upload                  |

!|scenario                |Prepare Files                           |
|Create File on System                                             |
|Create file for uploading|${FileToUpload}|in directory|${ProjDir}\|

!|scenario            |Check Download                               |
|type;                |id=FQFN                |${FileToDownload}    |
|pause                |2000                                         |
|click                |id=downloadButton                            |
|waitForTextPresent   |Your file download has completed successfully|
|pause                |20000                                        |
|Check Downloaded File|${BrowserDownloadDir}  |  |${FileToDownload} |
#|waitForTextPresent   |Your file download has completed successfully|


!|scenario|Select File To Upload|fileToUpload|
|SWait    |select_file.png                   |
|SClick   |select_file.png                   |
|pause    |2000                              |
|SType    |${ProjDir}\@fileToUpload          |
|pause    |2000                              |
|keytype  |\n                                |
|pause    |10000                             |


!|scenario                |Check Upload                                 |
|Select File To Upload    |${FileToUpload}                              |
|SWait                    |upload.png                                   |
|SClick                   |upload.png                                   |
|pause                    |5000                                         |
|waitForTextPresent       |Your file transfer has completed successfully|
|pause                    |5000                                         |
|Check file on system     |${FileToUpload}                              |
|pause                    |30000                                        |
|Delete File on Dispatcher|${ProjDir}\      |      |${FileToUpload}     |


!|scenario        |Set Password Approvers Number|accountName                             |                             |approversNumber                             |
|$res=            |CLI                          |${CLIBatch} UpdateAccount --SystemName ${SystemName} --AccountName @accountName --MinimumApprovers @approversNumber|
|Verify_Contain_OR|$res;;successful                                                                                                                                 |



!|scenario        |Create File on System                                                                                     |
|RunBatchGetOutput|FileTransferLinux;create;${SystemAddress};${FuncAcct};${FuncAcctPassword};${ShareFolder};${FileToDownload}|

!|scenario        |Delete files on System                                                                                    |
|RunBatchGetOutput|FileTransferLinux;delete;${SystemAddress};${FuncAcct};${FuncAcctPassword};${ShareFolder};${FileToDownload}|

!|scenario        |Check file on system|fileToCheck                                                                                         |
|$res=            |RunBatchGetOutput   |FileTransferLinux;check;${SystemAddress};${FuncAcct};${FuncAcctPassword};${ShareFolder};@fileToCheck|
|Verify_Contain_OR|$res;;FileExists                                                                                                         |

!| scenario|Check Downloaded File|filePath||fileName|
|runBatch  |CheckAndDeleteFile;@filePath;@fileName  |

!|scenario|Create file for uploading|fileName|in directory|filePath|
|runBatch |CreateFile2;@filePath;@fileName                         |


!|scenario|Delete File on Dispatcher|filepath||filename|
|runBatch |DeleteFile2;@filepath;@filename             |

!| scenario       |Prepare Scripts      |path    |    |changeFrom   |   |changeTo   |
|$res=            |RunBatchGetOutputFull|PrepareEthalons;@path;@changeFrom;@changeTo|
|Verify_Contain_OR|$res;;write.*changes                                             |


!|scenario         |Create Password Rule|ruleName                    |
|Login             |${TPAMAdminURL}     ||${TPAMMaster}||${MasterPwd}|
|pause             |10000                                            |
|clickOnLink       |link=Password Rules                              |
|click             |id=NewRuleButton                                 |
|type;             |id=PwdRuleName      |@ruleName                   |
|type;             |id=PwdRuleDesc      |Rule for Mainframe passwords|
|type;             |id=MaxChars         |8                           |
|type;             |id=MinChars         |7                           |
|click             |id=ReqFirst                                      |
|select;           |id=ReqFirst         |label=Alpha Characters Only |
|click             |id=ReqUpper                                      |
|select;           |id=ReqUpper         |label=Require at least 2    |
|click             |id=ReqLower                                      |
|select;           |id=ReqLower         |label=Require at least 2    |
|click             |id=ReqNum                                        |
|select;           |id=ReqNum           |label=Require at least 1    |
|click             |id=ReqNonAN                                      |
|select;           |id=ReqNonAN         |label=Not Permitted         |
|click             |id=SubmitChangesButton                           |
|waitForTextPresent|Password Rule changes saved successfully         |
|Logout                                                              |


!|scenario        |Delete Password Rule|ruleName                                |
|$res=            |GroovyWebDriver     |DeletePasswordRule;${TPAMHost};@ruleName|
|Verify_Contain_OR|$res;;Rule deleted                                           |


!|scenario         |Check Host Key is Not Present in Known Hosts|hostAddress                   |
|Login             |${TPAMAdminURL}                             | |${TPAMMaster} ||${MasterPwd}|
|pause             |10000                                                                      |
|clickOnLink       |link=Manage Host Keys                                                      |
|pause             |10000                                                                      |
|$res=             |getText                                     |xpath=//table[@id='keysTable']|
|Verify_Contain_NOT|$res;;@hostAddress                                                         |
|Logout                                                                                        |



