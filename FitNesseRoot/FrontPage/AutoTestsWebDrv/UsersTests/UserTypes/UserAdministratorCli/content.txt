!*> Includes
!include -c <AutomatedTesting.UsersTests.ScenarioLibrary
!include -c <AutomatedTesting.UsersTests.UserTypes.ScenarioLibrary
*!

!*> Prepare
!|script                                                                                                                                                                         |
|Open                 |${TPAMURL}          ||${TPAMAdmin}                                                                                                         ||${DefaultPwd}|
|Add CLI User         |${UserAdministrator}||User Administrator                                                                                                                  |
|Add CLI User         |${UserName}3        ||Basic                                                                                                                               |
|Add System           |${CLIBatch}         ||--SystemName ${SystemName2} --PlatformName ${PlatformName} --NetworkAddress ${NetworkAddress}                        ||successfully |
|Add Account          |${CLIBatch}         ||--SystemName ${SystemName2} --AccountName ${AccountName}2                                                            ||successfully |
|Add Group            |${CLIBatch}         ||--GroupName ${GroupName}2                                                                                            ||successfully |
|Add Collection       |${CLIBatch}         ||--CollectionName ${CollectionName}                                                                                   ||successfully |
|Add Collection member|${CLIBatch}         ||--CollectionName ${CollectionName} --SystemName ${SystemName2}                                                       ||successfully |
|Add User             |${CLIBatch}         ||--UserName ${UserName}2 --LastName test --FirstName test                                                             ||successfully |
|Update PSM Account   |${CLIBatch}         ||--System ${SystemName2} --Account ${AccountName}2 --EnableFlag Y --ProxyType \"RDP - Automatic Login Using Password\"||successfully |
|Add Grp member       |${CLIBatch}         ||--GroupName ${GroupName}2 --UserName ${UserName}2                                                                    ||successfully |


*!

!|script                                                                                                                                                                                                                                                                            |
|Add System                    |${CLIUserAdministrator}||--SystemName ${SystemName} --PlatformName ${PlatformName} --NetworkAddress ${NetworkAddress}                       ||You do not have a valid UserID to perform this operation.                                             |
|Add Account                   |${CLIUserAdministrator}||--SystemName ${SystemName2} --AccountName ${AccountName}                                                           ||${UserAdministrator} is not authorized.                                                               |
|Add User                      |${CLIUserAdministrator}||--UserName ${UserName} --FirstName Kaizer --LastName Sozo                                                          ||User added successfully                                                                               |
|Add Group                     |${CLIUserAdministrator}||--GroupName ${GroupName}                                                                                           ||${UserAdministrator} is not authorized to save groups.                                                |
|Add Grp member                |${CLIUserAdministrator}||--GroupName ${GroupName}2 --UserName ${UserAdministrator}                                                          ||${UserAdministrator} is not authorized to update group membership.                                    |
|Add Collection                |${CLIUserAdministrator}||--CollectionName ${CollectionName}2                                                                                ||${UserAdministrator} is not authorized save collections.                                              |
|Add Collection member         |${CLIUserAdministrator}||--CollectionName ${CollectionName} --SystemName  ${SystemName2}                                                    ||${UserAdministrator} is not authorized to add collection members                                      |
|Add Collection member         |${CLIUserAdministrator}||--CollectionName ${CollectionName} --SystemName  ${SystemName2} --AccountName  ${AccountName}2                     ||${UserAdministrator} is not authorized to add collection members                                      |
|Add PwdRequest                |${CLIUserAdministrator}||--SystemName ${SystemName2} --AccountName ${AccountName}2                                                          ||${UserAdministrator} is not authorized to add requests                                                |
|Add SyncPass                  |${CLIUserAdministrator}||--SyncPassName ${SyncPassName}                                                                                     ||${UserAdministrator} is not authorized.                                                               |
|List Systems                  |${CLIUserAdministrator}||--SystemName ${SystemName2}                                                                                        ||${UserAdministrator} is not authorized to list systems                                                |
|List Accounts                 |${CLIUserAdministrator}||--SystemName ${SystemName2} --AccountName ${AccountName}2                                                          ||${UserAdministrator} is not authorized to list accounts                                               |
|List Users                    |${CLIUserAdministrator}||--UserName ${UserName}2                                                                                            ||${UserName}                                                                                           |
|List Groups                   |${CLIUserAdministrator}||--GroupName ${GroupName}2                                                                                          ||${UserAdministrator} is not authorized to list Groups.                                                |
|List Group Membership         |${CLIUserAdministrator}||--GroupName ${GroupName}2                                                                                          ||${UserAdministrator} is not authorized to group membership.                                           |
|List Accts For Pwd Request    |${CLIUserAdministrator}||                                                                                                                   ||${UserAdministrator} is not authorized to list accounts for request                                   |
|List Dependent Systems        |${CLIUserAdministrator}||--System Fake --Account Fake                                                                                       ||${UserAdministrator} is not currently authorized                                                      |
|List Synchronized Passwords   |${CLIUserAdministrator}||                                                                                                                   ||${UserAdministrator} is not authorized.                                                               |
|List Reason Codes             |${CLIUserAdministrator}||                                                                                                                   ||${UserAdministrator} is not authorized to list reason codes                                           |
|Delete Account                |${CLIUserAdministrator}||--SystemName ${SystemName2} --AccountName ${AccountName}2                                                          ||You are not authorized to perform this operation                                                      |
|Drop Collection               |${CLIUserAdministrator}||--CollectionName ${CollectionName}                                                                                 ||${UserAdministrator} is not authorized save collections.                                              |
|Drop Collection Member        |${CLIUserAdministrator}||--CollectionName ${CollectionName} --SystemName ${SystemName2}                                                     ||You do not have the necessary permissions to modify Collection assignments for System: ${SystemName2}.|
|Drop Group                    |${CLIUserAdministrator}||--GroupName ${GroupName}2                                                                                          ||${UserAdministrator} is not authorized to save groups.                                                |
|Drop Group Member             |${CLIUserAdministrator}||--GroupName ${GroupName}2 --UserName ${UserName}                                                                   ||${UserAdministrator} is not authorized to update group membership.                                    |
|Update Account                |${CLIUserAdministrator}||--SystemName ${SystemName2} --AccountName ${AccountName}2 --Description test                                       ||${UserAdministrator} is not authorized                                                                |
|Update System                 |${CLIUserAdministrator}||--SystemName ${SystemName2} --Description test                                                                     ||You do not have a valid UserID to perform this operation.                                             |
|Update Dependent Systems      |${CLIUserAdministrator}||--System Fake --Account Fake --Assign test                                                                         ||${UserAdministrator} is not currently authorized                                                      |
|Update SyncPass               |${CLIUserAdministrator}||--SyncPassName ${SyncPassName}                                                                                     ||${UserAdministrator} is not authorized.                                                               |
|Change User Password          |${CLIUserAdministrator}||--UserName ${UserName}2 --Password Password1                                                                       ||successfully                                                                                          |
|Force Reset                   |${CLIUserAdministrator}||--SystemName ${SystemName2} --AccountName ${AccountName}2                                                          ||You are not authorized to perform this operation                                                      |
|Set Access Policy             |${CLIUserAdministrator}||--SystemName ${SystemName2} --AccountName ${AccountName}2 --Action ADD --AccessPolicyNam ISA --UserNam ${UserName}2||You are not a valid user                                                                              |
|Sync Pass Force Reset         |${CLIUserAdministrator}||--SyncPassName ${SyncPassName}                                                                                     ||${UserAdministrator} is not authorized.                                                               |
|Test System                   |${CLIUserAdministrator}||--SystemName ${SystemName2}                                                                                        ||You are not authorized to perform this operation                                                      |
|Unlock User                   |${CLIUserAdministrator}||--UserName ${UserName}2                                                                                            ||${UserName}2 is not currently locked                                                                  |
|Report Activity               |${CLIUserAdministrator}||--UserName ${UserAdministrator}                                                                                    ||${UserAdministrator}                                                                                  |
|Retrieve                      |${CLIUserAdministrator}||--SystemName ${SystemName2} --AccountName ${AccountName}2                                                          ||You are not authorized to perform this operation                                                      |
|Add Session Request           |${CLIUserAdministrator}||--SystemName ${SystemName2} --AccountName ${AccountName}2                                                          ||${UserAdministrator} is not authorized to add requests                                                |
|List Accts For Session Request|${CLIUserAdministrator}||                                                                                                                   ||${UserAdministrator} is not authorized to list accounts for request                                   |
|List PSM Accounts             |${CLIUserAdministrator}||--SystemName ${SystemName2} --AccountName ${AccountName}2                                                          ||${UserAdministrator} is not authorized to list accounts                                               |
|Update PSM Account            |${CLIUserAdministrator}||--System ${SystemName2} --Account ${AccountName}2 --SessionStartNotifyEmail mail@mail.mail                         ||You are not authorized to perform this operation                                                      |
|List Collections              |${CLIUserAdministrator}||                                                                                                                   ||${UserAdministrator} is not authorized to list Collections                                            |
|Delete System                 |${CLIUserAdministrator}||--SystemName ${SystemName2}                                                                                        ||${UserAdministrator} is not authorized to delete systems.                                             |
|Check Password                |${CLIUserAdministrator}||--SystemName ${SystemName2} --AccountName ${AccountName}2                                                          ||You are not authorized to perform this operation                                                      |
|Update User                   |${CLIUserAdministrator}||--UserName ${UserName}2 --Description test --Disable Y                                                             ||successfully                                                                                          |
|Update User                   |${CLIUserAdministrator}||--UserName ${UserName}2 --Description test --Disable N                                                             ||successfully                                                                                          |
|Delete User                   |${CLIUserAdministrator}||--UserName ${UserName}2                                                                                            ||${UserName}2 has been successfully deleted                                                            |
|Update User                   |${CLIUserAdministrator}||--UserName ${UserAdministrator} --Description test                                                                 ||User Admins can only add and modify basic users                                                       |
|Update User                   |${CLIUserAdministrator}||--UserName ${UserName}3 --Description test                                                                         ||User Admins can not modify non-web users                                                              |
|List Collection Membership    |${CLIUserAdministrator}||--CollectionName ${CollectionName}                                                                                 ||${UserAdministrator} is not authorized to list Collection membership                                  |
|List Collection Membership    |${CLIUserAdministrator}||                                                                                                                   ||${UserAdministrator} is not authorized to list Collection membership                                  |




  	
 		

# temporarily bisabled.
#|List Collections          |${CLIUserAdministrator}||                                                                                              ||is not authorized                                                                                                               |
#|List Collection Membership|${CLIUserAdministrator}||                                                                                              ||is not authorized                                                                                                               |
#|Delete System              |${CLIUserAdministrator}||--SystemName ${SystemName2}                                                                   ||You are not authorized to perform this operation.                                                                               |
#|Check PAssword        |
#|List Assigned policies|

!*> Clenup
!|script                                                                      |
|Delete System  |${CLIBatch}||--SystemName ${SystemName2}       ||successfully|
|Drop Group     |${CLIBatch}||--GroupName ${GroupName}2         ||successfully|
|Drop Collection|${CLIBatch}||--CollectionName ${CollectionName}||successfully|
|Remove user    |${UserAdministrator}                                         |
|Remove Keys    |${UserAdministrator}*                                        |
|Delete User    |${CLIBatch}||--UserName ${UserName}            ||successfully|
|Remove user    |${UserName}3                                                 |
|Remove Keys    |${UserName}3 *                                               |



*!