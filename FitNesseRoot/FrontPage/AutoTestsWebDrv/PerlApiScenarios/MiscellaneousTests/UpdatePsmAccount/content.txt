!define SystemName {${prefix}PerlSystem1}
!define AccountName {${prefix}PerlAccount1}
!define PerlUserName {${prefix}PerlUser1}
!define PerlGroupName {${prefix}PerlGroup1}



!|script                                                                                                              |
|Add System |${PerlAPIparams}||--SystemName=${SystemName};--PlatformName=Windows;--NetworkAddress=x.x.x.x||successfull|
|Add Account|${PerlAPIparams}||--SystemName=${SystemName};--AccountName=${AccountName}                   ||successfull|

enableflag

!|script                                                                                                                                                                                                                    |
|Update PSM Account|${PerlAPIparams}||--System=${SystemName};--Account=${AccountName};--enableflag=Y;--proxytype=RDP - Automatic Login Using Password||successfull                                                          |
|List PSM Accounts |${PerlAPIparams}||--SystemName=${SystemName};--AccountName=${AccountName}                                                        ||systemName: ${SystemName}.*accountName: ${AccountName}.*enableFlag: Y|

!|script                                                                                                                                                                   |
|Update PSM Account|${PerlAPIparams}||--System=${SystemName};--Account=${AccountName};--enableflag=N||successfull                                                          |
|List PSM Accounts |${PerlAPIparams}||--SystemName=${SystemName};--AccountName=${AccountName}       ||systemName: ${SystemName}.*accountName: ${AccountName}.*enableFlag: N|

!|script                                                                                                                            |
|Update PSM Account|${PerlAPIparams}||--System=${SystemName};--Account=${AccountName};--enableflag=A||EnableFl must be either N or Y|

!|script                                                                                                                                                                                                                    |
|Update PSM Account|${PerlAPIparams}||--System=${SystemName};--Account=${AccountName};--enableflag=Y;--proxytype=RDP - Automatic Login Using Password||successfull                                                          |
|List PSM Accounts |${PerlAPIparams}||--SystemName=${SystemName};--AccountName=${AccountName}                                                        ||systemName: ${SystemName}.*accountName: ${AccountName}.*enableFlag: Y|



minapprovers

!|script                                                                                                                                                                                        |
|Update PSM Account|${PerlAPIparams}||--System=${SystemName};--Account=${AccountName};--enableflag=Y;--minapprovers=10||successfull                                                             |
|List PSM Accounts |${PerlAPIparams}||--SystemName=${SystemName};--AccountName=${AccountName}                         ||systemName: ${SystemName}.*accountName: ${AccountName}.*minApprovers: 10|

!|script                                                                                                                                                                       |
|Update PSM Account|${PerlAPIparams}||--System=${SystemName};--Account=${AccountName};--minapprovers=0||successfull                                                            |
|List PSM Accounts |${PerlAPIparams}||--SystemName=${SystemName};--AccountName=${AccountName}         ||systemName: ${SystemName}.*accountName: ${AccountName}.*minApprovers: 0|

proxytype

!|script                                                                                                                                                                                                             |
|Update PSM Account|${PerlAPIparams}||--System=${SystemName};--Account=${AccountName};--proxytype=RDP - Interactive Login||successfull                                                                               |
|List PSM Accounts |${PerlAPIparams}||--SystemName=${SystemName};--AccountName=${AccountName}                            ||systemName: ${SystemName}.*accountName: ${AccountName}.*proxyType: RDP - Interactive Login|

!|script                                                                                                                                                                                                                                      |
|Update PSM Account|${PerlAPIparams}||--System=${SystemName};--Account=${AccountName};--proxytype=RDP - Automatic Login Using Password||successfull                                                                                           |
|List PSM Accounts |${PerlAPIparams}||--SystemName=${SystemName};--AccountName=${AccountName}                                         ||systemName: ${SystemName}.*accountName: ${AccountName}.*roxyType: RDP - Automatic Login Using Password|

defaultsessionduration

!|script                                                                                                                                                                                            |
|Update PSM Account|${PerlAPIparams}||--System=${SystemName};--Account=${AccountName};--defaultsessionduration=1||successfull                                                                       |
|List PSM Accounts |${PerlAPIparams}||--SystemName=${SystemName};--AccountName=${AccountName}                   ||systemName: ${SystemName}.*accountName: ${AccountName}.*defaultSessionDuration: 15|

!|script                                                                                                                                                                                                   |
|Update PSM Account|${PerlAPIparams}||--System=${SystemName};--Account=${AccountName};--defaultsessionduration=10080||successfull                                                                          |
|List PSM Accounts |${PerlAPIparams}||--SystemName=${SystemName};--AccountName=${AccountName}                       ||systemName: ${SystemName}.*accountName: ${AccountName}.*defaultSessionDuration: 10080|

!|script                                                                                                                                                                   |
|Update PSM Account|${PerlAPIparams}||--System=${SystemName};--Account=${AccountName};--defaultsessionduration=10081||Default Session Duration must be between 15 and 10080|

maxsessioncount

!|script                                                                                                                                                                               |
|Update PSM Account|${PerlAPIparams}||--System=${SystemName};--Account=${AccountName};--maxsessioncount=11||successfull                                                                |
|List PSM Accounts |${PerlAPIparams}||--SystemName=${SystemName};--AccountName=${AccountName}             ||systemName: ${SystemName}.*accountName: ${AccountName}.*maxSessionCount: 11|

!|script                                                                                                                                       |
|Update PSM Account|${PerlAPIparams}||--System=${SystemName};--Account=${AccountName};--maxsessioncount=0||MaxSessionCnt must be greater than 0|

notifythreshold, notifyfrequency

!|script                                                                                                                                                                                                                          |
|Update PSM Account|${PerlAPIparams}||--System=${SystemName};--Account=${AccountName};--notifythreshold=11;--notifyfrequency=11||successfull                                                                                      |
|List PSM Accounts |${PerlAPIparams}||--SystemName=${SystemName};--AccountName=${AccountName}                                  ||systemName: ${SystemName}.*accountName: ${AccountName}.* notifyThreshold: 11.*notifyFrequency: 11|

colordepth

!|script                                                                                                                                                                   |
|Update PSM Account|${PerlAPIparams}||--System=${SystemName};--Account=${AccountName};--colordepth=8||successfull                                                          |
|List PSM Accounts |${PerlAPIparams}||--SystemName=${SystemName};--AccountName=${AccountName}       ||systemName: ${SystemName}.*accountName: ${AccountName}.*colorDepth: 8|

!|script                                                                                                                                                                     |
|Update PSM Account|${PerlAPIparams}||--System=${SystemName};--Account=${AccountName};--colordepth=16||successfull                                                           |
|List PSM Accounts |${PerlAPIparams}||--SystemName=${SystemName};--AccountName=${AccountName}        ||systemName: ${SystemName}.*accountName: ${AccountName}.*colorDepth: 16|

!|script                                                                                                                                          |
|Update PSM Account|${PerlAPIparams}||--System=${SystemName};--Account=${AccountName};--colordepth=32||Color Depth can only be 0, 1, 2, 3, 8 or 16|

filetranstype, filetranspath, filetransauthmethod

!|script                                                                                                                                                                                                                                                                                                                 |
|Update PSM Account|${PerlAPIparams}||--System=${SystemName};--Account=${AccountName};--filetranstype=WFC;--filetranspath=filetranspath;--filetransauthmethod=Prompt||successfull                                                                                                                                        |
|List PSM Accounts |${PerlAPIparams}||--SystemName=${SystemName};--AccountName=${AccountName}                                                                       ||systemName: ${SystemName}.*accountName: ${AccountName}.*fileTransPath: filetranspath.*fileTransType: Windows File Copy.*fileTransAuthMethod: Prompt|

!|script                                                                                                                                                                                                                                                         |
|Update PSM Account|${PerlAPIparams}||--System=${SystemName};--Account=${AccountName};filetransauthmethod=Same||successfull                                                                                                                                      |
|List PSM Accounts |${PerlAPIparams}||--SystemName=${SystemName};--AccountName=${AccountName}                 ||systemName: ${SystemName}.*accountName: ${AccountName}.*fileTransPath: filetranspath.*fileTransType: Windows File Copy.*fileTransAuthMethod: Same|

!|script                                                                                                                                                                                                |
|Update PSM Account|${PerlAPIparams}||--System=${SystemName};--Account=${AccountName};--filetranstype=DIS||successfull                                                                                  |
|List PSM Accounts |${PerlAPIparams}||--SystemName=${SystemName};--AccountName=${AccountName}            ||systemName: ${SystemName}.*accountName: ${AccountName}.*fileTransType: File Transfer Disabled|


reviewCount, reviewerType, reviewerName, escalationTime, escalationEmail

!|script                                                                                                                                          |
|NewAddUser       |${PerlAPIparams}||--UserName=${PerlUserName};--FirstName=fname;--LastName=lname                                   ||successfull|
|Add Group        |${PerlAPIparams}||--GroupName=${PerlGroupName}                                                                    ||successfull|
|Set Access Policy|${PerlAPIparams}||--UserName=${PerlUserName};--Action=add;--accessPolicyName=PSM Reviewer;--System=${SystemName}  ||successfull|
|Set Access Policy|${PerlAPIparams}||--GroupName=${PerlGroupName};--Action=add;--accessPolicyName=PSM Reviewer;--System=${SystemName}||successfull|


!|script                                                                                                                                                                                                                                                                                            |
|Update PSM Account|${PerlAPIparams}||--System=${SystemName};--Account=${AccountName};--reviewCount=1;--reviewerType=Any;--escalationTime=123;--escalationEmail=escalationEmail||successfull                                                                                                        |
|List PSM Accounts |${PerlAPIparams}||--SystemName=${SystemName};--AccountName=${AccountName}                                                                                  ||systemName: ${SystemName}.*reviewCount: 1.*reviewerType: Any.*escalationEmail: escalationEmail.*escalationTime: 123|

!|script                                                                                                                                                                                      |
|Update PSM Account|${PerlAPIparams}||--System=${SystemName};--Account=${AccountName};--reviewCount=1;--reviewerType=Auditor||successfull                                                     |
|List PSM Accounts |${PerlAPIparams}||--SystemName=${SystemName};--AccountName=${AccountName}                               ||systemName: ${SystemName}.*reviewCount: 1.*reviewerType: Auditor|

!|script                                                                                                                                                                                                                                              |
|Update PSM Account|${PerlAPIparams}||--System=${SystemName};--Account=${AccountName};--reviewCount=1;--reviewerType=User;--reviewerName=${PerlUserName}||successfull                                                                                 |
|List PSM Accounts |${PerlAPIparams}||--SystemName=${SystemName};--AccountName=${AccountName}                                                           ||systemName: ${SystemName}.*reviewCount: 1.*reviewerType: User.*reviewerName: ${PerlUserName}|

!|script                                                                                                                                                                                                                                                  |
|Update PSM Account|${PerlAPIparams}||--System=${SystemName};--Account=${AccountName};--reviewCount=1;--reviewerType=Group;--reviewerName=${PerlGroupName}||successfull                                                                                   |
|List PSM Accounts |${PerlAPIparams}||--SystemName=${SystemName};--AccountName=${AccountName}                                                             ||systemName: ${SystemName}.*reviewCount: 1.*reviewerType: Group.*reviewerName: ${PerlGroupName}|

!|script                                                                                                          |
|Update PSM Account|${PerlAPIparams}||--System=${SystemName};--Account=${AccountName};--reviewCount=0||successfull|

!|script                                                                  |
|NewDeleteUser|${PerlAPIparams}||--UserName=${PerlUserName}  ||successfull|
|Delete Group |${PerlAPIparams}||--GroupName=${PerlGroupName}||successfull|

sessionstartnotifyemail, clipboardflag, consoleflag, recordingRequiredFlag, filetransupflag, filetransdownflag

!|script                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|Update PSM Account|${PerlAPIparams}||--System=${SystemName};--Account=${AccountName};--filetranstype=WFC;--filetranspath=filetranspath;--filetransauthmethod=Prompt;--sessionstartnotifyemail=mail;--clipboardflag=Y;--consoleflag=Y;--recordingRequiredFlag=Y;--filetransupflag=Y;--filetransdownflag=Y||successfull                                                                                                                                                                                |
|List PSM Accounts |${PerlAPIparams}||--SystemName=${SystemName};--AccountName=${AccountName}                                                                                                                                                                                                            ||systemName: ${SystemName}.*accountName: ${AccountName}.*sessionStartNotifyEmail: mail.*clipboardFlag: Y.*consoleFlag: Y.*recordingRequiredFlag: Y.*fileTransUpFlag: Y.*fileTransDownFlag: Y|

!|script                                                                                                                                                                                                                                                                                                                                                                                                               |
|Update PSM Account|${PerlAPIparams}||--System=${SystemName};--Account=${AccountName};--sessionstartnotifyemail=mail;--clipboardflag=N;--consoleflag=N;--recordingRequiredFlag=N;--filetransupflag=N;--filetransdownflag=N||successfull                                                                                                                                                                                |
|List PSM Accounts |${PerlAPIparams}||--SystemName=${SystemName};--AccountName=${AccountName}                                                                                                                             ||systemName: ${SystemName}.*accountName: ${AccountName}.*sessionStartNotifyEmail: mail.*clipboardFlag: N.*consoleFlag: N.*recordingRequiredFlag: N.*fileTransUpFlag: N.*fileTransDownFlag: N|

connectionprofile, postsessionprofile

!|script                                                                                                                                                                                                                                                                                                                                                             |
|Update PSM Account|${PerlAPIparams}||--System=${SystemName};--Account=${AccountName};--connectionprofile=${PersistentConnectionProfile};--postsessionprofile=${PersistentPostSessionProfileName}||successfull                                                                                                                                                       |
|List PSM Accounts |${PerlAPIparams}||--SystemName=${SystemName};--AccountName=${AccountName}                                                                                                    ||systemName: ${SystemName}.*accountName: ${AccountName}.*connectionProfile: ${PersistentConnectionProfile}.*postSessionProfile: ${PersistentPostSessionProfileName}|


passwordmethod, domainAccountName, dsskeytype


!|script                                                                                                                                                                                                                                                                                                                                                                    |
|Add System        |${PerlAPIparams}||--SystemName=${SystemName}AD;--PlatformName=Windows Active Dir;--NetworkAddress=x.x.x.x;--DomainName=test;--netBIOSName=test                                                                 ||successfull                                                                                                                            |
|Add Account       |${PerlAPIparams}||--SystemName=${SystemName}AD;--AccountName=${AccountName};--AutoFlag=M                                                                                                                       ||successfull                                                                                                                            |
|Update PSM Account|${PerlAPIparams}||--System=${SystemName}AD;--Account=${AccountName};--enableflag=Y;--proxytype=RDP - Automatic Login Using Password;--passwordmethod=Windows Domain Account;--domainAccount=test\${AccountName}||successfull                                                                                                                            |
|List PSM Accounts |${PerlAPIparams}||--SystemName=${SystemName}AD;--AccountName=${AccountName}                                                                                                                                    ||systemName: ${SystemName}.*accountName: ${AccountName}.*passwordMethod: Windows Domain Account.*domainAccountName: test.*${AccountName}|
|Update PSM Account|${PerlAPIparams}||--System=${SystemName}AD;--Account=${AccountName};--passwordmethod=Local TPAM                                                                                                                ||successfull                                                                                                                            |
|Delete System     |${PerlAPIparams}||--SystemName=${SystemName}AD                                                                                                                                                                 ||successfull                                                                                                                            |

!|script                                                                                                                                                                                                                                                                                                                                                                                              |
|Update PSM Account|${PerlAPIparams}||--System=${SystemName};--Account=${AccountName};--connectionprofile=Standard;--postsessionprofile=Standard;--proxytype=SSH - Automatic Login Using DSS Key;--passwordmethod=DSS Key;--dsskeytype=Specific||successfull                                                                                                                                          |
|List PSM Accounts |${PerlAPIparams}||--SystemName=${SystemName};--AccountName=${AccountName}                                                                                                                                                  ||systemName: ${SystemName}.*accountName: ${AccountName}.*passwordMethod: DSS Key.*proxyType: SSH - Automatic Login Using DSS Key.*dssKeyType: Specific|


!|script                                                                |
|Delete System|${PerlAPIparams}||--SystemName=${SystemName}||successfull|
