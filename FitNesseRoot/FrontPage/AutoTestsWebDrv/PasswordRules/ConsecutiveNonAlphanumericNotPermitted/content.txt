!*> Test description
Generated password hasn't to consecutive repeated nonalphanumeric symbols.
Passwords for managed accounts and synchronized passwords are checked.
Not matched password can't be set to sync password.
If password matches the rule it will be set successfully. 
*!

!define validHardSymbols {!-+_`!@#^()={}|:;<,>.-!}
!define checkRegexp {!-.*[-!${validHardSymbols}!-]{2,}.*-!}

!include -c <AutoTestsWebDrv.ScenarioLibrary
!include -c <AutoTestsWebDrv.CliScenarios.ScenarioLibrary
!include -c <AutoTestsWebDrv.SynchronizedPasswords.ScenarioLibrary
!include -c ScenarioLibrary

!3 Set the password rule settings.
!|script                                                                                    |
|Login                              |${TPAMAdminURL}   |        |${TPAMMaster}||${MasterPwd}|
|Let Off                                                                                    |
|Set                                |MaxChars          |equal to|10                         |
|Set                                |MinChars          |equal to|6                          |
|Select value                       |Require at least 2|for     |ReqNonAN                   |
|Set Valid Non Alpha Numeric Symbols|${validHardSymbols}                                    |
|Select value                       |Not Permitted     |for     |ConsecutiveNonAlphanumeric |
|click                              |id=SubmitChangesButton                                 |

!3 Test the Rule
!|script                                                                                                                               |
|Test password generator                    |${checkRegexp}     |should present    |N                                                  |
|Generated account password does not contain|${checkRegexp}                                                                            |
|Check that Synchronized Password           |${SyncPasswordName}|with Password Rule|${PasswdRuleName}||does not contain||${checkRegexp}|
