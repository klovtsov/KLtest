!|scenario    |Create Another Account on System                                 |newAccount                                 |
|accountAction|${SystemPlatform};;create;;${SystemAddress};;${FunctAcct};;${FunctAcctPwd};;@newAccount;;${ManagedAccountPwd}|

!|scenario  |Create Password Rule|pwdRuleName |
|clickOnLink|link=Password Rules              |
|click      |id=NewRuleButton                 |
|type;      |id=PwdRuleName      |@pwdRuleName|
|type;      |id=PwdRuleDesc      |Test rule   |
|click      |id=SubmitChangesButton           |

!|scenario  |Select Password Rule        |pwdRuleName               |
|clickOnLink|link=Password Rules                                    |
|select;    |id=PasswordRuleID           |label=@pwdRuleName        |
|click      |xpath=//select/option[contains(text(), "@pwdRuleName")]|

!|scenario           |Delete Password Rule|pwdRuleName|
|Select Password Rule|@pwdRuleName                    |
|click               |id=DeleteRuleButton             |
|getConfirmation                                      |

!|scenario|Set        |setting|equal to|value|
|type;    |id=@setting|@value                |

!|scenario|Select value|value|for|setting|
|select;  |id=@setting |label=@value     |

!|scenario|Set Valid Non Alpha Numeric Symbols|validSymbols |
|type;    |id=ValidNonAN                      |@validSymbols|

!|scenario|Set Invalid Symbols    |invalidSymbols |
|type;    |id=DisallowedCharacters|@invalidSymbols|

!|scenario     |Generated account password does not contain|pattern                                 |
|Reset Password|${ManagedAccount}                          |             |${ResetPasswordSuccessful}|
|Get Generated Password                                                                             |
|check not     |echo                                       |$GeneratedPwd|=~/@pattern/              |

!|scenario|Generated sync password does not contain|pattern               |
|Get Generated Sync Password                                              |
|check not|echo                                    |$GeneratedPwd|@pattern|

!|scenario     |Generated account password contains|pattern                                 |
|Reset Password|${ManagedAccount}                  |             |${ResetPasswordSuccessful}|
|Get Generated Password                                                                     |
|check         |echo                               |$GeneratedPwd|=~/@pattern/              |

!|scenario|Generated sync password contains|pattern               |
|Get Generated Sync Password                                      |
|check    |echo                            |$GeneratedPwd|@pattern|

!|scenario        |Set requests auto-approved for|account                                          |                                          |
|$res=            |CLI                           |${CLIBatch} UpdateAccount --System ${SystemName} --AccountName @account --MinimumApprovers 0|
|Verify_Contain_OR|$res;;successful                                                                                                           |

!|scenario        |Set ISA Permissions|username                                       |on                                       |account                                       |
|$res=            |CLI                |${CLIBatch} SetAccessPolicy --AccessPolicyName "ISA" --Action ADD --SystemName ${SystemName} --AccountName @account --UserName @username|
|Verify_Contain_OR|$res;;successful                                                                                                                                            |

!|scenario     |Get Generated Password                                                              |
|$GeneratedPwd=|CLI|${CLIBatch} Retrieve --SystemName ${SystemName}  --AccountName ${ManagedAccount}|

!|scenario     |Get Generated Sync Password                                 |
|Request Pwd of|${SecManAccount}|from             |${SystemName}            |
|$GeneratedPwd=|CLI             |${CLIBatch} Retrieve --RequestID $RequestID|
#|pause                  |${ApplyNewPoliciesInterval}                                 |

!|scenario        |Cancel request                                                   |
|$res=            |CLI|${CLIBatch} Cancel --RequestID $RequestID --Comment EndOfTest|
|Verify_Contain_OR|$res;;submitted successfully                                     |

!|scenario        |Assign Password Rule|passwdRuleName                         |to account                        |account                        |
|$res=            |CLI                 |${CLIBatch} UpdateAccount --SystemName ${SystemName} --AccountName @account --PasswordRule @passwdRuleName|
|Verify_Contain_OR|$res;;successful                                                                                                               |

!|scenario        |Set password|newpwd                       |for account                       |accnt                      |
|$res=            |CLI         |${CLIBatch} UpdateAccount --SystemName ${SystemName} --AccountName @accnt --Password @newpwd|
|Verify_Contain_OR|$res;;successful                                                                                         |

!|scenario        |Assign Password Rule|passwdRuleName              |to Sync password              |pwdName              |
|$res=            |CLI                 |${CLIBatch} UpdateSyncPass --SyncPassName @pwdName --PasswordRule @passwdRuleName|
|Verify_Contain_OR|$res;;successful                                                                                      |

!|scenario           |Let Off                                              |
|Select Password Rule|${PasswdRuleName}                                    |
|Set                 |MinChars               |equal to|7                   |
|Set                 |MaxChars               |equal to|10                  |
|Select value        |Require at least 1     |for     |ReqUpper            |
|Select value        |Require at least 1     |for     |ReqLower            |
|Select value        |Require at least 1     |for     |ReqNum              |
|Select value        |Any Character Permitted|for     |ReqFirst            |
|Select value        |Any Character Permitted|for     |ReqLast             |
|Select value        |Permitted              |for     |CRepeat             |
|Select value        |Permitted              |for     |NonconsecutiveRepeat|
|Select value        |Not Permitted          |for     |ReqNonAN            |
|Select value        |Permitted, No limit    |for     |ConsecutiveUpper    |
|Select value        |Permitted, No limit    |for     |ConsecutiveLower    |
|Select value        |Permitted, No limit    |for     |ConsecutiveNumeric  |
|Select value        |Permitted, No limit    |for     |ConsecutiveAlpha    |
|type;               |id=DisallowedCharacters|                             |

!|scenario        |Set new Sync Password value|pwdValue                      |                      |result                      |
|$res=            |CLI                        |${CLIBatch} UpdateSyncPass --SyncPassName ${SyncPasswordName} --Password @pwdValue|
|Verify_Contain_OR|$res;;@result                                                                                                 |

!|scenario        |Try to set|password                   |with result                  |result                  |
|$res=            |CLI       |${CLIBatch} UpdateSyncPass --SyncPassName ${SyncPasswordName} --Password @password|
|Verify_Contain_OR|$res;;@result                                                                                |

!|scenario        |Drop subscriber|subscriber                             |from                             |SyncPwdName                             |
|$res=            |CLI            |${CLIBatch} DropSyncPwdSub --SyncPassName ${SyncPasswordName} --SystemName ${SystemName} --AccountName @subscriber|
|Verify_Contain_OR|$res;;successfully                                                                                                                |

!|scenario         |Hard-Delete System                        |systemName                  |
|Open              |${TPAMURL}                                ||${TPAMAdmin}||${DefaultPwd}|
|clickOnLink       |link=Deleted Systems                                                   |
|type;             |id=SystemNm                               |@systemName                 |
|click             |id=Listing                                |                            |
|click             |xpath=//td[contains(text(),'@systemName')]|                            |
|click             |id=HardDeleteButton                       |                            |
|getConfirmation                                                                           |
|waitForTextPresent|has been successfully deleted                                          |
|Logout Paradmin                                                                           |

!|scenario    |Delete Account on System                          |account                          |
|accountAction|${SystemPlatform};;delete;;${SystemAddress};;${FunctAcct};;${FunctAcctPwd};;@account|

!|scenario        |Add Sync Password|pwdName        |with value        |initValue        |Password Rule        |pwdRuleName        |change profile        |changeProfileName        |check profile        |checkprofile       |
|$res=            |CLI              |${CLIBatch} AddSyncPass --SyncPassName @pwdName --Password \"@initValue\" --PasswordRule \"@pwdRuleName\" --PasswordChangeProfile @changeProfileName --PasswordCheckProfile @checkprofile|
|Verify_Contain_OR|$res;;successful                                                                                                                                                                                           |

!|scenario        |Add account|accnt                            |without password                            |testRes                           |
|$res=            |CLI        |${CLIBatch} AddAccount --System ${SystemName} --AccountName @accnt --Description \"${ManagedAccountDescription}\"|
|Verify_Contain_OR|$res;;@testRes                                                                                                               |

!|scenario        |Add manual account|accntname                |with password               |pwd               |password rule               |rulename               |result               |testRes               |
|$res=            |CLI               |${CLIBatch} AddAccount --System ${SystemName} --AccountName @accntname --AutoFlag M --Password @pwd --PasswordRule @rulename --Description \"${ManagedAccountDescription}\"|
|Verify_Contain_OR|$res;;@testRes                                                                                                                                                                                |

!|scenario                             |Check that Synchronized Password|SyncPasswordName|with Password Rule    |PasswdRuleName|               |shouldcontain |                       |regexp                              |
|Add Sync Password                     |@SyncPasswordName               |with value      |${SincPwdInitialValue}|Password Rule |@PasswdRuleName|change profile|${syncPwdChangeProfile}|check profile|${syncPwdCheckProfile}|
|Reset Sync Password                                                                                                                                                                                                       |
|Add Subscriber                        |${SecManAccount}                |from            |${SystemName}                                                                                                                    |
|Generated sync password @shouldcontain|=~/@regexp/                                                                                                                                                                        |
|Cancel request                                                                                                                                                                                                            |
|Drop subscriber                       |${SecManAccount}                |from            |@SyncPasswordName                                                                                                                |
|Delete Sync Password                  |@SyncPasswordName                                                                                                                                                                  |

!|scenario        |Set User Permissions on|account                       |from                       |system                       |for                      |userName                      |
|$res=            |CLI                    |${CLIBatch} SetAccessPolicy --AccessPolicyName "Approver-Requestor" --Action ADD --SystemName @system --AccountName @account --UserName @userName|
|Verify_Contain_OR|$res;;successful                                                                                                                                                         |

!| scenario       |Request Pwd of|account                        |from                       |system                       |
|$res=            |CLI           |${CLIBatch} AddPwdRequest --SystemName @system --AccountName @account --RequestNotes test|
|Verify_Contain_OR|$res;;submitted                                                                                         |
|$RequestID=      |get_RequestID |$res                                                                                     |

!|scenario         |Test password generator 2|regexp                     |should present                    |presentflag                    |
|$res=             |GroovyWebDriver          |testPasswordRule;${TPAMHost};${TPAMMaster};${MasterPwd};${PasswdRuleName};@presentflag;@regexp|
|Verify_Contain_NOT|$res;;Failed                                                                                                            |
|Verify_Contain_NOT|$res;;Something went wrong                                                                                              |
|Verify_Contain_OR |$res;;Success                                                                                                           |

!|scenario         |Test password generator|regexp                  |should present                  |presentflag                 |
|runBatch          |WriteRegexpTofile;"@regexp";${ProjDir}\PasswordRuleTestExpression.txt                                         |
|$res=             |GroovyWebDriver        |testPasswordRule;${TPAMHost};${TPAMMaster};${MasterPwd};${PasswdRuleName};@presentflag|
|Verify_Contain_NOT|$res;;Failed                                                                                                  |
|Verify_Contain_NOT|$res;;Something went wrong                                                                                    |
|Verify_Contain_OR |$res;;Success                                                                                                 |
|runBatch          |DeleteFileByMask;${ProjDir}\PasswordRuleTestExpression.txt;fake                                               |


!|scenario         |Check Password reuse global|result                                                                             |
|$res=             |GroovyWebDriver            |checkPasswordReuseStatus;${TPAMHost};${TPAMMaster};${MasterPwd};${PasswdRuleName};y|
|Verify_Contain_NOT|$res;;Something went wrong                                                                                     |
|Verify_Contain_OR |$res;;Global Password reuse is @result                                                                         |

!|scenario         |Check Password reuse account|result                                                                             |
|$res=             |GroovyWebDriver             |checkPasswordReuseStatus;${TPAMHost};${TPAMMaster};${MasterPwd};${PasswdRuleName};n|
|Verify_Contain_NOT|$res;;Something went wrong                                                                                      |
|Verify_Contain_OR |$res;;Account Password reuse is @result                                                                         |

!|scenario     |Set password bu GUI    |accountName||accPwd|
|Choose Account|@accountName                               |
|click         |id=Details             |                   |
|type;         |id=AccountName         |@accountName       |
|type;         |id=sPswd               |@accPwd            |
|type;         |id=sConfPswd           |@accPwd            |
|click         |id=SubmitChangesButton |                   |
|waitForResult |Changes saved successfully for @accountName|
