!|scenario         |Duplicate      |object           |           |objName           |to           |newName          |
|$res =            |GroovyWebDriver|createDuplicate;${TPAMHost};${TPAMAdmin};${DefaultPwd};@object;@objName;@newName|
|Verify_Contain_NOT|$res;;something went wrong                                                                      |
|Verify_Contain_OR |$res;;Script finished                                                                           |

#It's better to specify a duplicated user password
!|scenario         |Duplicate User |initUser                        |to                        |newUser                        |
|$res =            |GroovyWebDriver|createUserDuplicate;${TPAMHost};${TPAMAdmin};${DefaultPwd};@initUser;@newUser;${newUserPwd}|
|Verify_Contain_NOT|$res;;something went wrong                                                                                 |
|Verify_Contain_OR |$res;;User added successfully                                                                              |

!|scenario         |Delete Policy  |pname                                                           |
|$res =            |GroovyWebDriver|deleteAccessPolicy;${TPAMHost};${TPAMAdmin};${DefaultPwd};@pname|
|Verify_Contain_NOT|$res;;something went wrong                                                      |
|Verify_Contain_OR |$res;;Script finished                                                           |

!|scenario         |Duplicate  File|fileName                                 |to                                 |newFileName                                 |
|$res =            |GroovyWebDriver|createFileDuplicate;${TPAMHost};${TPAMAdmin};${DefaultPwd};${SystemName};@fileName;@newFileName;${FilePath}${FileName}.txt|
|Verify_Contain_NOT|$res;;something went wrong                                                                                                                |
|Verify_Contain_OR |$res;;Script finished                                                                                                                     |

!|scenario            |Select File                 |fileName                 |
|clickOnLink          |link=Manage Files                                     |
|type;                |id=FileNm                   |@fileName                |
|click                |id=Listing                                            |
|waitForElementPresent|xpath=//table[@id='fileTable']//td[text()='@fileName']|
|click                |xpath=//table[@id='fileTable']//td[text()='@fileName']|

!|scenario    |Set number of approvals|numOfApprovals|on file|fileName|
|Select File  |@fileName                                              |
|click        |id=Details             |                               |
|pause        |500                                                    |
|type;        |id=MinApprovers        |@numOfApprovals                |
|pause        |500                                                    |
|click        |id=SubmitChanges       |                               |
|waitForResult|File updated successfully                              |

!|scenario    |Set Ticket System tab|ticktSystem|for file|fileName|
|Select File  |@fileName                                          |
|click        |id=TicketSystem      |                             |
|pause        |500                                                |
|click        |id=RequireTixForISA  |                             |
|select;      |id=TSID              |label=@ticktSystem           |
|pause        |500                                                |
|click        |id=SubmitChanges     |                             |
|waitForResult|File updated successfully                          |

!|scenario        |Check number of approvals  on file|fileName             |is             |numOfApprovals             |
|clickOnLink      |link=List Files                                                                                     |
|type;            |id=FileNm                         |@fileName                                                        |
|click            |id=Listing                        |                                                                 |
|$res=            |getText                           |xpath=//table[@id='fileListingReport']/*/tr[td='@fileName']/td[8]|
|Verify_Contain_OR|$res;;@numOfApprovals                                                                               |

!|scenario        |Check Ticket System tab for file|fileName           |
|$res =            |GroovyWebDriver                 |getTicketSystemSettingsForFile;${TPAMHost};${TPAMAdmin};${DefaultPwd};@fileName|
|Verify_Contain_NOT|$res;;something went wrong                                                                                      |
|Verify_Contain_OR |$res;;reqTicketForISA is true                                                                                   |
|Verify_Contain_OR |$res;;Ticket System Name is ${ticketSystem}                                                                     |
