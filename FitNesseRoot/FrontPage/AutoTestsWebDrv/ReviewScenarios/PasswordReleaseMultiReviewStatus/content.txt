!define escEmail {dedushka@derevnya.ru}
!include -c ScenarioLibrary

!* Prepare test
!|script                                                                                                                                                                |
|Create Account on System             |${ManagedAccount}|with password  |${ManagedAccountPassword}|on system    |${SystemAddress}                                       |
|Login                                |${TPAMURL}       |               |${TPAMAdmin}             |             |${DefaultPwd}                                          |
|Add System                           |${SystemName}    |               |${SystemAddress}         |             |${SystemPlatform}|         |${FunctAcct}||${FuncAccPwd}|
|Add Account                          |${ManagedAccount}|on system      |${SystemName}                                                                                  |
|Prepare User                         |${Requestor}     |with first name|${Requestor}             |and last name|Smith            |with type|Basic                      |
|Prepare User                         |${Approver}      |with first name|${Approver}              |and last name|Smith            |with type|Basic                      |
|Prepare User                         |${Reviewer1}     |with first name|${Reviewer1}             |and last name|Smith            |with type|Basic                      |
|Prepare User                         |${Reviewer2}     |with first name|${Reviewer2}             |and last name|Smith            |with type|Basic                      |
|Set User Permissions System Level    |${Reviewer1}     |               |Reviewer                                                                                       |
|Set User Permissions System Level    |${Reviewer2}     |               |Reviewer                                                                                       |
|Set User Permissions System Level    |${CLI_user_1}    |               |Approver-Requestor                                                                             |
|Set User Permissions System Level    |${Requestor}     |               |Requestor                                                                                      |
|Set User Permissions System Level    |${Approver}      |               |Approver                                                                                       |
|Logout                                                                                                                                                                 |
|Change PPM Reviewer Type             |${ManagedAccount}|on system      |${SystemName}            |to type      |Any                                                    |
|Change PPM Review Count              |${ManagedAccount}|on system      |${SystemName}            |review count |2                                                      |
|Change PPM Review Escalation settings|${ManagedAccount}|on system      |${SystemName}            |time         |1                |e-mail   |${escEmail}                |
*!

!|script                                                                                                      |
|Release Password                                                                                             |
|Check password review status of account|${ManagedAccount}|on system|${SystemName}|is|Pending|review started|N|
|Submit Comment                         |${Reviewer1}     |         |$RequestID                               |
|Check password review status of account|${ManagedAccount}|on system|${SystemName}|is|Pending|review started|Y|
|Complete Review                        |${Reviewer1}     |         |$RequestID                               |
|Check password review status of account|${ManagedAccount}|on system|${SystemName}|is|Pending|review started|Y|
|Complete Review                        |${Reviewer2}     |         |$RequestID                               |
|Check Password Review Status           |${Reviewer2}     |         |$RequestID   |  |Complete                |

!* Remove environment
!|script                                                         |
|Login                   |${TPAMURL}||${TPAMAdmin}||${DefaultPwd}|
|Remove System           |${SystemName}                          |
|Delete Account on System|${ManagedAccount}                      |
|Hard-Delete System      |${SystemName}                          |
|Remove User             |${Requestor}                           |
|Remove User             |${Approver}                            |
|Remove User             |${Reviewer1}                           |
|Remove User             |${Reviewer2}                           |
|Logout                                                          |
*!
