!| scenario       |Add AD System|CLIBatch | |options ||result|
|$res=            |CLI          |@CLIBatch AddSystem @options|
|Verify_Contain_OR|$res;;@result                             |


!|scenario               |Prepare Account    |AccountName|                                                                                                                                                                                                                               |SystemName|              |SystemAddress                               |
|Add AD System           |${CLIBatch}        |           |--SystemName ${SystemNameAD} --NetworkAddress ${SystemAddressAD} --PlatformName \"${SystemPlatformAD}\" --DomainName ${DomainName} --NetBiosName ${NETBIOS} --FunctionalAccount ${FunctAcctAD} --FuncAcctCred ${FunctAcctPwdAD}|          |successfully                                               |
|Add Account             |${CLIBatch}        |           |--SystemName ${SystemNameAD} --AccountName ${UserName} --AutoFlag N --MinimumApprovers 0 --Password ${UserPwd}                                                                                                                 |          |successfully                                               |
|Add Account             |${CLIBatch}        |           |--SystemName @SystemName --AccountName @AccountName --AutoFlag N --MinimumApprovers 0                                                                                                                                          |          |successfully                                               |
|Update PSM Account      |${CLIBatch}        |           |--System @SystemName --Account @AccountName --EnableFlag Y --MinApprovers 0 --PasswordMethod \"Windows Domain Account\" --ProxyType \"SSH - Automatic Login Using Password\"                                                   |          |successfully                                               |
|Create Account on System|${SystemPlatformAD}|           |${SystemAddressAD}                                                                                                                                                                                                             |          |${FunctAcctAD}||${FunctAcctPwdAD}||${UserName}||${UserPwd}||
|Enable Qas User                                                                                                                                                                                                                                                                                                                                                |
|Choose Account          |${ManagedAccount}                                                                                                                                                                                                                                                                                                                     |
|click                   |id=PSMDetails                                                                                                                                                                                                                                                                                                                         |
|click                   |id=SessionAuthentication                                                                                                                                                                                                                                                                                                              |
|click                   |id=PassMeth4                                                                                                                                                                                                                                                                                                                          |
|select;                 |id=EgpDAID         |label=${DomainName}\${UserName}                                                                                                                                                                                                                                                                                   |
|click                   |id=SubmitChangesButton                                                                                                                                                                                                                                                                                                                |
|waitForTextPresent      |successfully                                                                                                                                                                                                                                                                                                                          |

# --DomainAccount ${DomainName}\${AccountNameAD}

!|scenario               |Clear Objects                                                                          |
|Remove system           |${SystemName}                                                                          |
|Delete logon script                                                                                             |
|Delete Account on System|${SystemPlatformAD}||${SystemAddressAD}||${FunctAcctAD}||${FunctAcctPwdAD}||${UserName}|
|Remove User             |${Requestor}                                                                           |
|Login                   |${TPAMURL}         ||${TPAMAdmin}      ||${DefaultPwd}                                 |
|Hard-Delete System      |${SystemName}                                                                          |
|Remove system           |${SystemNameAD}                                                                        |

#|Delete Account on System|${ManagedAccount}  |on system|${SystemAddress}                                                  |

!|scenario         |Connect        |userName                   |                   |userPwd                   |                   |accountName                   |                   |requestID                   |
|$res=             |GroovyWebDriver|PSMSmokeTest;TPAMaddress=${TPAMHost};UserName=@userName;UserPassword=@userPwd;AccountName=@accountName;RequestID=@requestID;Browser=${Browser};OSType=${OSType};Image=${Image}|
|Verify_Contain_NOT|$res;;SClickMultiple failed                                                                                                                                                                   |
|Verify_Contain_OR |$res;;Finished                                                                                                                                                                                |

!|scenario        |Open Session Do Nothing|requestorName        |                  |systemName        |                    |accountName        |       |responceAction       |
|$res=            |CLI                    |${CLIBatch} AddSessionRequest --SystemName @systemName --AccountName @accountName --ForUserName @requestorName --RequestNotes test|
|Verify_Contain_OR|$res;;submitted                                                                                                                                           |
|$RequestID=      |get_session_RequestID  |$res                                                                                                                              |
|Connect          |@requestorName         |                     |${UserPwd}        |                  |@accountName        |                   |$RequestID                   |
|pause             |10000                                  |
|Connect          |@requestorName         |                     |${UserPwd}        |                  |@accountName        |                   |$RequestID                   |
