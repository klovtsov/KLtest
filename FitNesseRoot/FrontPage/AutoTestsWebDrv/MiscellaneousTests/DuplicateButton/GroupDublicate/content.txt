!********> Test Description
This test checks that Dublicate button for user is working.
Check that new user has same gropmembership and permissions.
**************!
!include -c <AutoTestsWebDrv.PlatformsTesting.MacOsxSix
!define psConnectOptions {-tpamAddress ${TPAMHost} -keyFile ${API_user_1} -apiUser ${API_user_1}}

!define testUser {${prefix}tstUser}
!define testGroup {${prefix}tstGroup}
!define newGroupName {${testGroup}2}
!define test_policy {"PPM Requestor"}
!define SystemDescription {tst}
!define groupDescription {${SystemDescription}}

!include -c <AutoTestsWebDrv.PowerShellNetApiScenarios.ScenarioLibrary
!include -c ScenarioLibrary

!* Create Envirinment
!|script                                                                      |
|Add system                                                                   |
|Add User       |${testUser}                                                  |
|Add Group      |${testGroup}                                                 |
|Add Member     |${testUser}   |to group |${testGroup}                        |
|Set Permissions|${test_policy}|on system|${SystemName}|for group|${testGroup}|
*!
!* Duplicate and check results
!|script                                                                                                                                   |
|Duplicate                       |group                                                |                   |${testGroup}|to|${newGroupName}|
|pause                           |${ApplyNewPoliciesInterval}                                                                              |
|List Groups Membership by filter|-groupName ${newGroupName}                           |and result contains|${newGroupName}.*${testUser}   |
|List Policies by filter         |-systemName  ${SystemName} -groupName ${newGroupName}|contains           |${newGroupName}.*Requestor.*   |
*!
!* Delete All
!|script                      |
|Delete System|${SystemName}  |
|Delete User  |${testUser}    |
|Delete Group |${testGroup}   |
|Delete Group |${newGroupName}|
*!