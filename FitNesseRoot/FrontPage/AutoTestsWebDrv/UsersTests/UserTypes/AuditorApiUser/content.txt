!*> Includes
!include -c <AutoTestsWebDrv.UsersTests.ScenarioLibrary
!include -c <AutoTestsWebDrv.UsersTests.UserTypes.ScenarioLibrary
*!


!*> Prepare
!|script                                                                                                                                                                      |
|Open                 |${TPAMURL}       ||${TPAMAdmin}                                                                                                         ||${DefaultPwd}|
|Add API User         |${AuditorApiUser}||Auditor                                                                                                                             |
|Add System           |${CLIBatch}      ||--SystemName ${SystemName2} --PlatformName ${PlatformName} --NetworkAddress ${NetworkAddress}                        ||successfully |
|Add Account          |${CLIBatch}      ||--SystemName ${SystemName2} --AccountName ${AccountName}2                                                            ||successfully |
|Add Group            |${CLIBatch}      ||--GroupName ${GroupName}2                                                                                            ||successfully |
|Add Collection       |${CLIBatch}      ||--CollectionName ${CollectionName}                                                                                   ||successfully |
|Add Collection member|${CLIBatch}      ||--CollectionName ${CollectionName} --SystemName ${SystemName2}                                                       ||successfully |
|Add User             |${CLIBatch}      ||--UserName ${UserName}2 --LastName test --FirstName test                                                             ||successfully |
|Update PSM Account   |${CLIBatch}      ||--System ${SystemName2} --Account ${AccountName}2 --EnableFlag Y --ProxyType \"RDP - Automatic Login Using Password\"||successfully |
|Add Grp member       |${CLIBatch}      ||--GroupName ${GroupName}2 --UserName ${UserName}2                                                                    ||successfully |


*!
!|script                                                                                                                                                                                                                                                                           |
|Add System via api                    |SystemName=${SystemName};PlatformName=${PlatformName};NetworkAddress=${NetworkAddress}                          ||${AuditorApiUser}||You do not have a valid UserID to perform this operation                                              |
|Add Account via api                   |SystemName=${SystemName2};AccountName=${AccountName}                                                            ||${AuditorApiUser}||${AuditorApiUser} is not authorized                                                                   |
|Add User via api                      |UserName=${UserName};FirstName=Keyser;LastName=Sozo                                                             ||${AuditorApiUser}||${AuditorApiUser} is not authorized to modify users.                                                  |
|Add Group via api                     |GroupName=${GroupName}                                                                                          ||${AuditorApiUser}||${AuditorApiUser} is not authorized to save groups.                                                   |
|Add Grp member via api                |GroupName=${GroupName}2;GroupMember=${BasicUserName}                                                            ||${AuditorApiUser}||is not authorized to update group membership                                                          |
|Add Collection via api                |CollectionName=${CollectionName}2                                                                               ||${AuditorApiUser}||${AuditorApiUser} is not authorized save collections.                                                 |
|Add Collection member via api         |CollectionName=${CollectionName};SystemName=${SystemName2}                                                      ||${AuditorApiUser}||${AuditorApiUser} is not authorized to add collection members                                         |
|Add Collection member via api         |CollectionName=${CollectionName};SystemName=${SystemName2};AccountName=${AccountName}2                          ||${AuditorApiUser}||${AuditorApiUser} is not authorized to add collection members                                         |
|Add PwdRequest via api                |SystemName=${SystemName2};AccountName=${AccountName}2;UserName=${AuditorApiUser}                                ||${AuditorApiUser}||${AuditorApiUser} is not authorized to add requests                                                   |
|Add SyncPass via api                  |SyncPassName=${SyncPassName};Password=Password1                                                                 ||${AuditorApiUser}||${AuditorApiUser} is not authorized.                                                                  |
|List Systems via api                  |SystemName=${SystemName2}                                                                                       ||${AuditorApiUser}||${SystemName2}                                                                                        |
|List Accounts via api                 |SystemName=${SystemName2};AccountName=${AccountName}2                                                           ||${AuditorApiUser}||${AccountName}2                                                                                       |
|List Users via api                    |UserName=${UserName}2                                                                                           ||${AuditorApiUser}||${UserName}2                                                                                          |
|List Groups via api                   |GroupName=${GroupName}2                                                                                         ||${AuditorApiUser}||${GroupName}2                                                                                         |
|List Group Membership via api         |GroupName=${GroupName}2                                                                                         ||${AuditorApiUser}||${UserName}2                                                                                          |
|List Dependent Systems via api        |SystemName=Fake;AccountName=Fake                                                                                ||${AuditorApiUser}||${AuditorApiUser} is not currently authorized                                                         |
|List Synchronized Passwords via api   |                                                                                                                ||${AuditorApiUser}||${AuditorApiUser} is not authorized.                                                                  |
|List Reason Codes via api             |                                                                                                                ||${AuditorApiUser}||${PersistentReasonCodeName}                                                                           |
|Delete Account via api                |SystemName=${SystemName2};AccountName=${AccountName}2                                                           ||${AuditorApiUser}||You are not authorized to perform this operation                                                      |
|Drop Collection via api               |CollectionName=${CollectionName}                                                                                ||${AuditorApiUser}||${AuditorApiUser} is not authorized save collections.                                                 |
|Drop Collection Member via api        |CollectionName=${CollectionName};CollectionMember=${SystemName2}                                                ||${AuditorApiUser}||You do not have the necessary permissions to modify Collection assignments for System: ${SystemName2}.|
|Drop Group via api                    |GroupName=${GroupName}2                                                                                         ||${AuditorApiUser}||${AuditorApiUser} is not authorized to save groups.                                                   |
|Drop Group Member via api             |GroupName=${GroupName}2;GroupMember=${UserName}                                                                 ||${AuditorApiUser}||is not authorized to update group membership                                                          |
|Delete User via api                   |UserName=${UserName}2                                                                                           ||${AuditorApiUser}||${AuditorApiUser} is not authorized                                                                   |
|Update Account via api                |SystemName=${SystemName2};AccountName=${AccountName}2;Description=test                                          ||${AuditorApiUser}||${AuditorApiUser} is not authorized                                                                   |
|Update System via api                 |SystemName=${SystemName2};Description=test                                                                      ||${AuditorApiUser}||You do not have a valid UserID to perform this operation                                              |
|Update Dependent Systems via api      |SystemName=Fake;ADAccountName=Fake;ADSystemName=Fake                                                            ||${AuditorApiUser}||${AuditorApiUser} is not currently authorized                                                         |
|Update SyncPass via api               |SyncPassName=${SyncPassName};Password=Password2                                                                 ||${AuditorApiUser}||${AuditorApiUser} is not authorized.                                                                  |
|Update User via api                   |UserName=${UserName}2;Description=test                                                                          ||${AuditorApiUser}||${AuditorApiUser} is not authorized to modify users.                                                  |
|Change User Password via api          |UserName=${UserName}2;Password=Password1                                                                        ||${AuditorApiUser}||is not authorized                                                                                     |
|Force Reset via api                   |SystemName=${SystemName2};AccountName=${AccountName}2                                                           ||${AuditorApiUser}||Failure                                                                                               |
|Set Access Policy via api             |SystemName=${SystemName2};AccountName=${AccountName}2;Action=ADD;AccessPolicyName=ISA;UserName=${AuditorApiUser}||${AuditorApiUser}||User Name is not valid                                                                                |
|Sync Pass Force Reset via api         |SyncPassName=${SyncPassName};SyncPass=SyncPass                                                                  ||${AuditorApiUser}||${AuditorApiUser} is not authorized.                                                                  |
|Test System via api                   |SystemName=${SystemName2}                                                                                       ||${AuditorApiUser}||You are not authorized to perform this operation                                                      |
|Unlock User via api                   |UserName=Fake                                                                                                   ||${AuditorApiUser}||${AuditorApiUser} is not authorized to unlock users.                                                  |
|Report Activity via api               |UserName=${AuditorApiUser}                                                                                      ||${AuditorApiUser}||${AuditorApiUser}                                                                                     |
|Retrieve via api                      |SystemName=${SystemName2};AccountName=${AccountName}2                                                           ||${AuditorApiUser}||You are not authorized to perform this operation                                                      |
|Add Session Request via api           |SystemName=${SystemName2};AccountName=${AccountName}2;UserName=${AuditorApiUser}                                ||${AuditorApiUser}||${AuditorApiUser} is not authorized to add requests                                                   |
|List Accts For Session Request via api|                                                                                                                ||${AuditorApiUser}||No Accounts to list                                                                                   |
|List PSM Accounts via api             |SystemName=${SystemName2};AccountName=${AccountName}2                                                           ||${AuditorApiUser}||${AccountName}2                                                                                       |
|Update PSM Account via api            |SystemName=${SystemName2};AccountName=${AccountName}2;SessionStartNotifyEmail=mail@mail.mail                    ||${AuditorApiUser}||You are not authorized to perform this operation                                                      |
|List Collections via api              |                                                                                                                ||${AuditorApiUser}||${CollectionName}                                                                                     |
|Delete System via api                 |SystemName=${SystemName2}                                                                                       ||${AuditorApiUser}||${AuditorApiUser} is not authorized to delete systems.                                                |
|Check Password via api                |SystemName=${SystemName2};AccountName=${AccountName}2                                                           ||${AuditorApiUser}||Failure                                                                                               |
|List Collection Membership via api    |CollectionName=${CollectionName}                                                                                ||${AuditorApiUser}||${CollectionName}.*${SystemName2}                                                                     |

#|List Collection Membership via api    |                                                                                                               ||${AuditorApiUser}||No Collection Memberships to list                                                                                               |
#|Set Access Policy             |${CLIBatch}                                                                                                   ||--SystemName ${SystemName2} --AccountName ${AccountName}2 --Action ADD --AccessPolicyNam Approver-Requestor --UserNam ${BasicUserName}||pprover-Requestor assigned to.*${BasicUserName}.*successfully                                                                   |
#|List Accts For Pwd Request    |                                                                                                              ||No Accounts to list                                                                                                                              |
 		



!*> Clenup
!|script                                                                      |
|Remove user    |${AuditorApiUser}                                            |
|Remove Keys    |${AuditorApiUser}*                                           |
|Delete System  |${CLIBatch}||--SystemName ${SystemName2}       ||successfully|
|Drop Group     |${CLIBatch}||--GroupName ${GroupName}2         ||successfully|
|Drop Collection|${CLIBatch}||--CollectionName ${CollectionName}||successfully|
|Delete User    |${CLIBatch}||--UserName ${UserName}2           ||successfully|

*!