!include -c <AutoTestsWebDrv.SetUp

''System''
!include -c <AutoTestsWebDrv.PlatformsTesting.WindowsLocalHost
''Libraries''
!include -c <AutoTestsWebDrv.ScenarioLibrary
!include -c <AutoTestsWebDrv.UsersTests.UserTypes.ScenarioLibrary
!include -c <PasswordProfiles.ScenarioLibrary


!|script                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|Open                                                   |${TPAMURL}                       ||${TPAMAdmin}                                                                                                                                                                                                                                                                                                        ||${DefaultPwd}                    |
|Create Password Check Profile                          |${CheckProfile1NismatchDonothing}||Do Nothing                                                                                                                                                                                                                                                                                                          ||Do Nothing                       |
|Create Password Check Profile                          |${CheckProfile2NismatchReset}    ||Reset password                                                                                                                                                                                                                                                                                                      ||Do Nothing                       |
|Create Password Check Profile                          |${CheckProfile3NismatchDisable}  ||Disable check schedule                                                                                                                                                                                                                                                                                              ||Do Nothing                       |
|Create Password Check Profile                          |${CheckProfile4NismatchLock}     ||Lock                                                                                                                                                                                                                                                                                                                ||Do Nothing                       |
|Create Password Check Profile                          |${CheckProfile5FailureDoNothing} ||Do Nothing                                                                                                                                                                                                                                                                                                          ||Do Nothing                       |
|Create Password Check Profile                          |${CheckProfile6FailureDisable}   ||Do Nothing                                                                                                                                                                                                                                                                                                          ||Disable check schedule           |
|Create Password Check Profile                          |${CheckProfile7FailureLock}      ||Do Nothing                                                                                                                                                                                                                                                                                                          ||Lock                             |
|Create Password Profile With No Schedule               |Check                            ||${NoSchedule}                                                                                                                                                                                                                                                                                                                                          |
|Create Password Profile With Daily Schedule            |Check                            ||${DailySchedule}                                                                                                                                                                                                                                                                                                    ||${DailyCounter1}||${DailyWindow1}|
|Create Password Profile With Weekly All Days Schedule  |Check                            ||${Weekly1Schedule}                                                                                                                                                                                                                                                                                                                                     |
|Create Password Profile With Weekly W0 Schedule        |Check                            ||${Weekly2Schedule}                                                                                                                                                                                                                                                                                                                                     |
|Create Password Profile With Weekly W3 Schedule        |Check                            ||${Weekly3Schedule}                                                                                                                                                                                                                                                                                                                                     |
|Create Password Profile With Weekly W345 Schedule      |Check                            ||${Weekly4Schedule}                                                                                                                                                                                                                                                                                                                                     |
|Create Password Profile With Every Schedule            |Check                            ||${EverySchedule}                                                                                                                                                                                                                                                                                                    ||${EveryDaysPeriod}               |
|Create Password Profile With Monthly First Day Schedule|Check                            ||${MonthlyFirstSchedule}                                                                                                                                                                                                                                                                                                                                |
|Create Password Profile With Monthly Last Day Schedule |Check                            ||${MonthlyLastSchedule}                                                                                                                                                                                                                                                                                                                                 |
|Create Password Profile With Monthly Schedule          |Check                            ||${MonthlyDaysOfSchedule}                                                                                                                                                                                                                                                                                            ||${MonthlyPeriod}                 |
|Create Mailbox                                         |${SystemEMail}                   ||${SystemEMailPwd}                                                                                                                                                                                                                                                                                                                                      |
|Add System                                             |${CLIBatch}                      ||--SystemName ${SystemName} --PlatformName ${SystemPlatform} --NetworkAddress ${SystemAddress} --FunctionalAccount ${FunctAcct} --FuncAcctCred \"${FunctAcctPwd}\"  --PrimaryEma ${SystemEMail} --PasswordCheckProfile ${PersistentPasswordCheckProfile1} --PasswordChangeProfile ${PersistentPasswordChangeProfile1}||successfully                     |
|Create Account on System                                                                                                                                                                                                                                                                                                                                                                                                                          |
|stop                                                                                                                                                                                                                                                                                                                                                                                                                                              |


