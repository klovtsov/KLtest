!*> Includes
''System''
!include -c <AutoTestsWebDrv.PlatformsTesting.WindowsLocalHost
''Libraries''
!include -c <AutoTestsWebDrv.UsersTests.UserTypes.ScenarioLibrary
!include -c <PasswordProfiles.ScenarioLibrary
*!

''Failure - Lock''
!note Scheduled Reset
!|script                                                                                                                                                                                                                                                                                                                            |
|Open                             |${TPAMURL}   ||${TPAMAdmin}                                                                                                                                                              ||${DefaultPwd}                                                                                         |
|Add Account                      |${CLIBatch}  ||--SystemName ${SystemName} --AccountName ${NotExist} --Password "WrongPWD" --PasswordChangeProfile ${ChangeProfile3FailureLock} --PasswordCheckProfile \"Check, No Reset\"||successfully                                                                                          |
|pause                            |100000                                                                                                                                                                                                                                                                                           |
|Check Change Log                 |${NotExist}  ||Scheduled Change Failed                                                                                                                                                                                                                                                           |
|Change Failure Mail              |${MailServer}||${SystemEMail}                                                                                                                                                            ||${SystemEMailPwd}||${FromMail}||${MailSubjectChangeFailure}||${MailBodyChangeFailure}||Scheduled Reset|
|Check Account Lock Status        |${NotExist}  ||true                                                                                                                                                                                                                                                                              |
|Change schedule disabled         |${NotExist}  ||false                                                                                                                                                                                                                                                                             |
|Management tab                   |${NotExist}                                                                                                                                                                                                                                                                                      |
|Change Failure Action            |${FailureLock}                                                                                                                                                                                                                                                                                   |
|Check Consecutive Change Failures|1                                                                                                                                                                                                                                                                                                |
|Update Account                   |${CLIBatch}  ||--SystemName ${SystemName} --AccountName ${NotExist} --LockFlag N                                                                                                         ||successfully                                                                                          |
|Check Account Lock Status        |${NotExist}  ||false                                                                                                                                                                                                                                                                             |
|Delete Mails                     |${SystemEMail}                                                                                                                                                                                                                                                                                   |

!note Forced Reset
!|script                                                                                                                                                                                                                                                |
|Force Reset                      |${CLIBatch}  ||--SystemName ${SystemName} --AccountName ${NotExist}                                             ||Unable to change the password for ${NotExist}                                                      |
|Check Change Log                 |${NotExist}  ||Forced Reset Failed                                                                                                                                                                                   |
|pause                            |100000                                                                                                                                                                                                               |
|Change Failure Mail              |${MailServer}||${SystemEMail}                                                                                   ||${SystemEMailPwd}||${FromMail}||${MailSubjectChangeFailure}||${MailBodyChangeFailure}||Forced Reset|
|Management tab                   |${NotExist}                                                                                                                                                                                                          |
|Check Consecutive Change Failures|2                                                                                                                                                                                                                    |
|Check Account Lock Status        |${NotExist}  ||true                                                                                                                                                                                                  |
|Change schedule disabled         |${NotExist}  ||false                                                                                                                                                                                                 |
|Update Account                   |${CLIBatch}  ||--SystemName ${SystemName} --AccountName ${NotExist} --PasswordChangeProfile "!NULL" --AutoFlag N||successfully                                                                                       |
|Delete Account                   |${CLIBatch}  ||--SystemName ${SystemName}  --AccountName ${NotExist}                                            ||successfully                                                                                       |
|Delete Mails                     |${SystemEMail}                                                                                                                                                                                                       |
|stop                                                                                                                                                                                                                                                   |
