!include -c <AutomatedTesting.ScenarioLibrary
!include -c <AutomatedTesting.CliScenarios.ScenarioLibrary
!include -c <AutomatedTesting.PlatformsTesting.EdmzSpcw2.PlatformSpecific
!include -c <FrontPage.AutomatedTesting.KnownIssues
!include -c <AutomatedTesting.EspcwClientScenarios.LocalUser.ScenarioLibrary

!define FailedLogEntry {The specified network password is not correct}
!define SuccessLogEntry {The password change operation completed successfully}

!|script                                                                               |
|ClearClientLogFile on            |${SystemAddress}                                    |
|Change Account Password on System|${ManagedAccountPwdNew}                             |
|Uncheck Checkbox                 |useoldpass        |for user|DEFAULT                 |
|Check Checkbox                   |useoldpass        |for user|${ManagedAccount}       |
|Check Password                   |${ManagedAccount} |        |${CheckPasswordNotMatch}|
|pause                            |40000                                               |
|ClientLogFileContains            |${FailedLogEntry} |on      |${SystemAddress}        |
|ClearClientLogFile on            |${SystemAddress}                                    |
|Check Checkbox                   |useoldpass        |for user|DEFAULT                 |
|Uncheck Checkbox                 |useoldpass        |for user|${ManagedAccount}       |
|Check Password                   |${ManagedAccount} |        |${CheckPasswordNotMatch}|
|pause                            |40000                                               |
|ClientLogFileContains            |${SuccessLogEntry}|on      |${SystemAddress}        |
|Uncheck Checkbox                 |useoldpass        |for user|DEFAULT                 |
