!* Test description
This option allows an Admin or a PPM ISA to grant more than one Privileged Access User (PAC) to request and
retrieve a password/session during the same or overlapping time period.
*!

!define SuccessfulPwdRequest {has been submitted.*current status is Active/Approved}
!define FailedPwdRequest {is already scheduled for 1 password release}

!*> Including section
!include -c <AutoTestsWebDrv.ScenarioLibrary
!include -c <AutoTestsWebDrv.CliScenarios.ScenarioLibrary
!include -c <AutoTestsWebDrv.EmailScenarios.ScenarioLibrary
!include -c ScenarioLibrary
*!

!*> Prepare Environment: Remove Requestor-Approver permissions and add PAC rights
!|script                                                                    |
|Revoke User Permissions           |${CLI_user_1}                           |
|Revoke User Permissions           |${CLI_user_2}                           |
|Set User Permissions Account Level|${CLI_user_1}||\"PPM Privileged Access\"|
|Set User Permissions Account Level|${CLI_user_2}||\"PPM Privileged Access\"|
*!

!3 Default behavior: Another user can't make a new request 
!|script                                                                             |
|Request Pwd by        |${CLI_user_1}|with result|${SuccessfulPwdRequest}||firstReqID|
|Request Pwd by        |${CLI_user_2}|with result|${FailedPwdRequest}    ||secReqID  |
|Cancel Request with ID|firstReqID   |perfomed by|${CLI_user_1}                      |

!3 Change setting: Another user can make a new request
!|script                                                                                        |
|Open                          |${TPAMURL}   |           |${TPAMAdmin}           ||${DefaultPwd}|
|Change Allowed PAC Releases to|2                                                               |
|Request Pwd by                |${CLI_user_1}|with result|${SuccessfulPwdRequest}||firstReqID   |
|Request Pwd by                |${CLI_user_2}|with result|${SuccessfulPwdRequest}||secReqID     |

!*> Clean Up
!|script                                                                              |
|Cancel Request with ID           |firstReqID   |perfomed by|${CLI_user_1}            |
|Cancel Request with ID           |secReqID     |perfomed by|${CLI_user_2}            |
|Change Allowed PAC Releases to   |1                                                  |
|Remove User Permissions On System|${CLI_user_1}|           |\"PPM Privileged Access\"|
|Remove User Permissions On System|${CLI_user_2}|           |\"PPM Privileged Access\"|
|Set User Permissions             |${CLI_user_2}                                      |
|Set User Permissions             |${CLI_user_1}                                      |
*!
