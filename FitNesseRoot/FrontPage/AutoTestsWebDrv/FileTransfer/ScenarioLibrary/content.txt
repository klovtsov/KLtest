!|scenario        |Set psm settings for|account                                                                                                                           |
|$res=            |CLI                 |${CLIBatch} Updatepsmaccount --system ${SystemName} --Account @account --EnableFlag Y --ProxyType ${psmProxyType} --MinApprovers 0|
|Verify_Contain_OR|$res;;PSM Details saved successfully                                                                                                                   |

!|scenario        |Set File Transfer settings for|account               |transfer method              |method              |sharepath              |fTransferPath              |
|$res=            |CLI                           |${CLIBatch} Updatepsmaccount --system ${SystemName} --Account @account --FileTransType @method --FileTransPath @fTransferPath|
|Verify_Contain_OR|$res;;PSM Details saved successfully                                                                                                                        |

!|scenario         |Is download enable|downloadEnable                                                                                                                                                                      |
|$res=             |CLI               |${CLIBatch} Updatepsmaccount --system ${SystemName} --Account ${ManagedAccount} --FileTransType ${TransferMethod} --FileTransPath ${shareFolder} --FileTransDownFlag @downloadEnable|
|Verify_Contain_NOT|$res;;Something went wrong                                                                                                                                                                             |
|Verify_Contain_OR |$res;;PSM Details saved successfully                                                                                                                                                                   |

!|scenario         |Is upload enable|uploadEnable                                                                                                                                                                |
|$res=             |CLI             |${CLIBatch} Updatepsmaccount --system ${SystemName} --Account ${ManagedAccount} --FileTransType ${TransferMethod} --FileTransPath ${shareFolder} --FileTransUp @uploadEnable|
|Verify_Contain_NOT|$res;;Something went wrong                                                                                                                                                                   |
|Verify_Contain_OR |$res;;PSM Details saved successfully                                                                                                                                                         |

!|scenario            |Download File from System                                                                                                     |
|$res =               |GroovyWebDriver      |fileTransfer;${TPAMHost};${TPAMAdmin};${DefaultPwd};$RequestID;download;${AcceptImage};${fileToDownload}|
|Verify_Contain_NOT   |$res;;Something went wrong                                                                                                    |
|Check Downloaded File|${BrowserDownloadDir}|                                           |${fileToDownload}                                           |

!|scenario         |Download File with error|expectedError                                                                                                             |
|$res =            |GroovyWebDriver         |fileTransfer;${TPAMHost};${TPAMAdmin};${DefaultPwd};$RequestID;downloadErr;${AcceptImage};${fileToDownload};@expectedError|
|Verify_Contain_NOT|$res;;Something went wrong                                                                                                                         |

!|scenario        |Add Session Request                                                                                                                                          |
|$res=            |CLI                  |${CLIBatch} AddSessionRequest --SystemName ${SystemName} --AccountName ${ManagedAccount} --ForUserName ${TPAMAdmin} --RequestNotes test|
|Verify_Contain_OR|$res;;submitted                                                                                                                                              |
|$RequestID=      |get_session_RequestID|$res                                                                                                                                   |

!|scenario        |Cancel Session Request                                                    |
|$res=            |CLI|${CLIBatch} CancelSessionRequest --RequestID $RequestID --Comment test|
|Verify_Contain_OR|$res;;successfully;;Terminated;;terminated                                |
|pause            |10000                                                                     |

!|scenario                     |Prepare Enviroment                                                             |
|Open                          |${TPAMURL}       |               |${TPAMAdmin}        |         |${DefaultPwd} |
|Create Account on System                                                                                      |
|Create Share                                                                                                  |
|Add system                                                                                                    |
|Add PPM account               |${ManagedAccount}|with password  |${ManagedAccountPwd}|and profiles|${checkProfileName}||\"${changeProfileName}\"||successfully|
|Set psm settings for          |${ManagedAccount}                                                              |
|Set File Transfer settings for|${ManagedAccount}|transfer method|${TransferMethod}   |sharepath|${shareFolder}|
|Is download enable            |Y                                                                              |
|Is upload enable              |Y                                                                              |
|Set User Permissions          |${CLI_user_1}                                                                  |
|Set User Permissions          |${TPAMAdmin}                                                                   |
|pause                         |${ApplyNewPoliciesInterval}                                                    |
|Logout Paradmin                                                                                               |
|Show Desktop                                                                                                  |

!|scenario|Check Downloaded File|filePath||fileName|
|runBatch |CheckAndDeleteFile;@filePath;"@fileName"|

!|scenario         |Check Download Checkbox                                                                                           |
|Is download enable|N                                                                                                                 |
|$res =            |GroovyWebDriver|fileTransfer;${TPAMHost};${TPAMAdmin};${DefaultPwd};$RequestID;checkDownloadAllowed;${AcceptImage}|
|Verify_Contain_OR |$res;;File Download is prohibited                                                                                 |

!|scenario         |Check Upload Checkbox                                                                                           |
|Is download enable|Y                                                                                                               |
|Is upload enable  |N                                                                                                               |
|$res =            |GroovyWebDriver|fileTransfer;${TPAMHost};${TPAMAdmin};${DefaultPwd};$RequestID;checkUploadAllowed;${AcceptImage}|
|Verify_Contain_OR |$res;;File Upload is prohibited                                                                                 |

!|scenario|Create file for uploading|fileName|in directory|filePath|
|runBatch |CreateFile2;@filePath;"@fileName"                       |

!|scenario                |Upload File to System                                                                                                          |
|Is upload enable         |Y                                                                                                                              |
|Create file for uploading|${fileToUpload}|in directory                                          |${ProjDir}\                                             |
|$res =                   |GroovyWebDriver|fileTransfer;${TPAMHost};${TPAMAdmin};${DefaultPwd};$RequestID;upload;${AcceptImage};${fileToUpload};${ProjDir}|
|Verify_Contain_NOT       |$res;;Something went wrong                                                                                                     |
|Check file on system     |${fileToUpload}                                                                                                                |
|Check Downloaded File    |${ProjDir}\    |                                                      |${fileToUpload}                                         |

!|scenario                |Upload Two Files                                                                                                                                           |
|Is upload enable         |Y                                                                                                                                                          |
|Create file for uploading|${fileToUpload}      |in directory                                                  |${ProjDir}\                                                           |
|Create file for uploading|${secondFileToUpload}|in directory                                                  |${ProjDir}\                                                           |
|$res =                   |GroovyWebDriver      |fileTransfer;${TPAMHost};${TPAMAdmin};${DefaultPwd};$RequestID;upload;${AcceptImage};${fileToUpload},${secondFileToUpload};${ProjDir}|
|Verify_Contain_NOT       |$res;;Something went wrong                                                                                                                                 |
|Check file on system     |${secondFileToUpload}                                                                                                                                      |
|Check file on system     |${fileToUpload}                                                                                                                                            |
|Check Downloaded File    |${ProjDir}\          |                                                              |${fileToUpload}                                                       |
|Check Downloaded File    |${ProjDir}\          |                                                              |${secondFileToUpload}                                                 |

!|scenario            |Specify Creds at Transfer Time                                                                                                                                                             |
|Is download enable   |Y                                                                                                                                                                                          |
|Require to specify creds at transfer time                                                                                                                                                                        |
|$res =               |GroovyWebDriver      |fileTransfer;${TPAMHost};${TPAMAdmin};${DefaultPwd};$RequestID;specifyCreds;${AcceptImage};${fileToDownload};${FileTransUser};${content};${isFileTransfUsrFunctional}|
|Verify_Contain_NOT   |$res;;Something went wrong                                                                                                                                                                 |
|Check Downloaded File|${BrowserDownloadDir}|                                                                          |${fileToDownload}                                                                         |

!|scenario        |Require to specify creds at transfer time                                                                       |
|$res=            |CLI|${CLIBatch} Updatepsmaccount --system ${SystemName} --Account ${ManagedAccount} --FileTransAuthMethod Prompt|
|Verify_Contain_OR|$res;;PSM Details saved successfully                                                                            |

!|scenario|Session Cleanup  |accountName                                                              |
|$res=    |RunBatchGetOutput|CleanupSession;${SystemAddress};${FunctAcct};${FunctAcctPwd};@accountName|
