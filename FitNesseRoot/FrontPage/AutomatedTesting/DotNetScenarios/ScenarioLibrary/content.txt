!| scenario       |Add system                                                                                                                                                            |
|$res=            |NetAPI|${APIBatch} ${CommandTimeout} AddSystem ${SystemName} ${SystemAddress} "${SystemPlatform}" "${SystemDescription}" ${SystemTimeout} ${FunctAcct} ${FunctAcctPwd}|
|Verify_Contain_OR|$res;;successful                                                                                                                                                      |

!| scenario       |Test System|testRes                                               |
|$res=            |NetAPI     |${APIBatch} ${CommandTimeout} TestSystem ${SystemName}|
|Verify_Contain_OR|$res;;@testRes                                                    |

#!| scenario|Set Password           |acc           |           |passwd           |
#|NetAPI    |${APIBatch} ${CommandTimeout} SetPassword ${SystemName} @acc @passwd|
!| scenario       |Set Password|acc                   |                   |passwd                   |
|$res=            |NetAPI      |${APIBatch} ${CommandTimeout} SetPassword ${SystemName} @acc @passwd|
|Verify_Contain_OR|$res;;${NotFailed}                                                               |

!| scenario       |Check Password|acc                 |                 |testRes                |
|$res=            |NetAPI        |${APIBatch} ${CommandTimeout} CheckPassword ${SystemName} @acc|
|Verify_Contain_OR|$res;;@testRes                                                               |

!| scenario|Remove account                      |accName                      |
|NetAPI    |${APIBatch} ${CommandTimeout} RemoveAccount ${SystemName} @accName|


!| scenario       |Remove system|sysName                                            |
|$res=            |NetAPI       |${APIBatch} ${CommandTimeout} DeleteSystem @sysName|
|Verify_Contain_OR|$res;;successful                                                 |

!| scenario       |Add account|acc                          |with password                          |pwd                         |                         |testRes                         |
|$Months=         |getEval    |var d = new Date();d.setMinutes(d.getMinutes()+1); d.setDate(d.getDate()+1);var s = d.getMonth()+1;if ((s + "").length == 1) s = "0" + s;else d.getMonth()+1;|
|$Days=           |getEval    |var d = new Date();d.setMinutes(d.getMinutes()+1); d.setDate(d.getDate()+1);var s = d.getDate(); if ((s + "").length == 1) s = "0" + s;else d.getDate();     |
|$Years=          |getEval    |var d = new Date();d.setMinutes(d.getMinutes()+1); d.setDate(d.getDate()+1); d.getFullYear();                                                                |
|$res=            |NetAPI     |${APIBatch} ${CommandTimeout} AddAccount ${SystemName} @acc @pwd $Months/$Days/$Years                                                                        |
|Verify_Contain_OR|$res;;@testRes                                                                                                                                                           |

!| scenario       |Reset Password|acc                 |                 |testRes                |
|$res=            |NetAPI        |${APIBatch} ${CommandTimeout} ResetPassword ${SystemName} @acc|
|Verify_Contain_OR|$res;;@testRes                                                               |

!|scenario        |Set User Permissions|userName                                                                                                          |
|$res=            |NetAPI              |${APIBatch} ${CommandTimeout} SetUserPermission ${SystemName} ${ManagedAccount} "Approver-Requestor" ADD @userName|
|Verify_Contain_OR|$res;;successful                                                                                                                       |

!|scenario        |Revoke User Permissions|userName                                                                                                           |
|$res=            |NetAPI                 |${APIBatch} ${CommandTimeout} SetUserPermission ${SystemName} ${ManagedAccount} "Approver-Requestor" DROP @userName|
|Verify_Contain_OR|$res;;successful                                                                                                                           |

!| scenario       |Request Pwd                                                                                                   |
|$res=            |NetAPI       |${APIBatch} ${CommandTimeout} RequestPassword ${SystemName} ${ManagedAccount} ${API_user_1} test|
|Verify_Contain_OR|$res;;submitted                                                                                               |
|$RequestID=      |get_RequestID|$res                                                                                            |

!| scenario       |Approve Pwd                                                     |
|$res=            |NetAPI|${APIBatch2} ${CommandTimeout} ApprovePassword $RequestID|
|Verify_Contain_OR|$res;;submitted                                                 |

!| scenario             |Get Login                                                       |
|$GeneratedPwd=         |NetAPI|${APIBatch} ${CommandTimeout} RetrievePassword $RequestID|
|Login Account to System|$GeneratedPwd                                                   |
#|$GeneratedPwd=         |NetAPI|${APIBatch} ${CommandTimeout} RetrievePassword ${SystemName} ${ManagedAccount}|


!| scenario    |Managed System                           |
|Create Account on System                                |
|Open          |${TPAMURL}  ||${TPAMAdmin}||${DefaultPwd}|
|Add system                                              |
|Test System   |${TestSystemSuccessful}                  |
|Set password  |${FunctAcct}||${FunctAcctWrongPwd}       |
|Test System   |${TestSystemFailed}                      |
|Check Password|${FunctAcct}||${CheckPasswordFailed}     |

!| scenario                       |Managed Account                                                    |
|Add account                      |${ManagedAccount}|with password|${ManagedAccountPwd}||${NotFailed} |
|Reset Password                   |${ManagedAccount}|             |${ResetPasswordFailed}             |
|Change Account Password on System|${ManagedAccountPwdNew}                                            |
|pause                            |${ChangeManagedAccountPasswordTimeout}                             |
|Set password                     |${FunctAcct}     |             |${FunctAcctPwd}                    |
|pause                            |${RestoreFunctAcctPasswordTimeout}                                 |
|Check Password                   |${ManagedAccount}|             |${CheckPasswordNotMatch}           |
|pause                            |${RestoreFunctAcctPasswordTimeout}                                 |
|Reset Password                   |${ManagedAccount}|             |${ResetPasswordSuccessful}         |


#!| scenario                       |Managed Account                                                    |
#|Add account                      |${ManagedAccount}|with password|${ManagedAccountPwd}||${NotFailed} |
#|Reset Password                   |${ManagedAccount}|             |${ResetPasswordFailed}             |
#|Open                             |${TPAMURL}       |             |${TPAMAdmin}        ||${DefaultPwd}|
#|Choose Account                   |${ManagedAccount}                                                  |
#|Schedule Reset Password          |Failed                                                             |
#|Change Account Password on System|${ManagedAccountPwdNew}                                            |
#|pause                            |${ChangeManagedAccountPasswordTimeout}                             |
#|Set password                     |${FunctAcct}     |             |${FunctAcctPwd}                    |
#|pause                            |${RestoreFunctAcctPasswordTimeout}                                 |
#|Check Password                   |${ManagedAccount}|             |${CheckPasswordNotMatch}           |
#|pause                            |${RestoreFunctAcctPasswordTimeout}                                 |
#|Check Status                     |Success          |for reason   |Mismatch                           |
#|Reset Password                   |${ManagedAccount}|             |${ResetPasswordSuccessful}         |
#|Schedule Reset Password          |Success                                                            |



!| scenario          |Request Password and Login|
|Set User Permissions|${API_user_1}             |
|Set User Permissions|${API_user_2}             |
|pause               |${ApplyNewPoliciesInterval}|
|Request Pwd                                    |
|Approve Pwd                                    |
|Get Login                                      |
#|Set User Permissions|${Requestor}              |

!|scenario     |Account Not there                               |
|Add account   |AccNotThere|with password|master | |${NotFailed}|
|Reset Password|AccNotThere|             |${ResetPasswordFailed}|
|Check Password|AccNotThere|             |${CheckPasswordFailed}|

!|scenario        |System Unreachable                                                                |
|$res=            |NetAPI           |${APIBatch} ${CommandTimeout} UpdateSystem ${SystemName} 1.2.3.4|
|Verify_Contain_OR|$res;;${NotFailed}                                                                |
|Test System      |${TestSystemFailed}                                                               |
|Reset Password   |${ManagedAccount}|                     |${ResetPasswordFailed}                    |
|Check Password   |${ManagedAccount}|                     |${CheckPasswordFailed}                    |

!|scenario|Set description            |accDescrptn            |for            |account            |
|$res=|NetAPI   |${APIBatch} ${CommandTimeout} SetAccountDescription ${SystemName} @account @accDescrptn|
|Verify_Contain_OR|$res;;${NotFailed}                                                               |
