!contents


!|scenario                                     |Prepare Test                                                                                                         |
|Login                                         |${TPAMURL}          |           |${TPAMAdmin}     |         |${DefaultPwd}                                           |
|Add System                                    |${SystemName}       |           |${SystemAddress} |         |${SystemPlatform}|        |${FunctAcct}||${FunctAcctPwd}|
|Prepare Account                               |${ManagedAccount}   |           |${SystemName}    |         |${SystemAddress}                                        |
|Prepare Requestor                             |${Requestor}                                                                                                         |
|Assign Policy                                 |${PolicyName}       |To Account |${ManagedAccount}|On System|${SystemName}    |And User|${Requestor}                 |
|Login                                         |${TPAMURL}          |           |${TPAMAdmin}     |         |${DefaultPwd}                                           |
|Create Command Restriction Profile            |${ProfileName}      |with action|Do Nothing                                                                          |
|Create Access Policy With Command Restrictions|${PolicyName}       |           |${ProfileName}                                                                      |
|Assign Policy                                 |"Approver-Requestor"|To Account |${ManagedAccount}|On System|${SystemName}    |And User|${CLI_user_1}                |
|Logout                                                                                                                                                              |
|Create Email Receiver                         |${EmailReceiver}    |           |${ReceiverEmail}                                                                    |
|Subscribe For Session Alerts                  |${EmailReceiver}                                                                                                     |
|Create SNMP Receiver                          |${SNMPReceiver}                                                                                                      |
|Subscribe For Session Alerts                  |${SNMPReceiver}                                                                                                      |
|Create Notification Mailbox                                                                                                                                         |
|Prepare SNMP Trap                                                                                                                                                   |
#|Set Threshold Values                                                                                                                                                                     |
#|Add User To Group                             |${CLI_user_1}    |           |\"Global PSM Requestor Group\"                                                      |
#|Add User To Group                             |${CLI_user_1}    |           |\"Global ISA Group\"                                                                |

!|Scenario              |Generate Alerts                                                              |
|Open Session Do Nothing|${Requestor}  |           |${SystemName}||${ManagedAccount}||psm_do_nothing  |
|Check Email Alert      |${MessageDoNothing}                                                          |
|Check SNMP Alert       |${MessageDoNothing}                                                          |
|Check Notification     |A restricted command was detected                                            |
|Change Action          |${ProfileName}|with action|Kill Command                                      |
|Open Session           |${Requestor}  |           |${SystemName}||${ManagedAccount}||psm_kill_command|
|Check Email Alert      |${MessageKillCommand}                                                        |
|Check SNMP Alert       |${MessageKillCommand}                                                        |
|Check Notification     |A restricted command was detected                                            |
|Change Action          |${ProfileName}|with action|Kill Login                                        |
|Open Session           |${Requestor}  |           |${SystemName}||${ManagedAccount}||psm_kill_login  |
|Check Email Alert      |${MessageKillLogin}                                                          |
|Check SNMP Alert       |${MessageKillLogin}                                                          |
|Check Notification     |A restricted command was detected                                            |
|Change Action          |${ProfileName}|with action|Kill Session                                      |
|Open Session           |${Requestor}  |           |${SystemName}||${ManagedAccount}||psm_kill_session|
|Check Email Alert      |${MessageKillSession}                                                        |
|Check SNMP Alert       |${MessageKillSession}                                                        |
|Check Notification     |A restricted command was detected                                            |



!|scenario                         |Clear Objects                                                                               |
|Unassign Policy                   |${PolicyName}    |To Account|${ManagedAccount}|On System|${SystemName}|And User|${Requestor}|
|pause                             |300000                                                                                      |
|Remove system                     |${SystemName}                                                                               |
|Delete Account on System          |${ManagedAccount}|on system |${SystemAddress}                                               |
|Remove User                       |${Requestor}                                                                                |
|Login                             |${TPAMURL}       |          |${TPAMAdmin}     |         |${DefaultPwd}                      |
|Hard-Delete System                |${SystemName}                                                                               |
|Rollback Access Policy            |${PolicyName}                                                                               |
|Delete Command Restriction Profile|${ProfileName}                                                                              |
|Logout                                                                                                                         |
|Delete Email Receiver             |${EmailReceiver} |          |${ReceiverEmail}                                               |
|Delete SNMP Receiver              |${SNMPReceiver}                                                                             |
|Delete Notification Mailbox                                                                                                    |
#|Remove User From Group            |${CLI_user_1}    |          |\"Global PSM Requestor Group\"                                 |
#|Remove User From Group            |${CLI_user_1}    |          |\"Global ISA Group\"                                           |



!|scenario            |Change Action                  |profileName|with action |actionName    |
|Login                |${TPAMURL}                     |           |${TPAMAdmin}||${DefaultPwd}|
|waitForElementPresent|link=Profile Management                                                |
|clickAndWait         |link=Profile Management                                                |
|waitForElementPresent|id=ProfileType                                                         |
|select;              |id=ProfileType                 |label=Restricted Command               |
|select;              |id=ProfileID                   |label=@profileName                     |
|click                |css=select.cmdAction.cmdDtlCtrl                                        |
|select;              |css=select.cmdAction.cmdDtlCtrl|label=@actionName                      |
|click                |id=SaveButton                                                          |
|waitForTextPresent   |The profile updated successfully                                       |






!|scenario            |Delete Command Restriction Profile|profileName             |
|waitForElementPresent|link=Profile Management                                    |
|click                |link=Profile Management                                    |
|pause                |1000                                                       |
|waitForElementPresent|id=ProfileType                                             |
|select;              |id=ProfileType                    |label=Restricted Command|
|pause                |1000                                                       |
|select;              |id=ProfileID                      |label=@profileName      |
|click                |id=DeleteButton                                            |
|pause                |3000                                                       |
|getConfirmation                                                                  |
|pause                |3000                                                       |



!|scenario            |Create Access Policy With Command Restrictions|policyName||profileName|
|pause                |1000                                                                  |
|clickAndWait         |link=Access Policies                                                  |
|type;                |id=filtPolicyName                             |@policyName            |
|click                |id=Listing                                                            |
|waitForElementPresent|//td[contains(text(),'@policyName')]          |                       |
|mouseDown            |//td[contains(text(),'@policyName')]          |                       |
|click                |//td[contains(text(),'@policyName')]          |                       |
|click                |id=Details                                                            |
|pause                |1000                                                                  |
|waitForElementPresent|id=UseDefaultsFl                                                      |
|click                |id=UseDefaultsFl                                                      |
|pause                |1000                                                                  |
|click                |id=RecordingRequiredFl                                                |
|pause                |1000                                                                  |
|click                |id=RecordKeystrokesFl                                                 |
|pause                |1000                                                                  |
|click                |id=RecordEventsFl                                                     |
|pause                |1000                                                                  |
|select;              |id=CmdRestrictionProfileID                    |label=@profileName     |
|pause                |1000                                                                  |
|select;              |id=MaxDurationDays                            |label=0                |
|select;              |id=MaxDurationHrs                             |label=00               |
|select;              |id=MaxDurationMins                            |label=15               |
|pause                |1000                                                                  |
|click                |id=SubmitChangesButton                                                |
|waitForTextPresent   |Access Policy saved successfully                                      |



!|scenario            |Rollback Access Policy              |policyName |
|pause                |1000                                            |
|clickAndWait         |link=Access Policies                            |
|type;                |id=filtPolicyName                   |@policyName|
|click                |id=Listing                                      |
|waitForElementPresent|//td[contains(text(),'@policyName')]|           |
|mouseDown            |//td[contains(text(),'@policyName')]|           |
|click                |//td[contains(text(),'@policyName')]|           |
|click                |id=Details                                      |
|waitForElementPresent|id=UseDefaultsFl                                |
|select;              |id=CmdRestrictionProfileID          |label=None |
|click                |id=UseDefaultsFl                                |
|click                |id=SubmitChangesButton                          |
|waitForTextPresent   |Access Policy saved successfully                |


!|scenario        |Assign Policy|policyName           |To Account           |accountName           |On System           |systemName           |And User           |userName          |
|$res=            |CLI          |${CLIBatch} SetAccessPolicy --AccessPolicyName \"@policyName\" --Action ADD --SystemName @systemName --AccountName @accountName --UserName @userName|
|Verify_Contain_OR|$res;;successful                                                                                                                                                  |


!|scenario        |Unassign Policy|policyName           |To Account           |accountName           |On System           |systemName           |And User           |userName           |
|$res=            |CLI            |${CLIBatch} SetAccessPolicy --AccessPolicyName \"@policyName\" --Action DROP --SystemName @systemName --AccountName @accountName --UserName @userName|
|Verify_Contain_OR|$res;;successful                                                                                                                                                     |




!|scenario         |Set Threshold Values                       |
|clickAndWait      |link=Thresholds                            |
|type;             |id=I4                  |60                 |
|type;             |id=T4                  |50                 |
|type;             |id=D4                  |2                  |
|type;             |id=I2                  |60                 |
|type;             |id=T2                  |50                 |
|type;             |id=I3                  |60                 |
|type;             |id=T3                  |2                  |
|type;             |id=I1                  |60                 |
|click             |id=SubmitChanges                           |
|waitForTextPresent|Successfully saved Alert Threshold settings|



!|scenario         |Create Email Receiver|receiverName|             |receiverEmail|
|Create Mailbox    |@receiverEmail       |            |${ReceiverEmailPassword}   |
|Login             |${TPAMAdminURL}      |            |${TPAMMaster}||${MasterPwd}|
|pause             |1000                                                          |
|clickAndWait      |link=Receivers                                                |
|click             |id=AddAlertReceiver                                           |
|pause             |1000                                                          |
|type;             |id=ReceiverName      |@receiverName                           |
|type;             |id=Comment           |@receiverName description               |
|select;           |id=RecvType          |label=E-Mail                            |
|type;             |id=EmailAddress      |@receiverEmail                          |
|type;             |id=MaxRetries        |0                                       |
|click             |id=SubmitChanges                                              |
|waitForTextPresent|Receiver added successfully                                   |


!|scenario     |Create Notification Mailbox                       |
|Create Mailbox|${NotifyRestrictedEmail}||${ReceiverEmailPassword}|

!|scenario     |Delete Notification Mailbox|
|Delete Mailbox|${NotifyRestrictedEmail}   |


!|scenario         |Create SNMP Receiver|receiverName                |
|Login             |${TPAMAdminURL}     ||${TPAMMaster}||${MasterPwd}|
|pause             |1000                                             |
|clickAndWait      |link=Receivers                                   |
|click             |id=AddAlertReceiver                              |
|pause             |1000                                             |
|type;             |id=ReceiverName     |@receiverName               |
|type;             |id=Comment          |@receiverName description   |
|select;           |id=RecvType         |label=SNMP                  |
|type;             |id=NetworkAddress   |${DispatcherAddress}        |
|select;           |id=Version          |label=SNMP Version 1        |
|click             |id=SubmitChanges                                 |
|waitForTextPresent|Receiver added successfully                      |



!|scenario            |Select Receiver                                         |receiverName |
|waitForElementPresent|link=Receivers                                                        |
|clickAndWait         |link=Receivers                                                        |
|type;                |//input[@id='ReceiverNm']                               |@receiverName|
|click                |id=Listing                                                            |
|waitForElementPresent|//table[@id='receiverTable']//td[text()='@receiverName']|             |
|mouseDown            |//table[@id='receiverTable']//td[text()='@receiverName']|             |
|click                |//table[@id='receiverTable']//td[text()='@receiverName']|             |


!|scenario         |Delete Email Receiver|receiverName|             |receiverEmail|
|Delete Mailbox    |@receiverEmail                                                |
|Login             |${TPAMAdminURL}      |            |${TPAMMaster}||${MasterPwd}|
|pause             |3000                                                          |
|Select Receiver   |@receiverName                                                 |
|click             |id=DeleteAlertReceiver                                        |
|getConfirmation                                                                  |
|waitForTextPresent|Alert Receiver successfully deleted                           |

!|scenario         |Delete SNMP Receiver|receiverName                |
|Login             |${TPAMAdminURL}     ||${TPAMMaster}||${MasterPwd}|
|pause             |3000                                             |
|Select Receiver   |@receiverName                                    |
|click             |id=DeleteAlertReceiver                           |
|getConfirmation                                                     |
|waitForTextPresent|Alert Receiver successfully deleted              |



!|scenario         |Subscribe For Session Alerts|receiverName|
|Select Receiver   |@receiverName                            |
|click             |id=Alerts                                |
|pause             |1000                                     |
|click             |name=cbxAlert_L1_25                      |
|pause             |1000                                     |
|click             |id=SubmitChanges                         |
|waitForTextPresent|Subscriptions successfully saved         |





!|scenario               |Prepare Account|accountName  |                    |systemName||systemAddress|
|Add PSM Account         |@accountName   |on system    |@systemName                                   |
|pause                   |1000                                                                        |
|Create Account on System|@accountName   |with password|${ManagedAccountPwd}|on system |@systemAddress|
|pause                   |1000                                                                        |


#!| scenario       |Add System|systemName                     |                    |systemAddress                    |                    |systemPlatform                    |                    |functAcct                    |                    |functionalAccountPassword                    |
#|$res=            |CLI       |${CLIBatch} AddSystem --SystemName @systemName --NetworkAddress @systemAddress --PlatformName \"@systemPlatform\" --FunctionalAccount @functAcct --FuncAcctCred @functionalAccountPassword --Timeout ${SystemTimeout} --MaxReleaseDuration 120 --ReleaseChangeFlag N|
#|Verify_Contain_OR|$res;;successful                                                                                                                                                                                                                                                  |


!|scenario            |Add system       |systemName||systemAddress||systemPlatform||functAcct||functionalAccountPassword|
|pause                |1000                                                                                             |
|clickAndWait         |link=Add System                                                                                  |
|waitForElementPresent|id=SystemName                                                                                    |
|type;                |id=SystemName    |@systemName                                                                    |
|type;                |id=NetworkAddress|@systemAddress                                                                 |
|select;              |id=PlatformID    |label=@systemPlatform                                                          |
|pause                |1000                                                                                             |
|click                |id=Connection    |                                                                               |
|type;                |id=PARFuncAcct   |@functAcct                                                                     |
|type;                |id=pword         |@functionalAccountPassword                                                     |
|type;                |id=ConfPword     |@functionalAccountPassword                                                     |
|click                |id=bt_Save       |                                                                               |
|waitForTextPresent   |System changes for * saved successfully                                                          |




!| scenario       |Remove system|sysName                          |
|$res=            |CLI          |${CLIBatch} DeleteSystem @sysName|
|Verify_Contain_OR|$res;;successful                               |


!|scenario            |Hard-Delete System                  |systemName |
|clickAndWait         |link=Deleted Systems                            |
|type;                |id=SystemNm                         |@systemName|
|click                |id=Listing                          |           |
|waitForElementPresent|//td[contains(text(),'@systemName')]|           |
|mouseDown            |//td[contains(text(),'@systemName')]|           |
|click                |//td[contains(text(),'@systemName')]|           |
|click                |id=HardDeleteButton                 |           |
|getConfirmation                                                       |
|waitForTextPresent   |has been successfully deleted                   |
|pause                |1000                                            |


#!| scenario       |Add Account|accountName                                                         |on system                                                        |systemName                                                        |
#|$res=            |CLI        |${CLIBatch} AddAccount --SystemName @systemName --AccountName @accountName --Password ${ManagedAccountPwd}  --Description \"@accountName description\" --MinimumApprovers 0 --MaxReleaseDuration 120|
#|Verify_Contain_OR|$res;;successful                                                                                                                                                                                                     |



!|scenario            |Add PSM Account                     |accountName       |on system      |systemName      |
|clickAndWait         |link=Add Account                    |                                                   |
|type;                |id=SystemNm                         |@systemName                                        |
|click                |id=System                           |                                                   |
|waitForElementPresent|//td[contains(text(),'@systemName')]|                                                   |
|mouseDown            |//td[contains(text(),'@systemName')]|                                                   |
|click                |//td[contains(text(),'@systemName')]|                                                   |
|click                |id=Details                          |                                                   |
|type;                |id=AccountName                      |@accountName                                       |
|type;                |id=sPswd                            |${ManagedAccountPwd}                               |
|type;                |id=sConfPswd                        |${ManagedAccountPwd}                               |
|click                |id=SubmitChangesButton              |                                                   |
|waitForTextPresent   |Changes saved successfully for @accountName                                             |
|click                |id=PSMDetails                                                                           |
|waitForElementPresent|id=cb_EnableFl                                                                          |
|click                |id=cb_EnableFl                                                                          |
|select;              |id=ProxyType                        |label=${ProxyType} - Automatic Login Using Password|
|type;                |id=EgpMinApprovers                  |0                                                  |
|select;              |id=EgpDurationQtrHrs                |label=15                                           |
|select;              |id=EgpDurationHrs                   |label=0                                            |
|select;              |id=EgpDurationDays                  |label=0                                            |
|click                |id=cb_RecordingRequiredFl           |                                                   |
|click                |id=btTestEventCaptureConfig                                                             |
|waitForTextPresent   |Task exited with return code 0                                                          |
|$res=                |getText                             |//div[@id='ResultDetailDiv']                       |
|Verify_Contain_OR    |$res;;Task exited with return code 0                                                    |
|click                |id=PSMDetails                                                                           |
|click                |id=cb_CaptureEventsFl                                                                   |
|click                |id=SubmitChangesButton              |                                                   |
|waitForTextPresent   |PSM Details saved successfully                                                          |
#|click                |id=btTestEventCaptureConfig                                                             |
#|pause |30000 |
#|click                |id=PSMDetails                                                                           |
#|waitForElementPresent|id=btTestEventCaptureConfig                                                             |

!| scenario       |Update PSM Details|accountName                                                             |on system                                                            |systemName                                                            |
|$res=            |CLI               |${CLIBatch} UpdateEGPAccount --System @systemName --Account @accountName  --ProxyType \"SSH - Automatic Login Using Password\" --DefaultSessionDuration 120 --EnableFlag Y --MinApprovers 0 --RecordingRequiredFlag Y|
|Verify_Contain_OR|$res;;successful                                                                                                                                                                                                                        |


!| scenario           |Update PSM Account                                      |accountName|on system|systemName|
|pause                |1000                                                                                     |
|click                |link=Manage Accounts                                    |                                |
|waitForElementPresent|id=SystemNm                                             |                                |
|type;                |id=SystemNm                                             |@systemName                     |
|click                |id=Listing                                              |                                |
|waitForElementPresent|//table[@id='AccountListing']//td[text()='@accountName']|                                |
|mouseDown            |//table[@id='AccountListing']//td[text()='@accountName']|                                |
|click                |//table[@id='AccountListing']//td[text()='@accountName']|                                |
|click                |id=PSMDetails                                                                            |
|waitForElementPresent|id=cb_CaptureEventsFl                                   |                                |
|click                |id=btTestEventCaptureConfig                                                              |
|waitForTextPresent   |Task exited with return code 0                                                           |
|$res=                |getText                                                 |//div[@id='ResultDetailDiv']    |
|Verify_Contain_OR    |$res;;Task exited with return code 0                                                     |
|click                |id=PSMDetails                                                                            |
|click                |id=cb_CaptureEventsFl                                   |                                |
|click                |id=SubmitChangesButton                                  |                                |
|waitForTextPresent   |PSM Details saved successfully                                                           |



!|scenario    |Create Account on System   |accountName   |with password  |pwd  |on system  |systemAddress  |
|accountAction|${SystemPlatform};;create;;@systemAddress;;${FunctAcct};;${FunctAcctPwd};;@accountName;;@pwd|

!|scenario    |Delete Account on System       |accountName       |on system      |systemAddress      |
|accountAction|${SystemPlatform};;delete;;@systemAddress;;${FunctAcct};;${FunctAcctPwd};;@accountName|



!|scenario |Prepare Requestor|UserName                  |
|Add User  |@UserName        ||${DefaultPwd}            |
|pause     |20000                                       |
|Change Pwd|@UserName        ||${DefaultPwd}||${UserPwd}|
#|Add User To Group|@UserName        ||\"Global PSM Requestor Group\"|



!|scenario        |Add User|UserName                             |                            |Password                            |
|$res=            |CLI     |${CLIBatch} AddUser --UserName @UserName --FirstName Testfirst --LastName Testlast --Password @Password|
|Verify_Contain_OR|$res;;successful                                                                                                |

!| scenario       |Remove User|userName                        |
|$res=            |CLI        |${CLIBatch} DeleteUser @userName|
|Verify_Contain_OR|$res;;successful                            |


!|scenario        |Add User To Group|UserName          |         |GroupName         |
|$res=            |CLI              |${CLIBatch} AddGroupMember @UserName,@GroupName|
|Verify_Contain_OR|$res;;successful                                                 |

!|scenario        |Remove User From Group|UserName          |          |GroupName         |
|$res=            |CLI                   |${CLIBatch} DropGroupMember @UserName,@GroupName|
|Verify_Contain_OR|$res;;successful                                                       |


!| scenario       |Remove System|sysName                          |
|$res=            |CLI          |${CLIBatch} DeleteSystem @sysName|
|Verify_Contain_OR|$res;;successful                               |

!| scenario       |Remove User|userName                        |
|$res=            |CLI        |${CLIBatch} DeleteUser @userName|
|Verify_Contain_OR|$res;;successful                            |



!|scenario   |Check Email Alert|message                  |
|Check Mail  |${ReceiverEmail} ||Session Events||@message|
|Delete Mails|${ReceiverEmail}                           |


!|scenario   |Check Notification      |message                                   |
|Check Mail  |${NotifyRestrictedEmail}||Restricted Command Notification||@message|
|Delete Mails|${NotifyRestrictedEmail}                                           |


!|scenario|Check SNMP Alert       |message       |
|runBatch |CheckSNMPLog;"@message";${SNMPLogPath}|
|runBatch |KillSNMPTrap;fake;fake                |


#|type;                |id=ResponseComment     |cancel             |
#|typeKeys;            |id=ResponseComment     |request            |
#|click                |id=SubmitChanges                           |
#|waitForTextPresent   |*The response * was submitted successfully*|
#|click                |id=TerminateSessionButton|
#|pause                |10000                    |


!|scenario        |Cancel Session Request                                                    |
|$res=            |CLI|${CLIBatch} CancelSessionRequest --RequestID $RequestID --Comment test|
|Verify_Contain_OR|$res;;successfully;;Terminat;;Active session can be forcibly removed      |


!| scenario             |Check Mail|user           |           |subject          |          |body          |
|$res=                  |CheckMail |${MailServer};@user;${ReceiverEmailPassword};${FromMail};@subject;@body|
|Verify_Contain_OR_alnum|$res;;@body;;too many messages                                                    |



!| scenario             |Delete Mails|user                                        |
|$res=                  |ClearMailbox|${MailServer};@user;${ReceiverEmailPassword}|
|Verify_Contain_OR_alnum|$res;;Messages deleted                                   |

!| scenario|Prepare SNMP Trap                 |
|runBatch  |RunSNMPTrap;hide;fake             |
|runBatch  |SetSNMPLogPath;${SNMPLogPath};fake|
|pause     |30000                             |
|runBatch  |KillSNMPTrap;fake;fake            |


!| scenario                 |BFER 6574 Batch update for PSM accounts disable the event capture Checkbox|
|Login                      |${TPAMURL}             |      |${TPAMAdmin}      |     |${DefaultPwd}     |
|Prepare Batch                                                                                         |
|Batch Update PSM Account   |update_psm_account_${OSType}.csv                                          |
|Check Event Capture Enabled|${ManagedAccount}      |      |${SystemName}                              |
|Rollback Batch                                                                                        |
|Logout                                                                                                |

!|scenario            |Batch Update PSM Account          |filename                                             |
|clickAndWait         |link=Update PSM Accounts          |                                                     |
|pause                |2000                                                                                    |
|click                |id=PAMUploadBtnSelect                                                                   |
|SWait                |browse.PNG                                                                              |
|SClick               |browse.PNG                                                                              |
|pause                |1500                                                                                    |
|SType                |${PathToBatch}\@filename                                                                |
|pause                |1500                                                                                    |
|SWait                |open.PNG                                                                                |
|SClick               |open.PNG                                                                                |
|pause                |2000                                                                                    |
|SWait                |upload_small.PNG                                                                        |
|SClick               |upload_small.PNG                                                                        |
|pause                |2000                                                                                    |
|type;                |id=Comment2                       |update PSM account                                   |
|click                |id=btnProcessFile                 |                                                     |
|pause                |1500                                                                                    |
|waitForElementPresent|//tr[@id='5']                                                                           |
|pause                |30000                                                                                   |
|verifyText           |//div[@id='divBatchResults']/table||${ManagedAccount} on ${SystemName} Successful Update|


!|scenario            |Check Event Capture Enabled          |accountName||systemName|
|clickAndWait         |link=Manage Accounts                                         |
|pause                |3000                                                         |
|type;                |id=SystemNm                          |@systemName            |
|type;                |id=AccountNm                         |@accountName           |
|click                |id=Listing                           |                       |
|waitForElementPresent|//td[contains(text(),'@accountName')]|                       |
|mouseDown            |//td[contains(text(),'@accountName')]|                       |
|click                |//td[contains(text(),'@accountName')]|                       |
|pause                |1000                                                         |
|click                |id=PSMDetails                                                |
|waitForElementPresent|id=cb_CaptureEventsFl                                        |
|$res=                |isChecked                            |id=cb_CaptureEventsFl  |
|Verify_Contain_OR    |$res;;true                                                   |


!| scenario  |Prepare Batch                               |
|Prepare File|${PathToBatch}||PREFIXPLACEHOLDER||${prefix}|


!| scenario  |Rollback Batch                              |
|Prepare File|${PathToBatch}||${prefix}||PREFIXPLACEHOLDER|

!| scenario       |Prepare File         |path    |    |changeFrom   |   |changeTo   |
|$res=            |RunBatchGetOutputFull|PrepareEthalons;@path;@changeFrom;@changeTo|
|Verify_Contain_OR|$res;;write.*changes                                             |

