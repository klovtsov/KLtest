!include -c <AutomatedTesting.CliScenarios
!include -c <AutomatedTesting.KnownIssues




!|scenario        |Check Manage Batches Report|batchName      |     |operationName     |
|clickAndWait     |link=Manage Batches                                                 |
|type;            |id=SubmitterNm             |${TPAMAdmin}                            |
|removeSelection; |id=BatchTypes              |label=All                               |
|addSelection;    |id=BatchTypes              |label=@operationName                    |
|click            |//select[@id='BatchTypes']/option[.='@operationName']               |
|click            |id=rb_FiltBatchStatusCompleted                                      |
|click            |id=rb_filterDt0                                                     |
|pause            |2000                                                                |
|click            |id=Listing                                                          |
|pause            |2000                                                                |
|$res=            |getText                    |//table[@id='BatchListing']//tr[1]/td[1]|
|Verify_Contain_OR|$res;;@operationName                                                |
|$res=            |getText                    |//table[@id='BatchListing']//tr[1]/td[2]|
|Verify_Contain_OR|$res;;@batchName                                                    |
|$res=            |getText                    |//table[@id='BatchListing']//tr[2]/td[3]|
|Verify_Contain_OR|$res;;${TPAMAdmin}                                                  |





!|scenario        |Check Batch Contents|Etalon                        |
|pause            |5000                                               |
|$res=            |compareDump         |@Etalon;;${ProjDir}\cliout.tmp|
|Verify_Contain_OR|$res;;are equal                                    |


!|scenario                           |Performance Test|fileExtension               |
|Login                               |${TPAMURL}      ||${TPAMAdmin}||${DefaultPwd}|
|$Extention=                         |getEval         |"@fileExtension"            |
|pause                               |15000                                        |
|Batch Import Systems for Performance|systems_import_headers_perf                  |
|Batch Delete Systems for Performance|systems_delete_headers_perf                  |
#|Check Batch Contents|${PathToEthalon}ethalon_accounts_import_headers.txt;;D:\Autotest\TPAM\cliout.tmp|

!|scenario                         |Test Advanced Batch File Setting       |
|Login                             |${TPAMURL}||${TPAMAdmin}||${DefaultPwd}|
|pause                             |10000                                  |
|Batch Import Systems Advanced 1   |systems_import_headers_skip_dollar_bar |
|Batch Import Systems Advanced 2   |systems_import_headers_limit_dollar_cr |
|Batch Import Accounts Advanced    |accounts_import_headers_percent_lf     |
|Batch Update PSM Accounts Advanced|accounts_psm_update_headers_tab_crlf   |
|Batch Import Users Advanced       |users_import_headers_limit_caret_cr    |
|Batch Update Users Advanced       |users_update_no_headers_limit_wave_lf  |
|Batch Delete Systems Advanced     |systems_delete_headers_ampersand_crlf  |




!|scenario                          |Test Batch Import and Update|fileExtension                       |
|$Extention=                        |getEval                     |"@fileExtension"                    |
|Login                              |${TPAMURL}                  ||${TPAMAdmin}||${DefaultPwd}        |
|pause                              |10000                                                            |
|Batch Import Groups                |groups_import_no_headers                                         |
|Batch Update Groups                |groups_update_headers                                            |
|Batch Import Collections           |collections_import_no_headers                                    |
|Batch Import Systems               |systems_import_headers                                           |
|Batch Import Systems               |systems_import_no_headers                                        |
|Batch Import Bad Systems           |systems_import_bad_columns_order                                 |
|Add File                           |klbatchsys1                                                      |
|Batch Update Systems               |systems_update_no_headers                                        |
|Check System                       |klbatchsys61                                                     |
|Batch Import Accounts              |accounts_import_headers                                          |
|Batch Update PSM Accounts          |accounts_psm_update_headers                                      |
|Batch Update PSM Accounts          |accounts_psm_update_no_headers                                   |
|Check PSM Account                  |klbatchacc                  ||klbatchsys61                       |
|Batch Update-Delete Systems        |systems_update_headers_part                                      |
|Batch Import Users                 |users_import_headers                                             |
|Batch Update Permissions           |permissions_update_no_headers_optional                           |
|Batch Update PSM Accounts          |accounts_psm_update_headers_null                                 |
|Batch Delete Permissions           |permissions_update_headers_optional                              |
|Batch Import Users                 |users_import_no_headers                                          |
|Batch Import Bad Users             |users_import_bad_data                                            |
|Check User                         |kluser1                                                          |
|Batch Delete Users                 |users_delete_no_headers                                          |
|Load Collection Membership         |collection_membership_load_headers                               |
|Check System Collection Membership |klbatchsys3                 ||kl_collection3                     |
|Check Account Collection Membership|klbatchsys2                 ||klbatchacc  ||kl_collection2       |
|Check File Collection Membership   |klbatchsys1                 ||klFile9     ||kl_collection1       |
|Load Group Membership              |group_membership_load_headers                                    |
|Check Group Membership             |kluser5                     ||kl_group1                          |
|Check Group Membership             |kluser5                     ||kl_group2                          |
|Batch Update Permissions           |permissions_update_headers                                       |
|Check Account Permissions          |klbatchsys20                ||klbatchacc  ||kluser6||PPM Reviewer|
|Batch Add Permissions              |permissions_update_no_headers                                    |
|Check System Permissions           |klbatchsys61                ||kluser1     ||PSM Privileged Access|
|Add Collection Membership          |collection_membership_load_no_headers                            |
|Check System Collection Membership |klbatchsys61                ||kl_collection1                     |
|Create Template from System        |klbatchsys61                                                     |
|Batch Import Systems from Template |systems_import_from_template_headers                             |
|Check System Permissions           |klbatchsys64                ||kluser1     ||PSM Privileged Access|
|Check System Collection Membership |klbatchsys64                ||kl_collection1                     |
|Delete Group Membership            |group_membership_load_no_headers                                 |
|Batch Import Bad Systems           |systems_import_from_bad_template_headers                         |
|Create Template from User          |kluser2                                                          |
|Batch Import Users                 |users_import_from_template_headers                               |
|Check Group Membership             |kluser35                    ||kl_group1                          |
|Check System Permissions           |klbatchsys11                ||kluser36    ||Approver-Requestor   |
|Batch Update Accounts              |accounts_update_no_headers                                       |
|Batch Import Systems from Template |systems_import_from_template_no_headers                          |
|Batch Update-Delete Systems        |systems_delete_headers_part                                      |
|Batch Import Bad Systems           |systems_import_bad_headers                                       |
|Batch Delete Accounts              |accounts_delete_headers                                          |
|Batch Import Users                 |users_import_from_template_no_headers                            |
|Batch Update-Delete Systems        |systems_delete_no_headers_part                                   |
|Batch Delete Systems               |systems_delete_headers                                           |
|Batch Delete Users                 |users_delete_headers                                             |
|Batch Update Users                 |users_update_no_headers                                          |
|Delete System Template             |klbatchsys61templ                                                |
|Delete User Template               |kluser2templ                                                     |
|Batch Delete Groups                |groups_delete_headers                                            |
|Batch Delete Collections           |collections_delete_headers                                       |



!|scenario                  |Prepare Environment    |
|Prepare User               |${TPAMAdmin}  | |Admin |
|Create Password Rule       |KL New PwRule          |
|Add Ticket System          |KL tickets             |
|Create Post-Session Profile|kl_post_session_profile|
|Create Connection Profile  |kl_connection_profile  |



!|scenario                  |Clear Environment      |
|Delete Password Rule       |KL New PwRule          |
|Delete Ticket System       |KL tickets             |
|Delete Post-Session Profile|kl_post_session_profile|
|Delete Connection Profile  |kl_connection_profile  |
|Remove User                |${TPAMAdmin}           |
|stop                                               |
|finalize                                           |



#|Login | ${TPAMAdmin} || ${DefaultPwd}|
#|Hard-Delete All         |

!|scenario            |Check System    |systemName                    |
|clickAndWait         |link=Manage Systems                            |
|type;                |id=SystemNm     |@systemName                   |
|click                |id=Listing                                     |
|waitForElementPresent|//td[contains(text(),'@systemName')]           |
|mouseDown            |//td[contains(text(),'@systemName')]           |
|click                |//td[contains(text(),'@systemName')]           |
|click                |id=Details                                     |
|waitForElementPresent|//input[@id='NetworkAddress']                  |
|$res=                |getValue        |//input[@id='NetworkAddress'] |
|Verify_Contain_OR    |$res;;192.168.99.61                            |
|$res=                |getSelectedLabel|id=PlatformID                 |
|Verify_Contain_OR    |$res;;Windows Active Dir                       |
|$res=                |getSelectedLabel|id=PwdRuleID                  |
|Verify_Contain_OR    |$res;;Default Password Rule                    |
|$res=                |getSelectedLabel|id=MaxDurationDays            |
|Verify_Contain_OR    |$res;;3                                        |
|$res=                |getSelectedLabel|id=MaxDurationHrs             |
|Verify_Contain_OR    |$res;;0                                        |
|$res=                |getSelectedLabel|id=MaxDurationQtrHrs          |
|Verify_Contain_OR    |$res;;0                                        |
|$res=                |isChecked       |id=cb_SystemAutoFl            |
|Verify_Contain_OR    |$res;;true                                     |
|$res=                |isChecked       |id=cb_EgpOnlyFl               |
|Verify_Contain_OR    |$res;;false                                    |
|$res=                |getValue        |//input[@id='EscalationTime'] |
|Verify_Contain_OR    |$res;;5                                        |
|$res=                |getValue        |//input[@id='EscalationEmail']|
|Verify_Contain_OR    |$res;;klsysesc5@tpam.spb.qsft                  |
|$res=                |getValue        |//input[@id='PrimaryEmail']   |
|Verify_Contain_OR    |$res;;klbatchsys61@tpam.spb.qsft               |
|$res=                |getValue        |//textarea[@id='Comment']     |
|Verify_Contain_OR    |$res;;desc5                                    |
|click                |id=Connection                                  |
|waitForElementPresent|id=cb_AllowFuncReqFl                           |
|$res=                |getValue        |//input[@id='DomainName']     |
|Verify_Contain_OR    |$res;;mydomain.mc.co                           |
|$res=                |getValue        |//input[@id='NetBiosName']    |
|Verify_Contain_OR    |$res;;MYDOMAIN                                 |
|$res=                |getValue        |//input[@id='Timeout']        |
|Verify_Contain_OR    |$res;;65                                       |
|$res=                |getValue        |//input[@id='PARFuncAcct']    |
|Verify_Contain_OR    |$res;;klbatchfcctacct7                         |
|$res=                |isChecked       |id=cb_NonPrivFuncFl           |
|Verify_Contain_OR    |$res;;true                                     |
|$res=                |isChecked       |id=cb_AllowFuncReqFl          |
|Verify_Contain_OR    |$res;;true                                     |
|click                |id=Management                                  |
|waitForElementPresent|id=cb_Push2AcctFl                              |
|$res=                |isChecked       |id=rb_ChkFl1                  |
|Verify_Contain_OR    |$res;;false                                    |
|$res=                |isChecked       |id=cb_ResetFl                 |
|Verify_Contain_OR    |$res;;true                                     |
|$res=                |isChecked       |id=cb_ReleaseChgFl            |
|Verify_Contain_OR    |$res;;true                                     |
|$res=                |isChecked       |id=rb_Opt0                    |
|Verify_Contain_OR    |$res;;true                                     |
|$res=                |isChecked       |id=rb_Opt1                    |
|Verify_Contain_OR    |$res;;false                                    |
|$res=                |isChecked       |id=rb_Opt2                    |
|Verify_Contain_OR    |$res;;false                                    |
|$res=                |isChecked       |id=rb_Opt3                    |
|Verify_Contain_OR    |$res;;false                                    |
|$res=                |getValue        |//input[@id='Hr']             |
|Verify_Contain_OR    |$res;;18                                       |
|$res=                |getValue        |//input[@id='Min']            |
|Verify_Contain_OR    |$res;;00                                       |
|$res=                |getSelectedLabel|id=DurationDays               |
|Verify_Contain_OR    |$res;;0                                        |
|$res=                |getSelectedLabel|id=DurationHrs                |
|Verify_Contain_OR    |$res;;3                                        |
|$res=                |getSelectedLabel|id=DurationQtrHrs             |
|Verify_Contain_OR    |$res;;0                                        |
|$res=                |isChecked       |id=cb_AllowISADuration        |
|Verify_Contain_OR    |$res;;true                                     |
|$res=                |isChecked       |id=cb_PushAuto2AcctFl         |
|Verify_Contain_OR    |$res;;false                                    |
|$res=                |isChecked       |id=cb_Push2AcctFl             |
|Verify_Contain_OR    |$res;;false                                    |
|click                |id=TicketSystem                                |
|$res=                |isChecked       |id=cb_ReqTixOverall           |
|Verify_Contain_OR    |$res;;false                                    |
|$res=                |getSelectedLabel|id=TixSystem                  |
|Verify_Contain_OR    |$res;;Any Ticket System                        |
|$res=                |isChecked       |id=cb_ReqTixISA               |
|Verify_Contain_OR    |$res;;false                                    |
|$res=                |isChecked       |id=cb_ReqTixCLI               |
|Verify_Contain_OR    |$res;;false                                    |
|$res=                |isChecked       |id=cb_ReqTixAPI               |
|Verify_Contain_OR    |$res;;false                                    |
#|$res=                |getValue        |//input[@id='TixEmailNotify'] |
#|Verify_Contain_OR    |$res;;klticket5@tpam.spb.qsft                  |


!|scenario            |Check PSM Account                    |accountName     |     |systemName     |
|clickAndWait         |link=Manage Accounts                                                        |
|type;                |id=SystemNm                          |@systemName                           |
|type;                |id=AccountNm                         |@accountName                          |
|click                |id=Listing                           |                                      |
|waitForElementPresent|//td[contains(text(),'@accountName')]|                                      |
|mouseDown            |//td[contains(text(),'@accountName')]|                                      |
|click                |//td[contains(text(),'@accountName')]|                                      |
|click                |id=Details                           |                                      |
|waitForElementPresent|//input[@id='RelNotifyEmail']                                               |
|$res=                |isChecked                            |id=cb_AcctLockFl                      |
|Verify_Contain_OR    |$res;;false                                                                 |
|$res=                |getSelectedLabel                     |id=PwdRule                            |
|Verify_Contain_OR    |$res;;Default Password Rule                                                 |
|$res=                |isChecked                            |id=cb_ChgSvc                          |
|Verify_Contain_OR    |$res;;false                                                                 |
|$res=                |isChecked                            |id=cb_UseSelf                         |
|Verify_Contain_OR    |$res;;false                                                                 |
|$res=                |getValue                             |//textarea[@id='AcctDesc']            |
|Verify_Contain_OR    |$res;;desc                                                                  |
|$res=                |isChecked                            |id=pwdMgmtNone                        |
|Verify_Contain_OR    |$res;;false                                                                 |
|$res=                |isChecked                            |id=pwdMgmtAuto                        |
|Verify_Contain_OR    |$res;;true                                                                  |
|$res=                |isChecked                            |id=pwdMgmtManual                      |
|Verify_Contain_OR    |$res;;false                                                                 |
|$res=                |getValue                             |//input[@id='MinApprovers']           |
|Verify_Contain_OR    |$res;;2                                                                     |
|$res=                |getValue                             |//input[@id='RelNotifyEmail']         |
|Verify_Contain_OR    |$res;;kltest@tpam.spb.qsft                                                  |
|$res=                |getSelectedLabel                     |id=MaxDurationDays                    |
|Verify_Contain_OR    |$res;;6                                                                     |
|$res=                |getSelectedLabel                     |id=MaxDurationHrs                     |
|Verify_Contain_OR    |$res;;20                                                                    |
|$res=                |getSelectedLabel                     |id=MaxDurationQtrHrs                  |
|Verify_Contain_OR    |$res;;0                                                                     |
|$res=                |getValue                             |//input[@id='SimulPrivAccReleases']   |
|Verify_Contain_OR    |$res;;1                                                                     |
|$res=                |isChecked                            |id=cb_OverrideAccountabilityFl        |
|Verify_Contain_OR    |$res;;false                                                                 |
|click                |id=Reviews                           |                                      |
|waitForElementPresent|//input[@id='PwdEscalationEmail']                                           |
|$res=                |getValue                             |//input[@id='PwdReviewCnt']           |
|Verify_Contain_OR    |$res;;1                                                                     |
|$res=                |isChecked                            |id=PwdReviewerType0                   |
|Verify_Contain_OR    |$res;;true                                                                  |
|$res=                |isChecked                            |id=PwdReviewerType1                   |
|Verify_Contain_OR    |$res;;false                                                                 |
|$res=                |isChecked                            |id=PwdReviewerType2                   |
|Verify_Contain_OR    |$res;;false                                                                 |
|$res=                |isChecked                            |id=PwdReviewerType3                   |
|Verify_Contain_OR    |$res;;false                                                                 |
|$res=                |getValue                             |//input[@id='PwdEscalationTime']      |
|Verify_Contain_OR    |$res;;5                                                                     |
|$res=                |getValue                             |//input[@id='PwdEscalationEmail']     |
|Verify_Contain_OR    |$res;;klescalate@tpam.spb.qsft                                              |
|click                |id=Management                                                               |
|waitForElementPresent|id=cb_PullFromParentFl                                                      |
|$res=                |isChecked                            |id=rb_ChkFl1                          |
|Verify_Contain_OR    |$res;;false                                                                 |
|$res=                |isChecked                            |id=cb_ResetFl                         |
|Verify_Contain_OR    |$res;;true                                                                  |
|$res=                |isChecked                            |id=cb_ReleaseChgFl                    |
|Verify_Contain_OR    |$res;;true                                                                  |
|$res=                |isChecked                            |id=rb_Opt0                            |
|Verify_Contain_OR    |$res;;true                                                                  |
|$res=                |isChecked                            |id=rb_Opt1                            |
|Verify_Contain_OR    |$res;;false                                                                 |
|$res=                |isChecked                            |id=rb_Opt2                            |
|Verify_Contain_OR    |$res;;false                                                                 |
|$res=                |isChecked                            |id=rb_Opt3                            |
|Verify_Contain_OR    |$res;;false                                                                 |
|$res=                |getValue                             |//input[@id='Hr']                     |
|Verify_Contain_OR    |$res;;03                                                                    |
|$res=                |getValue                             |//input[@id='Min']                    |
|Verify_Contain_OR    |$res;;00                                                                    |
|$res=                |getSelectedLabel                     |id=DurationDays                       |
|Verify_Contain_OR    |$res;;0                                                                     |
|$res=                |getSelectedLabel                     |id=DurationHrs                        |
|Verify_Contain_OR    |$res;;4                                                                     |
|$res=                |getSelectedLabel                     |id=DurationQtrHrs                     |
|Verify_Contain_OR    |$res;;0                                                                     |
|$res=                |isChecked                            |id=cb_AllowISADuration                |
|Verify_Contain_OR    |$res;;false                                                                 |
|click                |id=TicketSystem                                                             |
|$res=                |isChecked                            |id=cb_ReqTixOverall                   |
|Verify_Contain_OR    |$res;;false                                                                 |
|$res=                |getSelectedLabel                     |id=TixSystem                          |
|Verify_Contain_OR    |$res;;Any Ticket System                                                     |
|$res=                |isChecked                            |id=cb_ReqTixISA                       |
|Verify_Contain_OR    |$res;;false                                                                 |
|$res=                |isChecked                            |id=cb_ReqTixCLI                       |
|Verify_Contain_OR    |$res;;false                                                                 |
|$res=                |isChecked                            |id=cb_ReqTixAPI                       |
|Verify_Contain_OR    |$res;;false                                                                 |
|click                |id=PSMDetails                                                               |
|waitForElementPresent|//input[@id='SessionStartNotifyEmail']                                      |
|$res=                |isChecked                            |id=cb_EnableFl                        |
|Verify_Contain_OR    |$res;;true                                                                  |
|$res=                |getSelectedLabel                     |id=ProxyType                          |
|Verify_Contain_OR    |$res;;RDP - Automatic Login Using Password                                  |
|$res=                |getSelectedLabel                     |id=ConnectProfileID                   |
|Verify_Contain_OR    |$res;;kl_connection_profile                                                 |
|$res=                |getSelectedLabel                     |id=PostSessionProfileID               |
|Verify_Contain_OR    |$res;;kl_post_session_profile                                               |
|$res=                |getSelectedLabel                     |id=ColorDepth                         |
|Verify_Contain_OR    |$res;;8                                                                     |
|$res=                |getValue                             |//input[@id='EgpMinApprovers']        |
|Verify_Contain_OR    |$res;;1                                                                     |
|$res=                |getValue                             |//input[@id='MaxSessionCnt']          |
|Verify_Contain_OR    |$res;;2                                                                     |
|$res=                |getSelectedLabel                     |id=EgpDurationDays                    |
|Verify_Contain_OR    |$res;;0                                                                     |
|$res=                |getSelectedLabel                     |id=EgpDurationHrs                     |
|Verify_Contain_OR    |$res;;2                                                                     |
|$res=                |getSelectedLabel                     |id=EgpDurationQtrHrs                  |
|Verify_Contain_OR    |$res;;0                                                                     |
|$res=                |getValue                             |//input[@id='NotifyFreq']             |
|Verify_Contain_OR    |$res;;0                                                                     |
|$res=                |getValue                             |//input[@id='NotifyThresh']           |
|Verify_Contain_OR    |$res;;0                                                                     |
|$res=                |getValue                             |//input[@id='SessionStartNotifyEmail']|
|Verify_Contain_OR    |$res;;klsessstart@tpam.spb.qsft                                             |
|$res=                |isChecked                            |id=cb_ClipboardFl                     |
|Verify_Contain_OR    |$res;;true                                                                  |
|$res=                |isChecked                            |id=cb_ConsoleFl                       |
|Verify_Contain_OR    |$res;;false                                                                 |
|$res=                |isChecked                            |id=cb_RecordingRequiredFl             |
|Verify_Contain_OR    |$res;;true                                                                  |
|$res=                |isChecked                            |id=cb_FileTransUpFl                   |
|Verify_Contain_OR    |$res;;true                                                                  |
|$res=                |isChecked                            |id=cb_FileTransDownFl                 |
|Verify_Contain_OR    |$res;;true                                                                  |
|click                |id=SessionAuthentication                                                    |
|waitForElementPresent|id=PassMeth0                                                                |
|$res=                |isChecked                            |id=PassMeth0                          |
|Verify_Contain_OR    |$res;;true                                                                  |
|$res=                |isChecked                            |id=PassMeth1                          |
|Verify_Contain_OR    |$res;;false                                                                 |
|click                |id=FileTransfer                                                             |
|waitForElementPresent|id=FileTransTypeID                                                          |
|$res=                |getSelectedLabel                     |id=FileTransTypeID                    |
|Verify_Contain_OR    |$res;;Windows File Copy                                                     |
|$res=                |getValue                             |//input[@id='FileTransPath']          |
|Verify_Contain_OR    |$res;;myshare                                                               |
|$res=                |isChecked                            |id=FileTransAuthMeth0                 |
|Verify_Contain_OR    |$res;;true                                                                  |
|$res=                |isChecked                            |id=FileTransAuthMeth1                 |
|Verify_Contain_OR    |$res;;false                                                                 |
|click                |id=ReviewRequirements                                                       |
|waitForElementPresent|//input[@id='EscalationEmail']                                              |
|$res=                |getValue                             |//input[@id='ReviewCnt']              |
|Verify_Contain_OR    |$res;;1                                                                     |
|$res=                |isChecked                            |id=ReviewerType0                      |
|Verify_Contain_OR    |$res;;false                                                                 |
|$res=                |isChecked                            |id=ReviewerType1                      |
|Verify_Contain_OR    |$res;;true                                                                  |
|$res=                |isChecked                            |id=ReviewerType2                      |
|Verify_Contain_OR    |$res;;false                                                                 |
|$res=                |isChecked                            |id=ReviewerType3                      |
|Verify_Contain_OR    |$res;;false                                                                 |
|$res=                |getValue                             |//input[@id='EscalationTime']         |
|Verify_Contain_OR    |$res;;1                                                                     |
|$res=                |getValue                             |//input[@id='EscalationEmail']        |
|Verify_Contain_OR    |$res;;klsessrevesc@tpam.spb.qsft                                            |




!|scenario            |Check System Collection Membership|systemName||collectionName|
|clickAndWait         |link=Manage Systems                                          |
|type;                |id=SystemNm                       |@systemName               |
|click                |id=Listing                                                   |
|waitForElementPresent|//td[contains(text(),'@systemName')]                         |
|mouseDown            |//td[contains(text(),'@systemName')]                         |
|click                |//td[contains(text(),'@systemName')]                         |
|click                |id=Collections                                               |
|waitForElementPresent|id=cb_acmAssigned                                            |
|click                |id=cb_acmAssigned                                            |
|click                |//div[@id='collectionTabs']/ul/li[2]/a                       |
|waitForElementPresent|//div[@id='collTableDiv']                                    |
|$res=                |getText                           |//div[@id='collTableDiv'] |
|Verify_Contain_OR    |$res;;@collectionName                                        |



!|scenario            |Check Account Collection Membership  |systemName||accountName||collectionName|
|clickAndWait         |link=Manage Accounts                                                         |
|type;                |id=SystemNm                          |@systemName                            |
|type;                |id=AccountNm                         |@accountName                           |
|click                |id=Listing                           |                                       |
|waitForElementPresent|//td[contains(text(),'@accountName')]|                                       |
|mouseDown            |//td[contains(text(),'@accountName')]|                                       |
|click                |//td[contains(text(),'@accountName')]|                                       |
|click                |id=Collections                                                               |
|waitForElementPresent|id=cb_acmAssigned                                                            |
|click                |id=cb_acmAssigned                                                            |
|click                |//div[@id='collectionTabs']/ul/li[2]/a                                       |
|waitForElementPresent|//div[@id='collTableDiv']                                                    |
|$res=                |getText                              |//div[@id='collTableDiv']              |
|Verify_Contain_OR    |$res;;@collectionName                                                        |



!|scenario            |Check File Collection Membership  |systemName||fileName||collectionName|
|clickAndWait         |link=Manage Files                                                      |
|type;                |id=SystemNm                       |@systemName                         |
|type;                |id=FileNm                         |@fileName                           |
|click                |id=Listing                        |                                    |
|waitForElementPresent|//td[contains(text(),'@fileName')]|                                    |
|mouseDown            |//td[contains(text(),'@fileName')]|                                    |
|click                |//td[contains(text(),'@fileName')]|                                    |
|pause                |1000                                                                   |
|click                |id=Collections                                                         |
|waitForElementPresent|id=cb_acmAssigned                                                      |
|click                |id=cb_acmAssigned                                                      |
|pause                |1000                                                                   |
|click                |//div[@id='collectionTabs']/ul/li[2]/a                                 |
|waitForElementPresent|//div[@id='collTableDiv']                                              |
|$res=                |getText                           |//div[@id='collTableDiv']           |
|Verify_Contain_OR    |$res;;@collectionName                                                  |


!|scenario            |Check Group Membership|userName          |          |groupName          |
|clickAndWait         |link=Manage UserIDs                                                     |
|waitForElementPresent|id=UsrNm                                                                |
|type;                |id=UsrNm              |@userName                                        |
|click                |id=Listing                                                              |
|waitForElementPresent|//td[contains(text(),'@userName')]                                      |
|mouseDown            |//td[contains(text(),'@userName')]                                      |
|click                |//td[contains(text(),'@userName')]                                      |
|click                |id=GroupMembership                                                      |
|waitForElementPresent|id=cb_Assigned                                                          |
|click                |id=cb_Assigned                                                          |
|click                |id=Results                                                              |
|waitForElementPresent|//div[@id='membershipList']/table/tbody/tr/td/div                       |
|$res=                |getText               |//div[@id='membershipList']/table/tbody/tr/td/div|
|Verify_Contain_OR    |$res;;@groupName                                                        |

!|scenario            |Check Group Exists|groupName                                                     |
|clickAndWait         |link=Manage Groups                                                               |
|waitForElementPresent|id=GroupNm                                                                       |
|type;                |id=GroupNm        |@groupName                                                    |
|click                |id=Listing                                                                       |
|waitForElementPresent|//div[@id='reportTab']/table/tbody/tr/td/table/tbody/tr/td/div                   |
|$res=                |getText           |//div[@id='reportTab']/table/tbody/tr/td/table/tbody/tr/td/div|
|Verify_Contain_OR    |$res;;@groupName                                                                 |

!|scenario            |Check Group Description|groupName              |             |description             |
|clickAndWait         |link=Manage Groups                                                                    |
|waitForElementPresent|id=GroupNm                                                                            |
|type;                |id=GroupNm             |@groupName                                                    |
|click                |id=Listing                                                                            |
|waitForElementPresent|//div[@id='reportTab']/table/tbody/tr/td/table/tbody/tr/td/div                        |
|$res=                |getText                |//div[@id='reportTab']/table/tbody/tr/td/table/tbody/tr/td/div|
|Verify_Contain_OR    |$res;;@description                                                                    |

!|scenario            |Check Group Does Not Exist|groupName                                                     |
|clickAndWait         |link=Manage Groups                                                                       |
|waitForElementPresent|id=GroupNm                                                                               |
|type;                |id=GroupNm                |@groupName                                                    |
|click                |id=Listing                                                                               |
|waitForElementPresent|//div[@id='reportTab']/table/tbody/tr/td/table/tbody/tr/td/div                           |
|$res=                |getText                   |//div[@id='reportTab']/table/tbody/tr/td/table/tbody/tr/td/div|
|Verify_Contain_NOT   |$res;;@groupName                                                                         |

!|scenario            |Check Collection Exists|collectionName                                  |
|clickAndWait         |link=Manage Collections                                                 |
|waitForElementPresent|id=CollectionNm                                                         |
|type;                |id=CollectionNm        |@collectionName                                 |
|click                |id=Listing                                                              |
|waitForElementPresent|//div[@id='reportTab']/div/table/tbody/tr/td/div                        |
|$res=                |getText                |//div[@id='reportTab']/div/table/tbody/tr/td/div|
|Verify_Contain_OR    |$res;;@collectionName                                                   |

!|scenario            |Check Collection Does Not Exist|collectionName                                  |
|clickAndWait         |link=Manage Collections                                                         |
|waitForElementPresent|id=CollectionNm                                                                 |
|type;                |id=CollectionNm                |@collectionName                                 |
|click                |id=Listing                                                                      |
|waitForElementPresent|//div[@id='reportTab']/div/table/tbody/tr/td/div                                |
|$res=                |getText                        |//div[@id='reportTab']/div/table/tbody/tr/td/div|
|Verify_Contain_NOT   |$res;;@collectionName                                                           |





!|scenario              |Check Account Permissions            |systemName||accountName||userName||permission|
|clickAndWait           |link=Manage Accounts                                                               |
|type;                  |id=SystemNm                          |@systemName                                  |
|type;                  |id=AccountNm                         |@accountName                                 |
|click                  |id=Listing                           |                                             |
|waitForElementPresent  |//td[contains(text(),'@accountName')]|                                             |
|mouseDown              |//td[contains(text(),'@accountName')]|                                             |
|click                  |//td[contains(text(),'@accountName')]|                                             |
|click                  |id=Permissions                                                                     |
|waitForElementPresent  |id=cbxNotAssigned                                                                  |
|click                  |id=cbxNotAssigned                                                                  |
|click                  |//div[@id='permissionTabs']/ul/li[2]/a                                             |
|waitForElementPresent  |//div[@id='collTableDiv']                                                          |
|$res=                  |getText                              |//div[@id='permTableDiv']                    |
|Verify_Contain_OR_alnum|$res;;@userName (Doe, John) @permission                                            |


!|scenario              |Check System Permissions            |systemName||userName||permission|
|clickAndWait           |link=Manage Systems                                                  |
|type;                  |id=SystemNm                         |@systemName                     |
|click                  |id=Listing                          |                                |
|waitForElementPresent  |//td[contains(text(),'@systemName')]|                                |
|mouseDown              |//td[contains(text(),'@systemName')]|                                |
|click                  |//td[contains(text(),'@systemName')]|                                |
|click                  |id=Permissions                                                       |
|waitForElementPresent  |id=cbxNotAssigned                                                    |
|click                  |id=cbxNotAssigned                                                    |
|click                  |//div[@id='permissionTabs']/ul/li[2]/a                               |
|waitForElementPresent  |//div[@id='collTableDiv']                                            |
|$res=                  |getText                             |//div[@id='permTableDiv']       |
|Verify_Contain_OR_alnum|$res;;@userName (Doe, John) @permission                              |




!|scenario            |Check User      |userName                 |
|clickAndWait         |link=Manage UserIDs                       |
|waitForElementPresent|id=UsrNm                                  |
|type;                |id=UsrNm        |@userName                |
|click                |id=Listing                                |
|waitForElementPresent|//td[contains(text(),'@userName')]        |
|mouseDown            |//td[contains(text(),'@userName')]        |
|click                |//td[contains(text(),'@userName')]        |
|click                |id=Details      |                         |
|waitForElementPresent|id=cbxMobile                              |
|pause                |5000                                      |
|$res=                |isChecked       |id=Disabled              |
|Verify_Contain_OR    |$res;;false                               |
|$res=                |getValue        |//input[@id='LastName']  |
|Verify_Contain_OR    |$res;;Doe                                 |
|$res=                |getValue        |//input[@id='FirstName'] |
|Verify_Contain_OR    |$res;;John                                |
|$res=                |getValue        |//input[@id='Phone']     |
|Verify_Contain_OR    |$res;;111                                 |
|$res=                |getValue        |//input[@id='Pager']     |
|Verify_Contain_OR    |$res;;222                                 |
|$res=                |getValue        |//input[@id='EmailID']   |
|Verify_Contain_OR    |$res;;kluser@tpam.spb.qsft                |
|$res=                |getValue        |//textarea[@id='Comment']|
|Verify_Contain_OR    |$res;;desc                                |
|$res=                |getSelectedLabel|id=UType                 |
|Verify_Contain_OR    |$res;;Basic                               |
|$res=                |isChecked       |id=cb_WebAccess          |
|Verify_Contain_OR    |$res;;true                                |
|$res=                |isChecked       |id=cbxMobile             |
|Verify_Contain_OR    |$res;;false                               |
|$res=                |getSelectedLabel|id=PrimAuthType          |
|Verify_Contain_OR    |$res;;Local                               |
|$res=                |getSelectedLabel|id=ExtAuthType           |
|Verify_Contain_OR    |$res;;None                                |



!|scenario                  |Batch Import Groups               |filename                    |
|clickAndWait               |link=Import/Update Groups         |                            |
|pause                      |2000                                                           |
|click                      |id=PAMUploadBtnSelect                                          |
|SWait                      |browse.PNG                                                     |
|SClick                     |browse.PNG                                                     |
|pause                      |1500                                                           |
|SType                      |${PathToBatch}@filename.$Extention                             |
|pause                      |1500                                                           |
|SWait                      |open.PNG                                                       |
|SClick                     |open.PNG                                                       |
|pause                      |2000                                                           |
|SWait                      |upload_small.PNG                                               |
|SClick                     |upload_small.PNG                                               |
|pause                      |2000                                                           |
|type;                      |id=Comment2                       |import groups               |
|click                      |id=btnProcessFile                 |                            |
|pause                      |1500                                                           |
|waitForElementPresent      |//tr[@id='7']                                                  |
|pause                      |10000                                                          |
|verifyText                 |//div[@id='divBatchResults']/table||Adding the following groups|
|Check Group Exists         |kl_group1                                                      |
|Check Group Exists         |kl_group2                                                      |
|Check Group Exists         |kl_group3                                                      |
|Check Manage Batches Report|@filename                         ||Update Groups              |


!|scenario                  |Batch Delete Groups               |filename                      |
|clickAndWait               |link=Import/Update Groups         |                              |
|pause                      |2000                                                             |
|click                      |id=PAMUploadBtnSelect                                            |
|SWait                      |browse.PNG                                                       |
|SClick                     |browse.PNG                                                       |
|pause                      |1500                                                             |
|SType                      |${PathToBatch}@filename.$Extention                               |
|pause                      |1500                                                             |
|SWait                      |open.PNG                                                         |
|SClick                     |open.PNG                                                         |
|pause                      |2000                                                             |
|SWait                      |upload_small.PNG                                                 |
|SClick                     |upload_small.PNG                                                 |
|pause                      |2000                                                             |
|type;                      |id=Comment2                       |import groups                 |
|click                      |id=Radio2                         |                              |
|click                      |id=btnProcessFile                 |                              |
|pause                      |1500                                                             |
|waitForElementPresent      |//tr[@id='6']                                                    |
|pause                      |10000                                                            |
|verifyText                 |//div[@id='divBatchResults']/table||Deleting the following groups|
|Check Group Does Not Exist |kl_group1                                                        |
|Check Group Does Not Exist |kl_group2                                                        |
|Check Group Does Not Exist |kl_group3                                                        |
|Check Manage Batches Report|@filename                         ||Update Groups                |



!|scenario                  |Batch Update Groups               |filename                      |
|clickAndWait               |link=Import/Update Groups         |                              |
|pause                      |2000                                                             |
|click                      |id=PAMUploadBtnSelect                                            |
|SWait                      |browse.PNG                                                       |
|SClick                     |browse.PNG                                                       |
|pause                      |1500                                                             |
|SType                      |${PathToBatch}@filename.$Extention                               |
|pause                      |1500                                                             |
|SWait                      |open.PNG                                                         |
|SClick                     |open.PNG                                                         |
|pause                      |2000                                                             |
|SWait                      |upload_small.PNG                                                 |
|SClick                     |upload_small.PNG                                                 |
|pause                      |2000                                                             |
|type;                      |id=Comment2                       |import groups                 |
|click                      |id=Radio3                         |                              |
|click                      |id=btnProcessFile                 |                              |
|pause                      |1500                                                             |
|waitForElementPresent      |//tr[@id='6']                                                    |
|pause                      |10000                                                            |
|verifyText                 |//div[@id='divBatchResults']/table||Updating the following groups|
|Check Group Description    |kl_group1                         ||New TPAM Test Group          |
|Check Group Description    |kl_group2                         ||New TPAM Test Group          |
|Check Group Description    |kl_group3                         ||New TPAM Test Group          |
|Check Manage Batches Report|@filename                         ||Update Groups                |


!|scenario                  |Batch Import Collections          |filename                         |
|clickAndWait               |link=Import/Update Collections    |                                 |
|pause                      |2000                                                                |
|click                      |id=PAMUploadBtnSelect                                               |
|SWait                      |browse.PNG                                                          |
|SClick                     |browse.PNG                                                          |
|pause                      |1500                                                                |
|SType                      |${PathToBatch}@filename.$Extention                                  |
|pause                      |1500                                                                |
|SWait                      |open.PNG                                                            |
|SClick                     |open.PNG                                                            |
|pause                      |2000                                                                |
|SWait                      |upload_small.PNG                                                    |
|SClick                     |upload_small.PNG                                                    |
|pause                      |2000                                                                |
|type;                      |id=Comment2                       |import collections               |
|click                      |id=btnProcessFile                 |                                 |
|pause                      |1500                                                                |
|waitForElementPresent      |//tr[@id='6']                                                       |
|pause                      |10000                                                               |
|verifyText                 |//div[@id='divBatchResults']/table||Adding the following collections|
|Check Collection Exists    |kl_collection1                                                      |
|Check Collection Exists    |kl_collection2                                                      |
|Check Collection Exists    |kl_collection3                                                      |
|Check Manage Batches Report|@filename                         ||Update Collections              |



!|scenario                      |Batch Delete Collections          |filename                           |
|clickAndWait                   |link=Import/Update Collections    |                                   |
|pause                          |2000                                                                  |
|click                          |id=PAMUploadBtnSelect                                                 |
|SWait                          |browse.PNG                                                            |
|SClick                         |browse.PNG                                                            |
|pause                          |1500                                                                  |
|SType                          |${PathToBatch}@filename.$Extention                                    |
|pause                          |1500                                                                  |
|SWait                          |open.PNG                                                              |
|SClick                         |open.PNG                                                              |
|pause                          |2000                                                                  |
|SWait                          |upload_small.PNG                                                      |
|SClick                         |upload_small.PNG                                                      |
|pause                          |2000                                                                  |
|click                          |id=Radio2                         |                                   |
|type;                          |id=Comment2                       |delete collections                 |
|click                          |id=btnProcessFile                 |                                   |
|pause                          |1500                                                                  |
|waitForElementPresent          |//tr[@id='6']                                                         |
|pause                          |10000                                                                 |
|verifyText                     |//div[@id='divBatchResults']/table||Deleting the following collections|
|Check Collection Does Not Exist|kl_collection1                                                        |
|Check Collection Does Not Exist|kl_collection2                                                        |
|Check Collection Does Not Exist|kl_collection3                                                        |
|Check Manage Batches Report    |@filename                         ||Update Collections                |



!|scenario                  |Batch Import Systems               |filename                        |
|clickAndWait               |link=Import Systems                |                                |
|pause                      |2000                                                                |
|click                      |id=PAMUploadBtnSelect                                               |
|SWait                      |browse.PNG                                                          |
|SClick                     |browse.PNG                                                          |
|pause                      |1500                                                                |
|SType                      |${PathToBatch}@filename.$Extention                                  |
|pause                      |1500                                                                |
|SWait                      |open.PNG                                                            |
|SClick                     |open.PNG                                                            |
|pause                      |2000                                                                |
|SWait                      |upload_small.PNG                                                    |
|SClick                     |upload_small.PNG                                                    |
|pause                      |2000                                                                |
|type;                      |id=Comment2                        |import systems                  |
|click                      |id=btnProcessFile                  |                                |
|pause                      |1500                                                                |
|waitForElementPresent      |//tr[@id='10']                                                      |
|pause                      |60000                                                               |
|verifyText                 |//div[@id='divBatchResults']/table/||Systems were successfully added|
|List Systems                                                                                    |
|Check Batch Contents       |${PathToEthalon}ethalon_@filename.txt                               |
|Check Manage Batches Report|@filename                          ||Import Systems                 |



!|scenario                  |Batch Import Bad Systems          |filename              |
|clickAndWait               |link=Import Systems               |                      |
|pause                      |2000                                                     |
|click                      |id=PAMUploadBtnSelect                                    |
|SWait                      |browse.PNG                                               |
|SClick                     |browse.PNG                                               |
|pause                      |1500                                                     |
|SType                      |${PathToBatch}@filename.$Extention                       |
|pause                      |1500                                                     |
|SWait                      |open.PNG                                                 |
|SClick                     |open.PNG                                                 |
|pause                      |2000                                                     |
|SWait                      |upload_small.PNG                                         |
|SClick                     |upload_small.PNG                                         |
|pause                      |2000                                                     |
|type;                      |id=Comment2                       |import systems        |
|click                      |id=btnProcessFile                 |                      |
|pause                      |1500                                                     |
|waitForElementPresent      |//tr[@id='3']                                            |
|pause                      |20000                                                    |
|verifyText                 |//div[@id='divBatchResults']/table||No new systems to add|
|List Systems                                                                         |
|Check Batch Contents       |${PathToEthalon}ethalon_@filename.txt                    |
|Check Manage Batches Report|@filename                         ||Import Systems       |


!|scenario                  |Batch Import Systems from Template|filename                        |
|clickAndWait               |link=Import Systems               |                                |
|pause                      |2000                                                               |
|click                      |id=PAMUploadBtnSelect                                              |
|SWait                      |browse.PNG                                                         |
|SClick                     |browse.PNG                                                         |
|pause                      |1500                                                               |
|SType                      |${PathToBatch}@filename.$Extention                                 |
|pause                      |1500                                                               |
|SWait                      |open.PNG                                                           |
|SClick                     |open.PNG                                                           |
|pause                      |2000                                                               |
|SWait                      |upload_small.PNG                                                   |
|SClick                     |upload_small.PNG                                                   |
|pause                      |2000                                                               |
|type;                      |id=Comment2                       |import systems                  |
|click                      |id=btnProcessFile                 |                                |
|pause                      |1500                                                               |
|waitForElementPresent      |//tr[@id='3']                                                      |
|pause                      |20000                                                              |
|verifyText                 |//div[@id='divBatchResults']/table||Systems were successfully added|
|List Systems                                                                                   |
|Check Batch Contents       |${PathToEthalon}ethalon_@filename.txt                              |
|Check Manage Batches Report|@filename                         ||Import Systems                 |


!|scenario                  |Batch Delete Systems              |filename                      |
|clickAndWait               |link=Update Systems               |                              |
|pause                      |2000                                                             |
|click                      |id=PAMUploadBtnSelect                                            |
|SWait                      |browse.PNG                                                       |
|SClick                     |browse.PNG                                                       |
|pause                      |1500                                                             |
|SType                      |${PathToBatch}@filename.$Extention                               |
|pause                      |1500                                                             |
|SWait                      |open.PNG                                                         |
|SClick                     |open.PNG                                                         |
|pause                      |2000                                                             |
|SWait                      |upload_small.PNG                                                 |
|SClick                     |upload_small.PNG                                                 |
|pause                      |2000                                                             |
|click                      |id=Radio1                         |                              |
|type;                      |id=Comment2                       |delete systems                |
|click                      |id=btnProcessFile                 |                              |
|pause                      |1500                                                             |
|waitForElementPresent      |//tr[@id='50']                                                   |
|pause                      |40000                                                            |
|verifyText                 |//div[@id='divBatchResults']/table||Deleted the following systems|
|Hard-Delete All                                                                              |
|List Systems                                                                                 |
|Check Batch Contents       |${PathToEthalon}ethalon_@filename.txt                            |
|Check Manage Batches Report|@filename                         ||Update Systems               |




!|scenario                  |Batch Update Systems              |filename       |
|clickAndWait               |link=Update Systems               |               |
|pause                      |2000                                              |
|click                      |id=PAMUploadBtnSelect                             |
|SWait                      |browse.PNG                                        |
|SClick                     |browse.PNG                                        |
|pause                      |1500                                              |
|SType                      |${PathToBatch}@filename.$Extention                |
|pause                      |1500                                              |
|SWait                      |open.PNG                                          |
|SClick                     |open.PNG                                          |
|pause                      |2000                                              |
|SWait                      |upload_small.PNG                                  |
|SClick                     |upload_small.PNG                                  |
|pause                      |2000                                              |
|click                      |id=Radio2                         |               |
|type;                      |id=Comment2                       |update systems |
|click                      |id=btnProcessFile                 |               |
|pause                      |1500                                              |
|waitForElementPresent      |//tr[@id='62']                                    |
|pause                      |15000                                             |
|verifyText                 |//div[@id='divBatchResults']/table||successfully  |
|List Systems                                                                  |
|Check Batch Contents       |${PathToEthalon}ethalon_@filename.txt             |
|Check Manage Batches Report|@filename                         ||Update Systems|


!|scenario                  |Batch Update-Delete Systems       |filename                |
|clickAndWait               |link=Update Systems               |                        |
|pause                      |2000                                                       |
|click                      |id=PAMUploadBtnSelect                                      |
|SWait                      |browse.PNG                                                 |
|SClick                     |browse.PNG                                                 |
|pause                      |1500                                                       |
|SType                      |${PathToBatch}@filename.$Extention                         |
|pause                      |1500                                                       |
|SWait                      |open.PNG                                                   |
|SClick                     |open.PNG                                                   |
|pause                      |2000                                                       |
|SWait                      |upload_small.PNG                                           |
|SClick                     |upload_small.PNG                                           |
|pause                      |2000                                                       |
|type;                      |id=Comment2                       |update or delete systems|
|click                      |id=btnProcessFile                 |                        |
|pause                      |1500                                                       |
|waitForElementPresent      |//tr[@id='4']                                              |
|pause                      |20000                                                      |
|verifyText                 |//div[@id='divBatchResults']/table|     |following         |
|List Systems                                                                           |
|Check Batch Contents       |${PathToEthalon}ethalon_@filename.txt                      |
|Check Manage Batches Report|@filename                         |     |Update Systems    |


!|scenario                  |Batch Import Accounts             |filename                         |
|clickAndWait               |link=Import Accounts              |                                 |
|pause                      |2000                                                                |
|click                      |id=PAMUploadBtnSelect                                               |
|SWait                      |browse.PNG                                                          |
|SClick                     |browse.PNG                                                          |
|pause                      |1500                                                                |
|SType                      |${PathToBatch}@filename.$Extention                                  |
|pause                      |1500                                                                |
|SWait                      |open.PNG                                                            |
|SClick                     |open.PNG                                                            |
|pause                      |2000                                                                |
|SWait                      |upload_small.PNG                                                    |
|SClick                     |upload_small.PNG                                                    |
|pause                      |2000                                                                |
|type;                      |id=Comment2                       |import accounts                  |
|click                      |id=btnProcessFile                 |                                 |
|pause                      |1500                                                                |
|waitForElementPresent      |//tr[@id='62']                                                      |
|pause                      |60000                                                               |
|verifyText                 |//div[@id='divBatchResults']/table||Accounts were successfully added|
|List Accounts                                                                                   |
|Check Batch Contents       |${PathToEthalon}ethalon_@filename.txt                               |
|Check Manage Batches Report|@filename                         ||Import Accounts                 |



!|scenario                  |Batch Update PSM Accounts         |filename            |
|clickAndWait               |link=Update PSM Accounts          |                    |
|pause                      |2000                                                   |
|click                      |id=PAMUploadBtnSelect                                  |
|SWait                      |browse.PNG                                             |
|SClick                     |browse.PNG                                             |
|pause                      |1500                                                   |
|SType                      |${PathToBatch}@filename.$Extention                     |
|pause                      |1500                                                   |
|SWait                      |open.PNG                                               |
|SClick                     |open.PNG                                               |
|pause                      |2000                                                   |
|SWait                      |upload_small.PNG                                       |
|SClick                     |upload_small.PNG                                       |
|pause                      |2000                                                   |
|type;                      |id=Comment2                       |update PSM accounts |
|click                      |id=btnProcessFile                 |                    |
|pause                      |1500                                                   |
|waitForElementPresent      |//tr[@id='14']                                         |
|pause                      |30000                                                  |
|verifyText                 |//div[@id='divBatchResults']/table||successfully       |
|List PSM Accounts                                                                  |
|Check Batch Contents       |${PathToEthalon}ethalon_@filename.txt                  |
|Check Manage Batches Report|@filename                         ||Update PSM Accounts|


!|scenario                  |Batch Update Bad PSM Accounts     |filename              |
|clickAndWait               |link=Update PSM Accounts          |                      |
|pause                      |2000                                                     |
|click                      |id=PAMUploadBtnSelect                                    |
|SWait                      |browse.PNG                                               |
|SClick                     |browse.PNG                                               |
|pause                      |1500                                                     |
|SType                      |${PathToBatch}@filename.$Extention                       |
|pause                      |1500                                                     |
|SWait                      |open.PNG                                                 |
|SClick                     |open.PNG                                                 |
|pause                      |2000                                                     |
|SWait                      |upload_small.PNG                                         |
|SClick                     |upload_small.PNG                                         |
|pause                      |2000                                                     |
|type;                      |id=Comment2                       |update PSM accounts   |
|click                      |id=btnProcessFile                 |                      |
|pause                      |1500                                                     |
|waitForElementPresent      |//tr[@id='5']                                            |
|pause                      |20000                                                    |
|verifyText                 |//div[@id='divBatchResults']/table||No accounts to update|
|List PSM Accounts                                                                    |
|Check Batch Contents       |${PathToEthalon}ethalon_@filename.txt                    |
|Check Manage Batches Report|@filename                         ||Update PSM Accounts  |


!|scenario                  |Batch Update-Delete Accounts      |filename                 |
|clickAndWait               |link=Update Accounts              |                         |
|pause                      |2000                                                        |
|click                      |id=PAMUploadBtnSelect                                       |
|SWait                      |browse.PNG                                                  |
|SClick                     |browse.PNG                                                  |
|pause                      |1500                                                        |
|SType                      |${PathToBatch}@filename.$Extention                          |
|pause                      |1500                                                        |
|SWait                      |open.PNG                                                    |
|SClick                     |open.PNG                                                    |
|pause                      |2000                                                        |
|SWait                      |upload_small.PNG                                            |
|SClick                     |upload_small.PNG                                            |
|pause                      |2000                                                        |
|type;                      |id=Comment2                       |update or delete accounts|
|click                      |id=btnProcessFile                 |                         |
|pause                      |1500                                                        |
|waitForElementPresent      |//tr[@id='14']                                              |
|pause                      |20000                                                       |
|verifyText                 |//div[@id='divBatchResults']/table|     |successfully       |
|List Accounts                                                                           |
|Check Batch Contents       |${PathToEthalon}ethalon_@filename.txt                       |
|Check Manage Batches Report|@filename                         |     |Update Accounts    |


!|scenario                  |Batch Update Accounts             |filename                                 |
|clickAndWait               |link=Update Accounts              |                                         |
|pause                      |2000                                                                        |
|click                      |id=PAMUploadBtnSelect                                                       |
|SWait                      |browse.PNG                                                                  |
|SClick                     |browse.PNG                                                                  |
|pause                      |1500                                                                        |
|SType                      |${PathToBatch}@filename.$Extention                                          |
|pause                      |1500                                                                        |
|SWait                      |open.PNG                                                                    |
|SClick                     |open.PNG                                                                    |
|pause                      |2000                                                                        |
|SWait                      |upload_small.PNG                                                            |
|SClick                     |upload_small.PNG                                                            |
|pause                      |2000                                                                        |
|click                      |id=Radio2                         |                                         |
|type;                      |id=Comment2                       |update accounts                          |
|click                      |id=btnProcessFile                 |                                         |
|pause                      |1500                                                                        |
|waitForElementPresent      |//tr[@id='5']                                                               |
|pause                      |20000                                                                       |
|verifyText                 |//div[@id='divBatchResults']/table||The following Accounts are being updated|
|List Accounts                                                                                           |
|Check Batch Contents       |${PathToEthalon}ethalon_@filename.txt                                       |
|Check Manage Batches Report|@filename                         ||Update Accounts                         |



!|scenario                  |Batch Delete Accounts             |filename                        |
|clickAndWait               |link=Update Accounts              |                                |
|pause                      |2000                                                               |
|click                      |id=PAMUploadBtnSelect                                              |
|SWait                      |browse.PNG                                                         |
|SClick                     |browse.PNG                                                         |
|pause                      |1500                                                               |
|SType                      |${PathToBatch}@filename.$Extention                                 |
|pause                      |1500                                                               |
|SWait                      |open.PNG                                                           |
|SClick                     |open.PNG                                                           |
|pause                      |2000                                                               |
|SWait                      |upload_small.PNG                                                   |
|SClick                     |upload_small.PNG                                                   |
|pause                      |2000                                                               |
|click                      |id=Radio1                         |                                |
|type;                      |id=Comment2                       |delete accounts                 |
|click                      |id=btnProcessFile                 |                                |
|pause                      |1500                                                               |
|waitForElementPresent      |//tr[@id='5']                                                      |
|pause                      |20000                                                              |
|verifyText                 |//div[@id='divBatchResults']/table||Deleting the following accounts|
|List Accounts                                                                                  |
|Check Batch Contents       |${PathToEthalon}ethalon_@filename.txt                              |
|Check Manage Batches Report|@filename                         ||Update Accounts                |


!|scenario                  |Batch Import Users                |filename                      |
|clickAndWait               |link=Import UserIDs               |                              |
|pause                      |2000                                                             |
|click                      |id=PAMUploadBtnSelect                                            |
|SWait                      |browse.PNG                                                       |
|SClick                     |browse.PNG                                                       |
|pause                      |1500                                                             |
|SType                      |${PathToBatch}@filename.$Extention                               |
|pause                      |1500                                                             |
|SWait                      |open.PNG                                                         |
|SClick                     |open.PNG                                                         |
|pause                      |2000                                                             |
|SWait                      |upload_small.PNG                                                 |
|SClick                     |upload_small.PNG                                                 |
|pause                      |2000                                                             |
|type;                      |id=Comment2                       |import users                  |
|click                      |id=btnProcessFile                 |                              |
|pause                      |1500                                                             |
|waitForElementPresent      |//tr[@id='3']                                                    |
|pause                      |120000                                                           |
|verifyText                 |//div[@id='divBatchResults']/table||Users were successfully added|
|List Users                                                                                   |
|Check Batch Contents       |${PathToEthalon}ethalon_@filename.txt                            |
|Check Manage Batches Report|@filename                         ||Import Users                 |


!|scenario                  |Batch Import Bad Users            |filename                   |
|clickAndWait               |link=Import UserIDs               |                           |
|pause                      |2000                                                          |
|click                      |id=PAMUploadBtnSelect                                         |
|SWait                      |browse.PNG                                                    |
|SClick                     |browse.PNG                                                    |
|pause                      |1500                                                          |
|SType                      |${PathToBatch}@filename.$Extention                            |
|pause                      |1500                                                          |
|SWait                      |open.PNG                                                      |
|SClick                     |open.PNG                                                      |
|pause                      |2000                                                          |
|SWait                      |upload_small.PNG                                              |
|SClick                     |upload_small.PNG                                              |
|pause                      |2000                                                          |
|type;                      |id=Comment2                       |import users               |
|click                      |id=btnProcessFile                 |                           |
|pause                      |1500                                                          |
|waitForElementPresent      |//tr[@id='3']                                                 |
|pause                      |30000                                                         |
|verifyText                 |//div[@id='divBatchResults']/table||There were no Users to add|
|List Users                                                                                |
|Check Batch Contents       |${PathToEthalon}ethalon_@filename.txt                         |
|Check Manage Batches Report|@filename                         ||Import Users              |


!|scenario                  |Batch Delete Users                |filename                     |
|clickAndWait               |link=Update UserIDs               |                             |
|pause                      |2000                                                            |
|click                      |id=PAMUploadBtnSelect                                           |
|SWait                      |browse.PNG                                                      |
|SClick                     |browse.PNG                                                      |
|pause                      |1500                                                            |
|SType                      |${PathToBatch}@filename.$Extention                              |
|pause                      |1500                                                            |
|SWait                      |open.PNG                                                        |
|SClick                     |open.PNG                                                        |
|pause                      |2000                                                            |
|SWait                      |upload_small.PNG                                                |
|SClick                     |upload_small.PNG                                                |
|pause                      |2000                                                            |
|click                      |id=Radio1                         |                             |
|type;                      |id=Comment2                       |delete users                 |
|click                      |id=btnProcessFile                 |                             |
|pause                      |1500                                                            |
|waitForElementPresent      |//tr[@id='3']                                                   |
|pause                      |60000                                                           |
|verifyText                 |//div[@id='divBatchResults']/table||Deleting the following Users|
|List Users                                                                                  |
|Check Batch Contents       |${PathToEthalon}ethalon_@filename.txt                           |
|Check Manage Batches Report|@filename                         ||Update Users                |


!|scenario                  |Batch Update Users                |filename                     |
|clickAndWait               |link=Update UserIDs               |                             |
|pause                      |2000                                                            |
|click                      |id=PAMUploadBtnSelect                                           |
|SWait                      |browse.PNG                                                      |
|SClick                     |browse.PNG                                                      |
|pause                      |1500                                                            |
|SType                      |${PathToBatch}@filename.$Extention                              |
|pause                      |1500                                                            |
|SWait                      |open.PNG                                                        |
|SClick                     |open.PNG                                                        |
|pause                      |2000                                                            |
|SWait                      |upload_small.PNG                                                |
|SClick                     |upload_small.PNG                                                |
|pause                      |2000                                                            |
|type;                      |id=Comment2                       |update or delete users       |
|click                      |id=btnProcessFile                 |                             |
|pause                      |1500                                                            |
|waitForElementPresent      |//tr[@id='10']                                                  |
|pause                      |60000                                                           |
|verifyText                 |//div[@id='divBatchResults']/table||Deleting the following Users|
|List Users                                                                                  |
|Check Batch Contents       |${PathToEthalon}ethalon_@filename.txt                           |
|Check Manage Batches Report|@filename                         ||Update Users                |


!|scenario                  |Batch Update Permissions          |filename                                                        |
|clickAndWait               |link=Update Permissions           |                                                                |
|pause                      |2000                                                                                               |
|click                      |id=PAMUploadBtnSelect                                                                              |
|SWait                      |browse.PNG                                                                                         |
|SClick                     |browse.PNG                                                                                         |
|pause                      |1500                                                                                               |
|SType                      |${PathToBatch}@filename.$Extention                                                                 |
|pause                      |1500                                                                                               |
|SWait                      |open.PNG                                                                                           |
|SClick                     |open.PNG                                                                                           |
|pause                      |2000                                                                                               |
|SWait                      |upload_small.PNG                                                                                   |
|SClick                     |upload_small.PNG                                                                                   |
|pause                      |2000                                                                                               |
|type;                      |id=Comment2                       |update permissions                                              |
|click                      |id=btnProcessFile                 |                                                                |
|pause                      |1500                                                                                               |
|waitForElementPresent      |//tr[@id='10']                                                                                     |
|pause                      |65000                                                                                              |
|verifyText                 |//div[@id='divBatchResults']/table||Adding Permissions to the following Systems, Accounts, or Files|
|List Permissions                                                                                                               |
|Check Batch Contents       |${PathToEthalon}ethalon_@filename.txt                                                              |
|Check Manage Batches Report|@filename                         ||Update Permissions                                             |


!|scenario                  |Batch Delete Permissions          |filename                                                                                 |
|clickAndWait               |link=Update Permissions           |                                                                                         |
|pause                      |2000                                                                                                                        |
|click                      |id=PAMUploadBtnSelect                                                                                                       |
|SWait                      |browse.PNG                                                                                                                  |
|SClick                     |browse.PNG                                                                                                                  |
|pause                      |1500                                                                                                                        |
|SType                      |${PathToBatch}@filename.$Extention                                                                                          |
|pause                      |3000                                                                                                                        |
|click                      |id=Radio1                         |                                                                                         |
|SWait                      |open.PNG                                                                                                                    |
|SClick                     |open.PNG                                                                                                                    |
|pause                      |2000                                                                                                                        |
|SWait                      |upload_small.PNG                                                                                                            |
|SClick                     |upload_small.PNG                                                                                                            |
|pause                      |2000                                                                                                                        |
|type;                      |id=Comment2                       |drop permissions                                                                         |
|click                      |id=btnProcessFile                 |                                                                                         |
|pause                      |1500                                                                                                                        |
|waitForElementPresent      |//tr[@id='3']                                                                                                               |
|pause                      |65000                                                                                                                       |
|verifyText                 |//div[@id='divBatchResults']/table||Dropping specified Permissions on the following Systems, Accounts, Files, or Collections|
|List Permissions                                                                                                                                        |
|Check Batch Contents       |${PathToEthalon}ethalon_@filename.txt                                                                                       |
|Check Manage Batches Report|@filename                         ||Update Permissions                                                                      |



!|scenario                  |Batch Add Permissions             |filename           |
|clickAndWait               |link=Update Permissions           |                   |
|pause                      |2000                                                  |
|click                      |id=PAMUploadBtnSelect                                 |
|SWait                      |browse.PNG                                            |
|SClick                     |browse.PNG                                            |
|pause                      |1500                                                  |
|SType                      |${PathToBatch}@filename.$Extention                    |
|pause                      |3000                                                  |
|click                      |id=Radio2                         |                   |
|SWait                      |open.PNG                                              |
|SClick                     |open.PNG                                              |
|pause                      |2000                                                  |
|SWait                      |upload_small.PNG                                      |
|SClick                     |upload_small.PNG                                      |
|pause                      |2000                                                  |
|type;                      |id=Comment2                       |add permissions    |
|click                      |id=btnProcessFile                 |                   |
|pause                      |1500                                                  |
|waitForElementPresent      |//tr[@id='1']                                         |
|pause                      |65000                                                 |
|verifyText                 |//div[@id='divBatchResults']/table||Assuming          |
|List Permissions                                                                  |
|Check Batch Contents       |${PathToEthalon}ethalon_@filename.txt                 |
|Check Manage Batches Report|@filename                         ||Update Permissions|


!|scenario                  |Load Collection Membership        |filename                     |
|clickAndWait               |link=Add/Drop Collection Members  |                             |
|pause                      |2000                                                            |
|click                      |id=PAMUploadBtnSelect                                           |
|SWait                      |browse.PNG                                                      |
|SClick                     |browse.PNG                                                      |
|pause                      |1500                                                            |
|SType                      |${PathToBatch}@filename.$Extention                              |
|pause                      |1500                                                            |
|SWait                      |open.PNG                                                        |
|SClick                     |open.PNG                                                        |
|pause                      |2000                                                            |
|SWait                      |upload_small.PNG                                                |
|SClick                     |upload_small.PNG                                                |
|pause                      |2000                                                            |
|type;                      |id=Comment2                       |Load Collection Membership   |
|click                      |id=btnProcessFile                 |                             |
|pause                      |1500                                                            |
|waitForElementPresent      |//tr[@id='4']                                                   |
|pause                      |10000                                                           |
|verifyText                 |//div[@id='divBatchResults']/table||Adding                      |
|List Collection Membership                                                                  |
|Check Batch Contents       |${PathToEthalon}ethalon_@filename.txt                           |
|Check Manage Batches Report|@filename                         ||Update Collection Membership|


!|scenario                  |Add Collection Membership         |filename                     |
|clickAndWait               |link=Add/Drop Collection Members  |                             |
|pause                      |2000                                                            |
|click                      |id=PAMUploadBtnSelect                                           |
|SWait                      |browse.PNG                                                      |
|SClick                     |browse.PNG                                                      |
|pause                      |1500                                                            |
|SType                      |${PathToBatch}@filename.$Extention                              |
|pause                      |1500                                                            |
|click                      |id=Radio2                         |                             |
|SWait                      |open.PNG                                                        |
|SClick                     |open.PNG                                                        |
|pause                      |2000                                                            |
|SWait                      |upload_small.PNG                                                |
|SClick                     |upload_small.PNG                                                |
|pause                      |2000                                                            |
|type;                      |id=Comment2                       |Add Collection Membership    |
|click                      |id=btnProcessFile                 |                             |
|pause                      |1500                                                            |
|waitForElementPresent      |//tr[@id='2']                                                   |
|pause                      |10000                                                           |
|verifyText                 |//div[@id='divBatchResults']/table||Adding                      |
|List Collection Membership                                                                  |
|Check Batch Contents       |${PathToEthalon}ethalon_@filename.txt                           |
|Check Manage Batches Report|@filename                         ||Update Collection Membership|


!|scenario                  |Load Group Membership             |filename                |
|pause                      |5000                                                       |
|clickAndWait               |link=Add/Drop Group Members       |                        |
|pause                      |2000                                                       |
|click                      |id=PAMUploadBtnSelect                                      |
|SWait                      |browse.PNG                                                 |
|SClick                     |browse.PNG                                                 |
|pause                      |1500                                                       |
|SType                      |${PathToBatch}@filename.$Extention                         |
|pause                      |1500                                                       |
|SWait                      |open.PNG                                                   |
|SClick                     |open.PNG                                                   |
|pause                      |2000                                                       |
|SWait                      |upload_small.PNG                                           |
|SClick                     |upload_small.PNG                                           |
|pause                      |2000                                                       |
|type;                      |id=Comment2                       |Load Group Membership   |
|click                      |id=btnProcessFile                 |                        |
|pause                      |1500                                                       |
|waitForElementPresent      |//tr[@id='15']                                             |
|pause                      |10000                                                      |
|verifyText                 |//div[@id='divBatchResults']/table||Adding                 |
|List Group Membership                                                                  |
|Check Batch Contents       |${PathToEthalon}ethalon_@filename.txt                      |
|Check Manage Batches Report|@filename                         ||Update Group Membership|


!|scenario                  |Delete Group Membership           |filename                             |
|clickAndWait               |link=Add/Drop Group Members       |                                     |
|pause                      |2000                                                                    |
|click                      |id=PAMUploadBtnSelect                                                   |
|SWait                      |browse.PNG                                                              |
|SClick                     |browse.PNG                                                              |
|pause                      |1500                                                                    |
|SType                      |${PathToBatch}@filename.$Extention                                      |
|pause                      |1500                                                                    |
|click                      |id=Radio1                         |                                     |
|SWait                      |open.PNG                                                                |
|SClick                     |open.PNG                                                                |
|pause                      |2000                                                                    |
|SWait                      |upload_small.PNG                                                        |
|SClick                     |upload_small.PNG                                                        |
|pause                      |2000                                                                    |
|type;                      |id=Comment2                       |Delete Group Membership              |
|click                      |id=btnProcessFile                 |                                     |
|pause                      |1500                                                                    |
|waitForElementPresent      |//tr[@id='2']                                                           |
|pause                      |10000                                                                   |
|verifyText                 |//div[@id='divBatchResults']/table||Dropping the following Group members|
|List Group Membership                                                                               |
|Check Batch Contents       |${PathToEthalon}ethalon_@filename.txt                                   |
|Check Manage Batches Report|@filename                         ||Update Group Membership             |



!| scenario|List Systems                                                         |
|$res=     |CLItoFile|${CLIBatch} ListSystems --SystemName klbatch* --MaxRows 150|

!| scenario|List Accounts                                                                                  |
|$res=     |CLItoFile|${CLIBatch} ListAccounts --SystemName klbatch* --AccountName klbatchacc --MaxRows 100|
                                                                                                                                                                                                   
!| scenario|List Users                                                      |
|$res=     |CLItoFile|${CLIBatch} ListUsers --UserName kluser* --MaxRows 100|

!| scenario|List PSM Accounts                                                                                  |
|$res=     |CLItoFile|${CLIBatch} ListEGPAccounts --SystemName klbatch* --AccountName klbatchacc  --MaxRows 100|

!| scenario|List Permissions                                                                  |
|$res=     |CLItoFile|${CLIBatch} ListAssignedPolicies --AccountName klbatchacc  --MaxRows 100|


!| scenario|Debug Permissions                                                                                     |
|$res=     |CLI|${CLIBatch} ListAssignedPolicies --SystemName klbatchsys10 --AccountName klbatchacc  --MaxRows 100|
|$res=     |CLI|${CLIBatch} ListAssignedPolicies --SystemName klbatchsys11 --AccountName klbatchacc  --MaxRows 100|
|$res=     |CLI|${CLIBatch} ListAssignedPolicies --SystemName klbatchsys12 --AccountName klbatchacc  --MaxRows 100|
|$res=     |CLI|${CLIBatch} ListAssignedPolicies --SystemName klbatchsys13 --AccountName klbatchacc  --MaxRows 100|
|$res=     |CLI|${CLIBatch} ListAssignedPolicies --SystemName klbatchsys14 --AccountName klbatchacc  --MaxRows 100|
|$res=     |CLI|${CLIBatch} ListAssignedPolicies --SystemName klbatchsys15 --AccountName klbatchacc  --MaxRows 100|
|$res=     |CLI|${CLIBatch} ListAssignedPolicies --SystemName klbatchsys16 --AccountName klbatchacc  --MaxRows 100|
|$res=     |CLI|${CLIBatch} ListAssignedPolicies --SystemName klbatchsys17 --AccountName klbatchacc  --MaxRows 100|
|$res=     |CLI|${CLIBatch} ListAssignedPolicies --SystemName klbatchsys18 --AccountName klbatchacc  --MaxRows 100|
|$res=     |CLI|${CLIBatch} ListAssignedPolicies --SystemName klbatchsys19 --AccountName klbatchacc  --MaxRows 100|
|$res=     |CLI|${CLIBatch} ListAssignedPolicies --SystemName klbatchsys20 --AccountName klbatchacc  --MaxRows 100|
|$res=     |CLI|${CLIBatch} ListAssignedPolicies --SystemName klbatchsys21 --AccountName klbatchacc  --MaxRows 100|
|$res=     |CLI|${CLIBatch} ListAssignedPolicies --SystemName klbatchsys22 --AccountName klbatchacc  --MaxRows 100|
|$res=     |CLI|${CLIBatch} ListAssignedPolicies --SystemName klbatchsys23 --AccountName klbatchacc  --MaxRows 100|
|$res=     |CLI|${CLIBatch} ListAssignedPolicies --SystemName klbatchsys24 --AccountName klbatchacc  --MaxRows 100|
|$res=     |CLI|${CLIBatch} ListAssignedPolicies --SystemName klbatchsys25 --AccountName klbatchacc  --MaxRows 100|
|$res=     |CLI|${CLIBatch} ListAssignedPolicies --SystemName klbatchsys26 --AccountName klbatchacc  --MaxRows 100|
|$res=     |CLI|${CLIBatch} ListAssignedPolicies --SystemName klbatchsys27 --AccountName klbatchacc  --MaxRows 100|
|$res=     |CLI|${CLIBatch} ListAssignedPolicies --SystemName klbatchsys28 --AccountName klbatchacc  --MaxRows 100|
|$res=     |CLI|${CLIBatch} ListAssignedPolicies --SystemName klbatchsys29 --AccountName klbatchacc  --MaxRows 100|
|$res=     |CLI|${CLIBatch} ListAssignedPolicies --SystemName klbatchsys10 --MaxRows 100                          |
|$res=     |CLI|${CLIBatch} ListAssignedPolicies --SystemName klbatchsys11 --MaxRows 100                          |
|$res=     |CLI|${CLIBatch} ListAssignedPolicies --SystemName klbatchsys12 --MaxRows 100                          |
|$res=     |CLI|${CLIBatch} ListAssignedPolicies --SystemName klbatchsys13 --MaxRows 100                          |
|$res=     |CLI|${CLIBatch} ListAssignedPolicies --SystemName klbatchsys14 --MaxRows 100                          |
|$res=     |CLI|${CLIBatch} ListAssignedPolicies --SystemName klbatchsys15 --MaxRows 100                          |
|$res=     |CLI|${CLIBatch} ListAssignedPolicies --SystemName klbatchsys16 --MaxRows 100                          |
|$res=     |CLI|${CLIBatch} ListAssignedPolicies --SystemName klbatchsys17 --MaxRows 100                          |
|$res=     |CLI|${CLIBatch} ListAssignedPolicies --SystemName klbatchsys18 --MaxRows 100                          |
|$res=     |CLI|${CLIBatch} ListAssignedPolicies --SystemName klbatchsys19 --MaxRows 100                          |















!| scenario|List Collection Membership                                   |
|$res=     |CLItoFile|${CLIBatch} ListCollectionMembership kl_collection*|

!| scenario|List Group Membership                              |
|$res=     |CLItoFile|${CLIBatch} ListGroupMembership kl_group*|



#!| scenario       |Compare Files        |file1     |     |file2    |
#|$res=            |RunBatchGetOutputFull|comparefiles;@file1;@file2|
#|Verify_Contain_OR|$res;;no differences encountered                |




!|scenario         |Create Password Rule|ruleName                    |
|Login             |${TPAMAdminURL}     ||${TPAMMaster}||${MasterPwd}|
|pause             |10000                                            |
|clickAndWait      |link=Password Rules                              |
|click             |id=NewRuleButton                                 |
|type;             |id=PwdRuleName      |@ruleName                   |
|type;             |id=PwdRuleDesc      |test rule description       |
|type;             |id=MaxChars         |11                          |
|type;             |id=MinChars         |7                           |
|click             |id=ReqFirst                                      |
|select;           |id=ReqFirst         |label=Alpha Characters Only |
|click             |id=ReqUpper                                      |
|select;           |id=ReqUpper         |label=Require at least 2    |
|click             |id=ReqLower                                      |
|select;           |id=ReqLower         |label=Require at least 2    |
|click             |id=ReqNum                                        |
|select;           |id=ReqNum           |label=Require at least 1    |
|click             |id=ReqNonAN                                      |
|select;           |id=ReqNonAN         |label=Require at least 1    |
|click             |id=CRepeat                                       |
|select;           |id=CRepeat          |label=Not Permitted         |
|click             |id=SubmitChangesButton                           |
|waitForTextPresent|Password Rule changes saved successfully         |


!|scenario        |Delete Password Rule|ruleName                                |
|$res=            |GroovyWebDriver     |DeletePasswordRule;${TPAMHost};@ruleName|
|Verify_Contain_OR|$res;;Rule deleted                                           |


#!|scenario         |Delete Password Rule|ruleName                    |
#|Login             |${TPAMAdminURL}     ||${TPAMMaster}||${MasterPwd}|
#|pause             |10000                                            |
#|clickAndWait      |link=Password Rules                              |
#|select;           |id=PasswordRuleID   |label=@ruleName             |
#|click             |id=DeleteRuleButton                              |
#|getConfirmation                                                     |
#|waitForTextPresent|Password Rule was deleted successfully           |


!|scenario            |Hard-Delete System                  |systemName |
|clickAndWait         |link=Deleted Systems                            |
|type;                |id=SystemNm                         |@systemName|
|click                |id=Listing                          |           |
|waitForElementPresent|//td[contains(text(),'@systemName')]|           |
|mouseDown            |//td[contains(text(),'@systemName')]|           |
|click                |//td[contains(text(),'@systemName')]|           |
|click                |id=HardDeleteButton                 |           |
|getConfirmation                                                       |
|waitForTextPresent   |has been successfully deleted                   |
|pause                |1000                                            |



#|stop                                                                                                          |
#|start             |Slim Selenium Driver|${seleniumHost}|${seleniumPort}|${seleniumBrowser}|https://${TPAMHost}|
#|setTimeoutSeconds |30                                                                                         |

!|scenario         |Hard-Delete All|
|pause             |10000          |
|Hard-Delete System|klbatchsys1    |
|Hard-Delete System|klbatchsys2    |
|Hard-Delete System|klbatchsys3    |
|Hard-Delete System|klbatchsys4    |
|Hard-Delete System|klbatchsys5    |
|Hard-Delete System|klbatchsys6    |
|Hard-Delete System|klbatchsys7    |
|Hard-Delete System|klbatchsys8    |
|Hard-Delete System|klbatchsys9    |
|Hard-Delete System|klbatchsys10   |
|Hard-Delete System|klbatchsys11   |
|Hard-Delete System|klbatchsys12   |
|Hard-Delete System|klbatchsys13   |
|Hard-Delete System|klbatchsys14   |
|Hard-Delete System|klbatchsys15   |
|Hard-Delete System|klbatchsys16   |
|Hard-Delete System|klbatchsys17   |
|Hard-Delete System|klbatchsys18   |
|Hard-Delete System|klbatchsys19   |
|Hard-Delete System|klbatchsys20   |
|Hard-Delete System|klbatchsys21   |
|Hard-Delete System|klbatchsys22   |
|Hard-Delete System|klbatchsys23   |
|Hard-Delete System|klbatchsys24   |
|Hard-Delete System|klbatchsys25   |
|Hard-Delete System|klbatchsys26   |
|Hard-Delete System|klbatchsys27   |
|Hard-Delete System|klbatchsys28   |
|Hard-Delete System|klbatchsys29   |
|Hard-Delete System|klbatchsys30   |
|Hard-Delete System|klbatchsys31   |
|Hard-Delete System|klbatchsys32   |
|Hard-Delete System|klbatchsys33   |
|Hard-Delete System|klbatchsys34   |
|Hard-Delete System|klbatchsys35   |
|Hard-Delete System|klbatchsys36   |
|Hard-Delete System|klbatchsys37   |
|Hard-Delete System|klbatchsys38   |
|Hard-Delete System|klbatchsys39   |
|Hard-Delete System|klbatchsys40   |
|Hard-Delete System|klbatchsys41   |
|Hard-Delete System|klbatchsys42   |
|Hard-Delete System|klbatchsys43   |
|Hard-Delete System|klbatchsys44   |
|Hard-Delete System|klbatchsys45   |
|Hard-Delete System|klbatchsys46   |
|Hard-Delete System|klbatchsys47   |
|Hard-Delete System|klbatchsys48   |
|Hard-Delete System|klbatchsys49   |
|Hard-Delete System|klbatchsys50   |
|Hard-Delete System|klbatchsys51   |
|Hard-Delete System|klbatchsys52   |
|Hard-Delete System|klbatchsys53   |
|Hard-Delete System|klbatchsys54   |
|Hard-Delete System|klbatchsys55   |
|Hard-Delete System|klbatchsys56   |
|Hard-Delete System|klbatchsys57   |
|Hard-Delete System|klbatchsys58   |
|Hard-Delete System|klbatchsys59   |
|Hard-Delete System|klbatchsys60   |
|Hard-Delete System|klbatchsys61   |
|Hard-Delete System|klbatchsys62   |
|Hard-Delete System|klbatchsys63   |
|Hard-Delete System|klbatchsys64   |
|Hard-Delete System|klbatchsys65   |
|Hard-Delete System|klbatchsys66   |



!|scenario         |Create Post-Session Profile|profileName                  |
|Login             |${TPAMURL}                 | |${TPAMAdmin}||${DefaultPwd}|
|pause             |5000                                                     |
|clickAndWait      |link=Profile Management    |                             |
|select;           |id=ProfileType             |label=Post Session Processing|
|click             |id=NewButton               |                             |
|type;             |id=ProfileName             |@profileName                 |
|click             |id=PostEmailPrimaryFl      |                             |
|type;             |id=PostEmailNotification   |kl.post.session@tpam.spb.qsft|
|click             |id=SaveButton              |                             |
|waitForTextPresent|The profile saved successfully                           |

!|scenario         |Delete Post-Session Profile|profileName                  |
|Login             |${TPAMURL}                 | |${TPAMAdmin}||${DefaultPwd}|
|pause             |5000                                                     |
|clickAndWait      |link=Profile Management    |                             |
|select;           |id=ProfileType             |label=Post Session Processing|
|select;           |id=ProfileID               |label=@profileName           |
|click             |id=DeleteButton            |                             |
|getConfirmation                                                             |
|waitForTextPresent|The profile was deleted successfully                     |


!|scenario            |Add File          |systemName       |
|clickAndWait         |link=Add File                       |
|waitForElementPresent|id=SystemNm                         |
|type;                |id=SystemNm       |@systemName      |
|click                |id=System                           |
|waitForElementPresent|//td[contains(text(),'@systemName')]|
|mouseDown            |//td[contains(text(),'@systemName')]|
|click                |//td[contains(text(),'@systemName')]|
|click                |id=Details                          |
|waitForElementPresent|id=FileName                         |
|type;                |id=FileName       |${FileName}      |
|type;                |id=RelNotifyEmail |${FileEmailAddr} |
|click                |id=PAMUploadBtnSelect               |
|SWait                |browse.png                          |
|SClick               |browse.png                          |
|pause                |3000                                |
|SType                |${FilePath}${FileName}.txt          |
|pause                |2000                                |
|SWait                |open.png                            |
|SClick               |open.png                            |
|pause                |5000                                |
|SWait                |upload_small.PNG                    |
|SClick               |upload_small.PNG                    |
|pause                |5000                                |
|click                |id=SubmitChanges                    |
|waitForTextPresent   |*File saved successfully*           |


!|scenario            |Add Ticket System  |systemName                  |
|Login                |${TPAMAdminURL}    ||${TPAMMaster}||${MasterPwd}|
|pause                |5000                                            |
|clickAndWait         |link=Ticket Systems|                            |
|click                |id=AddTicketSystem |                            |
|waitForElementPresent|id=TSName                                       |
|type;                |id=TSName          |@systemName                 |
|type;                |id=TSDescription   |@systemName description     |
|click                |id=EnableFL                                     |
|waitForElementPresent|id=ManualFL                                     |
|click                |id=ManualFL                                     |
|waitForElementPresent|id=valQuickSel                                  |
|select;              |id=valQuickSel     |label=Only numbers          |
|click                |id=SubmitChanges                                |
|pause                |10000                                           |
#|waitForTextPresent   |Ticket System saved successfully            |


!|scenario        |Delete Ticket System|systemName                                |
|$res=            |GroovyWebDriver     |DeleteTicketSystem;${TPAMHost};@systemName|
|Verify_Contain_OR|$res;;System deleted                                           |

#!|scenario            |Delete Ticket System|systemName                  |
#|Login                |${TPAMAdminURL}     ||${TPAMMaster}||${MasterPwd}|
#|pause                |15000                                            |
#|clickAndWait         |link=Ticket Systems |                            |
#|waitForElementPresent|//td[contains(text(),'@systemName')]             |
#|mouseDown            |//td[contains(text(),'@systemName')]             |
#|click                |//td[contains(text(),'@systemName')]             |
#|click                |id=Details                                       |
#|waitForElementPresent|id=DeleteTicketSystem                            |
#|click                |id=DeleteTicketSystem                            |
#|getConfirmation                                                        |
#|waitForTextPresent   |Ticket System successfully deleted               |

!|scenario         |Create Connection Profile|profileName                         |
|Login             |${TPAMURL}               |  |${TPAMAdmin}  |  |${DefaultPwd}  |
|pause             |5000                                                          |
|clickAndWait      |link=Profile Management  |                                    |
|select;           |id=ProfileType           |label=PSM Connection                |
|click             |id=NewButton             |                                    |
|type;             |id=ProfileName           |@profileName                        |
|select;           |id=ProxyTypeID           |RDP - Automatic Login Using Password|
|type;             |id=ProfileName           |@profileName                        |
|type;             |id=Description           |@profileName description            |
|type;             |id=Port                  |3388                                |
|click             |id=SaveButton            |                                    |
|waitForTextPresent|The profile saved successfully                                |

!|scenario         |Delete Connection Profile|profileName                 |
|Login             |${TPAMURL}               ||${TPAMAdmin}||${DefaultPwd}|
|pause             |5000                                                  |
|clickAndWait      |link=Profile Management  |                            |
|select;           |id=ProfileType           |label=PSM Connection        |
|select;           |id=ProfileID             |label=@profileName          |
|click             |id=DeleteButton          |                            |
|getConfirmation                                                          |
|waitForTextPresent|The profile was deleted successfully                  |


!|scenario            |Create System Template  |templateName                |
|Login                |${TPAMURL}              ||${TPAMAdmin}||${DefaultPwd}|
|clickAndWait         |link=Add System Template|                            |
|type;                |id=SystemName           |@templateName               |
|type;                |id=NetworkAddress       |192.168.99.222              |
|select;              |id=PlatformID           |label=Windows               |
|select;              |id=MaxDurationDays      |label=3                     |
|type;                |id=PrimaryEmail         |templatesys@tpam.spb.qsft   |
|type;                |id=Comment              |@templateName description   |
|type;                |id=EscalationTime       |3                           |
|type;                |id=EscalationEmail      |escalate@tpam.spb.qsft      |
|click                |id=Connection           |                            |
|waitForElementPresent|id=Timeout                                           |
|type;                |id=Timeout              |55                          |
|click                |id=ManagementDetails    |                            |
|waitForElementPresent|id=cb_ReleaseChgFl                                   |
|click                |id=rb_Opt2                                           |
|type;                |id=tbDays               |3                           |
|click                |id=bt_Save                                           |
|waitForTextPresent   |System changes for @templateName saved successfully  |


!|scenario            |Delete System Template    |templateName    |
|clickAndWait         |link=Manage Systems                        |
|type;                |id=SystemNm               |@templateName   |
|click                |id=Listing                                 |
|waitForElementPresent|//td[contains(text(),'@templateName')]     |
|mouseDown            |//td[contains(text(),'@templateName')]     |
|click                |//td[contains(text(),'@templateName')]     |
|click                |id=bt_Del                                  |
|getConfirmation                                                  |
|waitForTextPresent   |@templateName has been successfully deleted|

!|scenario            |Create Template from System     |systemName           |
|clickAndWait         |link=Manage Systems                                   |
|type;                |id=SystemNm                     |@systemName          |
|click                |id=Listing                                            |
|waitForElementPresent|//td[contains(text(),'@systemName')]                  |
|mouseDown            |//td[contains(text(),'@systemName')]                  |
|click                |//td[contains(text(),'@systemName')]                  |
|click                |id=Template                                           |
|waitForElementPresent|id=cbxTemplateFl                                      |
|click                |id=cbxTemplateFl                                      |
|pause                |3000                                                  |
|click                |id=cbxRetainCollections                               |
|pause                |3000                                                  |
|click                |id=cbxRetainPermissions                               |
|pause                |3000                                                  |
|click                |id=cbxRetainAccounts                                  |
|click                |id=Details                                            |
|waitForElementPresent|id=SystemName                                         |
|type;                |id=SystemName                   |@systemNametempl     |
|click                |id=bt_Save                                            |
|waitForTextPresent   |System changes for @systemNametempl saved successfully|

!|scenario            |Create Template from User|userName      |
|clickAndWait         |link=Manage UserIDs                     |
|type;                |id=UsrNm                 |@userName     |
|click                |id=Listing                              |
|waitForElementPresent|//td[contains(text(),'@userName')]      |
|mouseDown            |//td[contains(text(),'@userName')]      |
|click                |//td[contains(text(),'@userName')]      |
|click                |id=Template                             |
|pause                |5000                                    |
|waitForElementPresent|id=cbxTemplateFl                        |
|click                |id=cbxTemplateFl                        |
|pause                |5000                                    |
|click                |id=cbxRetainGroups                      |
|pause                |2000                                    |
|click                |id=cbxRetainPermissions                 |
|pause                |2000                                    |
|click                |id=SubmitChanges                        |
|pause                |3000                                    |
|getAlert                                                      |
|pause                |3000                                    |
|waitForElementPresent|id=UserName                             |
|type;                |id=UserName              |@userNametempl|
|click                |id=SubmitChanges                        |
|waitForTextPresent   |User added successfully                 |


!|scenario            |Delete User Template     |templateName     |
|clickAndWait         |link=Manage UserIDs                        |
|type;                |id=UsrNm                 |@templateName    |
|click                |id=Listing                                 |
|waitForElementPresent|//td[contains(text(),'@templateName')]     |
|mouseDown            |//td[contains(text(),'@templateName')]     |
|click                |//td[contains(text(),'@templateName')]     |
|click                |id=Delete                                  |
|getConfirmation                                                  |
|waitForTextPresent   |@templateName has been successfully deleted|


!|scenario|Set Advanced File Settings 1                       |
|click    |css=legend.smallLegendHeader > input[type="button"]|
|pause    |1000                                               |
|type;    |id=SkipFirstRows                |2                 |
|type;    |id=SkipDataRows                 |10                |
|click    |id=cbxFileTypeAuto                                 |
|pause    |1000                                               |
|click    |id=rbColDelimOther                                 |
|pause    |1000                                               |
|type;    |id=OtherColumnDelimiter         |${DOLLAR}         |
|click    |id=rbRowDelimOther                                 |
|pause    |1000                                               |
|type;    |id=OtherRowDelimiter            |${BAR}            |

!|scenario|Set Advanced File Settings 2                       |
|click    |css=legend.smallLegendHeader > input[type="button"]|
|pause    |1000                                               |
|type;    |id=SkipFirstRows                |2                 |
|type;    |id=RowLimit                     |10                |
|click    |id=cbxFileTypeAuto                                 |
|pause    |1000                                               |
|click    |id=rbColDelimOther                                 |
|pause    |1000                                               |
|type;    |id=OtherColumnDelimiter         |${DOLLAR}         |
|click    |id=rbRowDelimCR                                    |

!|scenario|Set Advanced File Settings 3                       |
|click    |css=legend.smallLegendHeader > input[type="button"]|
|pause    |1000                                               |
|click    |id=rbColHdrYes                                     |
|click    |id=cbxFileTypeAuto                                 |
|click    |id=rbColDelimOther                                 |
|pause    |1000                                               |
|type;    |id=OtherColumnDelimiter             |%             |
|click    |id=rbRowDelimLF                                    |

!|scenario|Set Advanced File Settings 4                       |
|click    |css=legend.smallLegendHeader > input[type="button"]|
|pause    |1000                                               |
|click    |id=cbxFileTypeAuto                                 |

!|scenario|Set Advanced File Settings 5                       |
|click    |css=legend.smallLegendHeader > input[type="button"]|
|pause    |1000                                               |
|click    |id=rbColHdrYes                                     |
|type;    |id=RowLimit                         |5             |
|click    |id=cbxFileTypeAuto                                 |
|pause    |1000                                               |
|click    |id=rbColDelimOther                                 |
|pause    |1000                                               |
|type;    |id=OtherColumnDelimiter             |^             |
|click    |id=rbRowDelimCR                                    |

!|scenario|Set Advanced File Settings 6                       |
|click    |css=legend.smallLegendHeader > input[type="button"]|
|pause    |1000                                               |
|click    |id=rbColHdrNo                                      |
|type;    |id=RowLimit                         |5             |
|click    |id=cbxFileTypeAuto                                 |
|pause    |1000                                               |
|click    |id=rbColDelimOther                                 |
|pause    |1000                                               |
|type;    |id=OtherColumnDelimiter             |~             |
|click    |id=rbRowDelimLF                                    |

!|scenario|Set Advanced File Settings 7                       |
|click    |css=legend.smallLegendHeader > input[type="button"]|
|pause    |1000                                               |
|click    |id=rbColHdrYes                                     |
|click    |id=cbxFileTypeAuto                                 |
|pause    |1000                                               |
|click    |id=rbColDelimOther                                 |
|pause    |1000                                               |
|type;    |id=OtherColumnDelimiter             |&             |
|pause    |1000                                               |
|click    |id=rbRowDelimOther                                 |


!|scenario                  |Batch Import Systems Advanced 1    |filename                        |
|clickAndWait               |link=Import Systems                |                                |
|pause                      |2000                                                                |
|Set Advanced File Settings 1                                                                    |
|pause                      |2000                                                                |
|click                      |id=PAMUploadBtnSelect                                               |
|SWait                      |browse.PNG                                                          |
|SClick                     |browse.PNG                                                          |
|pause                      |1500                                                                |
|SType                      |${PathToBatch}@filename.txt                                         |
|pause                      |1500                                                                |
|SWait                      |open.PNG                                                            |
|SClick                     |open.PNG                                                            |
|pause                      |2000                                                                |
|SWait                      |upload_small.PNG                                                    |
|SClick                     |upload_small.PNG                                                    |
|pause                      |2000                                                                |
|type;                      |id=Comment2                        |import systems                  |
|click                      |id=btnProcessFile                  |                                |
|pause                      |1500                                                                |
|waitForElementPresent      |//tr[@id='10']                                                      |
|pause                      |60000                                                               |
|verifyText                 |//div[@id='divBatchResults']/table/||Systems were successfully added|
|List Systems                                                                                    |
|Check Batch Contents       |${PathToEthalon}ethalon_@filename.txt                               |
|Check Manage Batches Report|@filename                          ||Import Systems                 |



!|scenario                  |Batch Import Systems Advanced 2    |filename                        |
|clickAndWait               |link=Import Systems                |                                |
|pause                      |2000                                                                |
|Set Advanced File Settings 2                                                                    |
|pause                      |2000                                                                |
|click                      |id=PAMUploadBtnSelect                                               |
|SWait                      |browse.PNG                                                          |
|SClick                     |browse.PNG                                                          |
|pause                      |1500                                                                |
|SType                      |${PathToBatch}@filename.txt                                         |
|pause                      |1500                                                                |
|SWait                      |open.PNG                                                            |
|SClick                     |open.PNG                                                            |
|pause                      |2000                                                                |
|SWait                      |upload_small.PNG                                                    |
|SClick                     |upload_small.PNG                                                    |
|pause                      |2000                                                                |
|type;                      |id=Comment2                        |import systems                  |
|click                      |id=btnProcessFile                  |                                |
|pause                      |1500                                                                |
|waitForElementPresent      |//tr[@id='10']                                                      |
|pause                      |60000                                                               |
|verifyText                 |//div[@id='divBatchResults']/table/||Systems were successfully added|
|List Systems                                                                                    |
|Check Batch Contents       |${PathToEthalon}ethalon_@filename.txt                               |
|Check Manage Batches Report|@filename                          ||Import Systems                 |


!|scenario                  |Batch Import Accounts Advanced    |filename                         |
|clickAndWait               |link=Import Accounts              |                                 |
|pause                      |2000                                                                |
|Set Advanced File Settings 3                                                                    |
|pause                      |2000                                                                |
|click                      |id=PAMUploadBtnSelect                                               |
|SWait                      |browse.PNG                                                          |
|SClick                     |browse.PNG                                                          |
|pause                      |1500                                                                |
|SType                      |${PathToBatch}@filename.txt                                         |
|pause                      |1500                                                                |
|SWait                      |open.PNG                                                            |
|SClick                     |open.PNG                                                            |
|pause                      |2000                                                                |
|SWait                      |upload_small.PNG                                                    |
|SClick                     |upload_small.PNG                                                    |
|pause                      |2000                                                                |
|type;                      |id=Comment2                       |import accounts                  |
|click                      |id=btnProcessFile                 |                                 |
|pause                      |1500                                                                |
|waitForElementPresent      |//tr[@id='20']                                                      |
|pause                      |60000                                                               |
|verifyText                 |//div[@id='divBatchResults']/table||Accounts were successfully added|
|List Accounts                                                                                   |
|Check Batch Contents       |${PathToEthalon}ethalon_@filename.txt                               |
|Check Manage Batches Report|@filename                         ||Import Accounts                 |


!|scenario                  |Batch Update PSM Accounts Advanced|filename            |
|clickAndWait               |link=Update PSM Accounts          |                    |
|pause                      |2000                                                   |
|Set Advanced File Settings 4                                                       |
|pause                      |2000                                                   |
|click                      |id=PAMUploadBtnSelect                                  |
|SWait                      |browse.PNG                                             |
|SClick                     |browse.PNG                                             |
|pause                      |1500                                                   |
|SType                      |${PathToBatch}@filename.txt                            |
|pause                      |1500                                                   |
|SWait                      |open.PNG                                               |
|SClick                     |open.PNG                                               |
|pause                      |2000                                                   |
|SWait                      |upload_small.PNG                                       |
|SClick                     |upload_small.PNG                                       |
|pause                      |2000                                                   |
|type;                      |id=Comment2                       |update PSM accounts |
|click                      |id=btnProcessFile                 |                    |
|pause                      |1500                                                   |
|waitForElementPresent      |//tr[@id='14']                                         |
|pause                      |60000                                                  |
|verifyText                 |//div[@id='divBatchResults']/table||successfully       |
|List PSM Accounts                                                                  |
|Check Batch Contents       |${PathToEthalon}ethalon_@filename.txt                  |
|Check Manage Batches Report|@filename                         ||Update PSM Accounts|


!|scenario                  |Batch Import Users Advanced       |filename                      |
|clickAndWait               |link=Import UserIDs               |                              |
|pause                      |2000                                                             |
|Set Advanced File Settings 5                                                                 |
|pause                      |2000                                                             |
|click                      |id=PAMUploadBtnSelect                                            |
|SWait                      |browse.PNG                                                       |
|SClick                     |browse.PNG                                                       |
|pause                      |1500                                                             |
|SType                      |${PathToBatch}@filename.txt                                      |
|pause                      |1500                                                             |
|SWait                      |open.PNG                                                         |
|SClick                     |open.PNG                                                         |
|pause                      |2000                                                             |
|SWait                      |upload_small.PNG                                                 |
|SClick                     |upload_small.PNG                                                 |
|pause                      |2000                                                             |
|type;                      |id=Comment2                       |import users                  |
|click                      |id=btnProcessFile                 |                              |
|pause                      |1500                                                             |
|waitForElementPresent      |//tr[@id='7']                                                    |
|pause                      |90000                                                            |
|verifyText                 |//div[@id='divBatchResults']/table||Users were successfully added|
|List Users                                                                                   |
|Check Batch Contents       |${PathToEthalon}ethalon_@filename.txt                            |
|Check Manage Batches Report|@filename                         ||Import Users                 |


!|scenario                  |Batch Update Users Advanced       |filename                     |
|clickAndWait               |link=Update UserIDs               |                             |
|pause                      |2000                                                            |
|Set Advanced File Settings 6                                                                |
|pause                      |2000                                                            |
|click                      |id=PAMUploadBtnSelect                                           |
|SWait                      |browse.PNG                                                      |
|SClick                     |browse.PNG                                                      |
|pause                      |1500                                                            |
|SType                      |${PathToBatch}@filename.txt                                     |
|pause                      |1500                                                            |
|SWait                      |open.PNG                                                        |
|SClick                     |open.PNG                                                        |
|pause                      |2000                                                            |
|SWait                      |upload_small.PNG                                                |
|SClick                     |upload_small.PNG                                                |
|pause                      |2000                                                            |
|type;                      |id=Comment2                       |update or delete users       |
|click                      |id=btnProcessFile                 |                             |
|pause                      |1500                                                            |
|waitForElementPresent      |//tr[@id='7']                                                   |
|pause                      |90000                                                           |
|verifyText                 |//div[@id='divBatchResults']/table||Deleting the following Users|
|List Users                                                                                  |
|Check Batch Contents       |${PathToEthalon}ethalon_@filename.txt                           |
|Check Manage Batches Report|@filename                         ||Update Users                |



!|scenario                  |Batch Delete Systems Advanced     |filename                      |
|clickAndWait               |link=Update Systems               |                              |
|pause                      |2000                                                             |
|Set Advanced File Settings 7                                                                 |
|pause                      |2000                                                             |
|click                      |id=PAMUploadBtnSelect                                            |
|SWait                      |browse.PNG                                                       |
|SClick                     |browse.PNG                                                       |
|pause                      |1500                                                             |
|SType                      |${PathToBatch}@filename.txt                                      |
|pause                      |1500                                                             |
|SWait                      |open.PNG                                                         |
|SClick                     |open.PNG                                                         |
|pause                      |2000                                                             |
|SWait                      |upload_small.PNG                                                 |
|SClick                     |upload_small.PNG                                                 |
|pause                      |2000                                                             |
|click                      |id=Radio1                         |                              |
|type;                      |id=Comment2                       |delete systems                |
|click                      |id=btnProcessFile                 |                              |
|pause                      |1500                                                             |
|waitForElementPresent      |//tr[@id='50']                                                   |
|pause                      |60000                                                            |
|verifyText                 |//div[@id='divBatchResults']/table||Deleted the following systems|
|Hard-Delete All Advanced                                                                     |
|List Systems                                                                                 |
|Check Batch Contents       |${PathToEthalon}ethalon_@filename.txt                            |
|Check Manage Batches Report|@filename                         ||Update Systems               |


!|scenario         |Hard-Delete All Advanced|
|Hard-Delete System|klbatchsys3             |
|Hard-Delete System|klbatchsys4             |
|Hard-Delete System|klbatchsys5             |
|Hard-Delete System|klbatchsys6             |
|Hard-Delete System|klbatchsys7             |
|Hard-Delete System|klbatchsys8             |
|Hard-Delete System|klbatchsys9             |
|Hard-Delete System|klbatchsys30            |
|Hard-Delete System|klbatchsys31            |
|Hard-Delete System|klbatchsys32            |
|Hard-Delete System|klbatchsys33            |
|Hard-Delete System|klbatchsys34            |
|Hard-Delete System|klbatchsys35            |
|Hard-Delete System|klbatchsys36            |
|Hard-Delete System|klbatchsys37            |
|Hard-Delete System|klbatchsys38            |
|Hard-Delete System|klbatchsys39            |
|Hard-Delete System|klbatchsys40            |
|Hard-Delete System|klbatchsys41            |
|Hard-Delete System|klbatchsys42            |
|Hard-Delete System|klbatchsys43            |
|Hard-Delete System|klbatchsys44            |
|Hard-Delete System|klbatchsys45            |
|Hard-Delete System|klbatchsys46            |
|Hard-Delete System|klbatchsys47            |
|Hard-Delete System|klbatchsys48            |
|Hard-Delete System|klbatchsys49            |
|Hard-Delete System|klbatchsys50            |
|Hard-Delete System|klbatchsys51            |
|Hard-Delete System|klbatchsys52            |
|Hard-Delete System|klbatchsys53            |
|Hard-Delete System|klbatchsys54            |
|Hard-Delete System|klbatchsys55            |
|Hard-Delete System|klbatchsys56            |
|Hard-Delete System|klbatchsys57            |
|Hard-Delete System|klbatchsys58            |
|Hard-Delete System|klbatchsys59            |
|Hard-Delete System|klbatchsys60            |
|Hard-Delete System|klbatchsys61            |
|Hard-Delete System|klbatchsys62            |



!|scenario            |Batch Import Systems for Performance|filename                        |
|clickAndWait         |link=Import Systems                 |                                |
|pause                |2000                                                                 |
|click                |id=PAMUploadBtnSelect                                                |
|SWait                |browse.PNG                                                           |
|SClick               |browse.PNG                                                           |
|pause                |1500                                                                 |
|SType                |${PathToBatch}@filename.$Extention                                   |
|pause                |1500                                                                 |
|SWait                |open.PNG                                                             |
|SClick               |open.PNG                                                             |
|pause                |2000                                                                 |
|SWait                |upload_small.PNG                                                     |
|SClick               |upload_small.PNG                                                     |
|pause                |2000                                                                 |
|type;                |id=Comment2                         |import systems                  |
|click                |id=btnProcessFile                   |                                |
|pause                |1500                                                                 |
|waitForElementPresent|//tr[@id='129']                                                      |
|verifyText           |//div[@id='divBatchResults']/table/ ||Systems were successfully added|
|List Systems                                                                               |
|Check Batch Contents |${PathToEthalon}ethalon_@filename.txt                                |

!|scenario            |Batch Delete Systems for Performance|filename                      |
|clickAndWait         |link=Update Systems                 |                              |
|pause                |2000                                                               |
|click                |id=PAMUploadBtnSelect                                              |
|SWait                |browse.PNG                                                         |
|SClick               |browse.PNG                                                         |
|pause                |1500                                                               |
|SType                |${PathToBatch}@filename.$Extention                                 |
|pause                |1500                                                               |
|SWait                |open.PNG                                                           |
|SClick               |open.PNG                                                           |
|pause                |2000                                                               |
|SWait                |upload_small.PNG                                                   |
|SClick               |upload_small.PNG                                                   |
|pause                |2000                                                               |
|click                |id=Radio1                           |                              |
|type;                |id=Comment2                         |delete systems                |
|click                |id=btnProcessFile                   |                              |
|pause                |1500                                                               |
|waitForElementPresent|//tr[@id='129']                                                    |
|verifyText           |//div[@id='divBatchResults']/table  ||Deleted the following systems|
|Hard-Delete All for Performance                                                          |
|List Systems                                                                             |
|Check Batch Contents |${PathToEthalon}ethalon_@filename.txt                              |


!|scenario         |Hard-Delete All for Performance                                                            |
|stop                                                                                                          |
|start             |Slim Selenium Driver|${seleniumHost}|${seleniumPort}|${seleniumBrowser}|https://${TPAMHost}|
|setTimeoutSeconds |30                                                                                         |
|Open              |${TPAMURL}          |               |${TPAMAdmin}   |                  |${DefaultPwd}      |
|Hard-Delete System|klbatchsys13                                                                               |
|Hard-Delete System|klbatchsys14                                                                               |
|Hard-Delete System|klbatchsys15                                                                               |
|Hard-Delete System|klbatchsys16                                                                               |
|Hard-Delete System|klbatchsys17                                                                               |
|Hard-Delete System|klbatchsys18                                                                               |
|Hard-Delete System|klbatchsys19                                                                               |
|Hard-Delete System|klbatchsys130                                                                              |
|Hard-Delete System|klbatchsys131                                                                              |
|Hard-Delete System|klbatchsys132                                                                              |
|Hard-Delete System|klbatchsys133                                                                              |
|Hard-Delete System|klbatchsys134                                                                              |
|Hard-Delete System|klbatchsys135                                                                              |
|Hard-Delete System|klbatchsys136                                                                              |
|Hard-Delete System|klbatchsys137                                                                              |
|Hard-Delete System|klbatchsys138                                                                              |
|Hard-Delete System|klbatchsys139                                                                              |
|Hard-Delete System|klbatchsys140                                                                              |
|Hard-Delete System|klbatchsys141                                                                              |
|Hard-Delete System|klbatchsys142                                                                              |
|Hard-Delete System|klbatchsys143                                                                              |
|Hard-Delete System|klbatchsys144                                                                              |
|Hard-Delete System|klbatchsys145                                                                              |
|Hard-Delete System|klbatchsys146                                                                              |
|Hard-Delete System|klbatchsys147                                                                              |
|Hard-Delete System|klbatchsys148                                                                              |
|Hard-Delete System|klbatchsys149                                                                              |
|Hard-Delete System|klbatchsys150                                                                              |
|Hard-Delete System|klbatchsys151                                                                              |
|Hard-Delete System|klbatchsys152                                                                              |
|Hard-Delete System|klbatchsys153                                                                              |
|Hard-Delete System|klbatchsys154                                                                              |
|Hard-Delete System|klbatchsys155                                                                              |
|Hard-Delete System|klbatchsys156                                                                              |
|Hard-Delete System|klbatchsys157                                                                              |
|Hard-Delete System|klbatchsys158                                                                              |
|Hard-Delete System|klbatchsys159                                                                              |
|Hard-Delete System|klbatchsys160                                                                              |
|Hard-Delete System|klbatchsys161                                                                              |
|Hard-Delete System|klbatchsys162                                                                              |
|Hard-Delete System|klbatchsys23                                                                               |
|Hard-Delete System|klbatchsys24                                                                               |
|Hard-Delete System|klbatchsys25                                                                               |
|Hard-Delete System|klbatchsys26                                                                               |
|Hard-Delete System|klbatchsys27                                                                               |
|Hard-Delete System|klbatchsys28                                                                               |
|Hard-Delete System|klbatchsys29                                                                               |
|Hard-Delete System|klbatchsys230                                                                              |
|Hard-Delete System|klbatchsys231                                                                              |
|Hard-Delete System|klbatchsys232                                                                              |
|Hard-Delete System|klbatchsys233                                                                              |
|Hard-Delete System|klbatchsys234                                                                              |
|Hard-Delete System|klbatchsys235                                                                              |
|Hard-Delete System|klbatchsys236                                                                              |
|Hard-Delete System|klbatchsys237                                                                              |
|Hard-Delete System|klbatchsys238                                                                              |
|Hard-Delete System|klbatchsys239                                                                              |
|Hard-Delete System|klbatchsys240                                                                              |
|Hard-Delete System|klbatchsys241                                                                              |
|Hard-Delete System|klbatchsys242                                                                              |
|Hard-Delete System|klbatchsys243                                                                              |
|Hard-Delete System|klbatchsys244                                                                              |
|Hard-Delete System|klbatchsys245                                                                              |
|Hard-Delete System|klbatchsys246                                                                              |
|Hard-Delete System|klbatchsys247                                                                              |
|Hard-Delete System|klbatchsys248                                                                              |
|Hard-Delete System|klbatchsys249                                                                              |
|Hard-Delete System|klbatchsys250                                                                              |
|Hard-Delete System|klbatchsys251                                                                              |
|Hard-Delete System|klbatchsys252                                                                              |
|Hard-Delete System|klbatchsys253                                                                              |
|Hard-Delete System|klbatchsys254                                                                              |
|Hard-Delete System|klbatchsys255                                                                              |
|Hard-Delete System|klbatchsys256                                                                              |
|Hard-Delete System|klbatchsys257                                                                              |
|Hard-Delete System|klbatchsys258                                                                              |
|Hard-Delete System|klbatchsys259                                                                              |
|Hard-Delete System|klbatchsys260                                                                              |
|Hard-Delete System|klbatchsys261                                                                              |
|Hard-Delete System|klbatchsys262                                                                              |
|Hard-Delete System|klbatchsys3                                                                                |
|Hard-Delete System|klbatchsys4                                                                                |
|Hard-Delete System|klbatchsys5                                                                                |
|Hard-Delete System|klbatchsys6                                                                                |
|Hard-Delete System|klbatchsys7                                                                                |
|Hard-Delete System|klbatchsys8                                                                                |
|Hard-Delete System|klbatchsys9                                                                                |
|Hard-Delete System|klbatchsys30                                                                               |
|Hard-Delete System|klbatchsys31                                                                               |
|Hard-Delete System|klbatchsys32                                                                               |
|Hard-Delete System|klbatchsys33                                                                               |
|Hard-Delete System|klbatchsys34                                                                               |
|Hard-Delete System|klbatchsys35                                                                               |
|Hard-Delete System|klbatchsys36                                                                               |
|Hard-Delete System|klbatchsys37                                                                               |
|Hard-Delete System|klbatchsys38                                                                               |
|Hard-Delete System|klbatchsys39                                                                               |
|Hard-Delete System|klbatchsys40                                                                               |
|Hard-Delete System|klbatchsys41                                                                               |
|Hard-Delete System|klbatchsys42                                                                               |
|Hard-Delete System|klbatchsys43                                                                               |
|Hard-Delete System|klbatchsys44                                                                               |
|Hard-Delete System|klbatchsys45                                                                               |
|Hard-Delete System|klbatchsys46                                                                               |
|Hard-Delete System|klbatchsys47                                                                               |
|Hard-Delete System|klbatchsys48                                                                               |
|Hard-Delete System|klbatchsys49                                                                               |
|Hard-Delete System|klbatchsys50                                                                               |
|Hard-Delete System|klbatchsys51                                                                               |
|Hard-Delete System|klbatchsys52                                                                               |
|Hard-Delete System|klbatchsys53                                                                               |
|Hard-Delete System|klbatchsys54                                                                               |
|Hard-Delete System|klbatchsys55                                                                               |
|Hard-Delete System|klbatchsys56                                                                               |
|Hard-Delete System|klbatchsys57                                                                               |
|Hard-Delete System|klbatchsys58                                                                               |
|Hard-Delete System|klbatchsys59                                                                               |
|Hard-Delete System|klbatchsys60                                                                               |
|Hard-Delete System|klbatchsys61                                                                               |
|Hard-Delete System|klbatchsys62                                                                               |
|stop                                                                                                          |
|start             |Slim Selenium Driver|${seleniumHost}|${seleniumPort}|${seleniumBrowser}|https://${TPAMHost}|
|setTimeoutSeconds |${seleniumTimeout}                                                                         |
|Open              |${TPAMURL}          |               |${TPAMAdmin}   |                  |${DefaultPwd}      |



!|scenario   |XXXTest Expired Token|
|Prepare User|kl333user00 | |Basic |


!|scenario   |Test Expired Token|
|Prepare User|kl333user00||Basic|
|Prepare User|kl333user01||Basic|
|Prepare User|kl333user02||Basic|
|Prepare User|kl333user03||Basic|
|Prepare User|kl333user04||Basic|
|Prepare User|kl333user05||Basic|
|Prepare User|kl333user06||Basic|
|Prepare User|kl333user07||Basic|
|Prepare User|kl333user08||Basic|
|Prepare User|kl333user09||Basic|
|Prepare User|kl333user10||Basic|
|Prepare User|kl333user11||Basic|
|Prepare User|kl333user12||Basic|
|Prepare User|kl333user13||Basic|
|Prepare User|kl333user14||Basic|
|Prepare User|kl333user15||Basic|
|Prepare User|kl333user16||Basic|
|Prepare User|kl333user17||Basic|
|Prepare User|kl333user18||Basic|
|Prepare User|kl333user19||Basic|
|Prepare User|kl333user20||Basic|
|Prepare User|kl333user21||Basic|
|Prepare User|kl333user22||Basic|
|Prepare User|kl333user23||Basic|
|Prepare User|kl333user24||Basic|
|Prepare User|kl333user25||Basic|
|Prepare User|kl333user26||Basic|
|Prepare User|kl333user27||Basic|
|Prepare User|kl333user28||Basic|
|Prepare User|kl333user29||Basic|
|Prepare User|kl333user30||Basic|
|Prepare User|kl333user31||Basic|
|Prepare User|kl333user32||Basic|
|Prepare User|kl333user33||Basic|
|Prepare User|kl333user34||Basic|
|Prepare User|kl333user35||Basic|
|Prepare User|kl333user36||Basic|
|Prepare User|kl333user37||Basic|
|Prepare User|kl333user38||Basic|
|Prepare User|kl333user39||Basic|
|Prepare User|kl333user40||Basic|
|Prepare User|kl333user41||Basic|
|Prepare User|kl333user42||Basic|
|Prepare User|kl333user43||Basic|
|Prepare User|kl333user44||Basic|
|Prepare User|kl333user45||Basic|
|Prepare User|kl333user46||Basic|
|Prepare User|kl333user47||Basic|
|Prepare User|kl333user48||Basic|
|Prepare User|kl333user49||Basic|
|Prepare User|kl333user50||Basic|
|Prepare User|kl333user51||Basic|
|Prepare User|kl333user52||Basic|
|Prepare User|kl333user53||Basic|
|Prepare User|kl333user54||Basic|
|Prepare User|kl333user55||Basic|
|Prepare User|kl333user56||Basic|
|Prepare User|kl333user57||Basic|
|Prepare User|kl333user58||Basic|
|Prepare User|kl333user59||Basic|
|Prepare User|kl333user60||Basic|
|Prepare User|kl333user61||Basic|
|Prepare User|kl333user62||Basic|
|Prepare User|kl333user63||Basic|
|Prepare User|kl333user64||Basic|
|Prepare User|kl333user65||Basic|
|Prepare User|kl333user66||Basic|
|Prepare User|kl333user67||Basic|
|Prepare User|kl333user68||Basic|
|Prepare User|kl333user69||Basic|
|Prepare User|kl333user70||Basic|
|Prepare User|kl333user71||Basic|
|Prepare User|kl333user72||Basic|
|Prepare User|kl333user73||Basic|
|Prepare User|kl333user74||Basic|
|Prepare User|kl333user75||Basic|
|Prepare User|kl333user76||Basic|
|Prepare User|kl333user77||Basic|
|Prepare User|kl333user78||Basic|
|Prepare User|kl333user79||Basic|
|Prepare User|kl333user80||Basic|
|Prepare User|kl333user81||Basic|
|Prepare User|kl333user82||Basic|
|Prepare User|kl333user83||Basic|
|Prepare User|kl333user84||Basic|
|Prepare User|kl333user85||Basic|
|Prepare User|kl333user86||Basic|
|Prepare User|kl333user87||Basic|
|Prepare User|kl333user88||Basic|
|Prepare User|kl333user89||Basic|
|Prepare User|kl333user90||Basic|
|Prepare User|kl333user91||Basic|
|Prepare User|kl333user92||Basic|
|Prepare User|kl333user93||Basic|
|Prepare User|kl333user94||Basic|
|Prepare User|kl333user95||Basic|
|Prepare User|kl333user96||Basic|
|Prepare User|kl333user97||Basic|
|Prepare User|kl333user98||Basic|
|Prepare User|kl333user99||Basic|



!| scenario        |Change Pwd  |userName|         |currenPwd|  |newPwd |
|Login             |${TPAMURL}  |        |@userName|         |@currenPwd|
|pause             |15000                                               |
|type;             |id=sOldPwd  |@currenPwd                             |
|type;             |id=sPassword|@newPwd                                |
|type;             |id=sConfirm |@newPwd                                |
|pause             |2000                                                |
|click             |id=save                                             |
|click             |id=save                                             |
|waitForTextPresent|Your password has been successfully changed         |



!|scenario |Prepare User|UserName|          |UserType      |
|Add User  |@UserName   |        |${UserPwd}||@UserType    |
|pause     |5000                                           |
|Change Pwd|@UserName   |        |${UserPwd}||${DefaultPwd}|

!|scenario        |Add User|UserName                  |                  |Password                  |                  |UserType                  |
|$res=            |CLI     |${CLIBatch} AddUser --UserName @UserName --FirstName Ivan --LastName Ivanov --Password @Password  --UserType @UserType|
|Verify_Contain_OR|$res;;successful                                                                                                               |


!| scenario       |Remove User|userName                        |
|$res=            |CLI        |${CLIBatch} DeleteUser @userName|
|Verify_Contain_OR|$res;;successful                            |


!| scenario              |BFER 6459 Import Linux System with AD Functional Account|
|Login                   |${TPAMURL}    |    |${TPAMAdmin}   |   |${DefaultPwd}   |
|Import System           |${BatchImportAD}                                        |
|Import System           |${BatchImportLinux}                                     |
|Check Functional Account|klbatchlinux                                            |
|Delete Systems for BFER 6459                                                     |


!| scenario           |Import System                      |fileName                        |
|pause                |5000                                                                |
|clickAndWait         |link=Import Systems                |                                |
|pause                |2000                                                                |
|click                |id=PAMUploadBtnSelect                                               |
|SWait                |browse.PNG                                                          |
|SClick               |browse.PNG                                                          |
|pause                |1500                                                                |
|SType                |${PathToBatch}@fileName                                             |
|pause                |1500                                                                |
|SWait                |open.PNG                                                            |
|SClick               |open.PNG                                                            |
|pause                |2000                                                                |
|SWait                |upload_small.PNG                                                    |
|SClick               |upload_small.PNG                                                    |
|pause                |2000                                                                |
|type;                |id=Comment2                        |import systems                  |
|click                |id=btnProcessFile                  |                                |
|pause                |1500                                                                |
|waitForElementPresent|//tr[@id='5']                                                       |
|pause                |10000                                                               |
|verifyText           |//div[@id='divBatchResults']/table/||Systems were successfully added|




!| scenario             |Check Functional Account|systemName           |
|clickAndWait           |link=Manage Systems                           |
|type;                  |id=SystemNm             |@systemName          |
|click                  |id=Listing                                    |
|waitForElementPresent  |//td[contains(text(),'@systemName')]          |
|mouseDown              |//td[contains(text(),'@systemName')]          |
|click                  |//td[contains(text(),'@systemName')]          |
|click                  |id=Details                                    |
|pause                  |3000                                          |
|$res=                  |getSelectedLabel        |id=PlatformID        |
|Verify_Contain_OR      |$res;;Linux                                   |
|click                  |id=Connection                                 |
|waitForElementPresent  |id=cb_AllowFuncReqFl                          |
|$res=                  |isChecked               |id=cb_funcacct_domain|
|Verify_Contain_OR      |$res;;true                                    |
|$res=                  |getSelectedLabel        |id=DAID              |
|Verify_Contain_OR_alnum|$res;;kltest.spb.qsft\_klfunc                 |


!|scenario            |Import Accounts                   |filename                         |
|clickAndWait         |link=Import Accounts              |                                 |
|pause                |2000                                                                |
|click                |id=PAMUploadBtnSelect                                               |
|SWait                |browse.PNG                                                          |
|SClick               |browse.PNG                                                          |
|pause                |1500                                                                |
|SType                |${PathToBatch}@filename                                             |
|pause                |1500                                                                |
|SWait                |open.PNG                                                            |
|SClick               |open.PNG                                                            |
|pause                |2000                                                                |
|SWait                |upload_small.PNG                                                    |
|SClick               |upload_small.PNG                                                    |
|pause                |2000                                                                |
|type;                |id=Comment2                       |import accounts                  |
|click                |id=btnProcessFile                 |                                 |
|pause                |1500                                                                |
|waitForElementPresent|//tr[@id='5']                                                       |
|pause                |15000                                                               |
|verifyText           |//div[@id='divBatchResults']/table||Accounts were successfully added|


!|scenario            |Batch Delete System               |filename                      |
|clickAndWait         |link=Update Systems               |                              |
|pause                |2000                                                             |
|click                |id=PAMUploadBtnSelect                                            |
|SWait                |browse.PNG                                                       |
|SClick               |browse.PNG                                                       |
|pause                |1500                                                             |
|SType                |${PathToBatch}@filename                                          |
|pause                |1500                                                             |
|SWait                |open.PNG                                                         |
|SClick               |open.PNG                                                         |
|pause                |2000                                                             |
|SWait                |upload_small.PNG                                                 |
|SClick               |upload_small.PNG                                                 |
|pause                |2000                                                             |
|click                |id=Radio1                         |                              |
|type;                |id=Comment2                       |delete systems                |
|click                |id=btnProcessFile                 |                              |
|pause                |1500                                                             |
|waitForElementPresent|//tr[@id='5']                                                    |
|pause                |10000                                                            |
|verifyText           |//div[@id='divBatchResults']/table||Deleted the following systems|


!|scenario            |Update Accounts                   |filename                                 |
|clickAndWait         |link=Update Accounts              |                                         |
|pause                |2000                                                                        |
|click                |id=PAMUploadBtnSelect                                                       |
|SWait                |browse.PNG                                                                  |
|SClick               |browse.PNG                                                                  |
|pause                |1500                                                                        |
|SType                |${PathToBatch}@filename                                                     |
|pause                |1500                                                                        |
|SWait                |open.PNG                                                                    |
|SClick               |open.PNG                                                                    |
|pause                |2000                                                                        |
|SWait                |upload_small.PNG                                                            |
|SClick               |upload_small.PNG                                                            |
|pause                |2000                                                                        |
|click                |id=Radio2                         |                                         |
|type;                |id=Comment2                       |update accounts                          |
|click                |id=btnProcessFile                 |                                         |
|pause                |1500                                                                        |
|waitForElementPresent|//tr[@id='5']                                                               |
|pause                |15000                                                                       |
|verifyText           |//div[@id='divBatchResults']/table||The following Accounts are being updated|


!|scenario            |Check Allow ISA Duration Flag        |systemName||accountName||result|
|clickAndWait         |link=Manage Accounts                                                 |
|type;                |id=SystemNm                          |@systemName                    |
|type;                |id=AccountNm                         |@accountName                   |
|click                |id=Listing                           |                               |
|waitForElementPresent|//td[contains(text(),'@accountName')]|                               |
|mouseDown            |//td[contains(text(),'@accountName')]|                               |
|click                |//td[contains(text(),'@accountName')]|                               |
|click                |id=Details                           |                               |
|pause                |3000                                                                 |
|click                |id=Management                                                        |
|waitForElementPresent|id=cb_PullFromParentFl                                               |
|$res=                |isChecked                            |id=cb_AllowISADuration         |
|Verify_Contain_OR    |$res;;@result                                                        |


!|scenario          |Delete Systems for BFER 6459|
|Batch Delete System|${BatchImportLinux}         |
|Batch Delete System|${BatchImportAD}            |


!|scenario                    |BFER 6460 Set Allow ISA Duration Flag  |
|Login                        |${TPAMURL}||${TPAMAdmin}||${DefaultPwd}|
|Import System                |system_import_bfer_6460.csv            |
|Import Accounts              |accounts_import_bfer_6460.csv          |
|Check Allow ISA Duration Flag|klupd     ||account1    ||false        |
|Check Allow ISA Duration Flag|klupd     ||account2    ||false        |
|Check Allow ISA Duration Flag|klupd     ||account3    ||false        |
|Update Accounts              |accounts_update_bfer_6460.csv          |
|Check Allow ISA Duration Flag|klupd     ||account1    ||true         |
|Check Allow ISA Duration Flag|klupd     ||account2    ||true         |
|Check Allow ISA Duration Flag|klupd     ||account3    ||true         |
|Batch Delete System          |system_import_bfer_6460.csv            |

!|scenario        |Set User Permission on System Level|userName                 |                 |userPermission                 |                 |systemName                 |
|$res=            |CLI                                |${CLIBatch} SetAccessPolicy --AccessPolicyName @userPermission --Action ADD --SystemName @systemName --UserName @userName|
|Verify_Contain_OR|$res;;successful                                                                                                                                             |

!|scenario        |Set Approvers Count|SystemName               |               |AccountName               |              |ApprCount              |
|$res=            |CLI                |${CLIBatch} UpdateAccount --SystemName @SystemName --AccountName @AccountName --MinimumApprovers @ApprCount|
|Verify_Contain_OR|$res;;successful                                                                                                               |

!| scenario       |Retrieve Password|systemName                         |                         |accountName                        |
|$res=            |CLI              |${CLIBatch} AddPwdRequest --SystemName @systemName --AccountName @accountName --RequestNotes test|
|Verify_Contain_OR|$res;;submitted                                                                                                    |
|$RequestID=      |get_RequestID    |$res                                                                                             |
|$GeneratedPwd=   |CLI              |${CLIBatch} Retrieve --RequestID $RequestID                                                      |
|Verify_Contain_OR|$GeneratedPwd;;grain41R                                                                                            |


!|scenario                          |BFER 6856 Cisco ENABLE Account Created When System Imported|
|Login                              |${TPAMURL}       |    |${TPAMAdmin}   |   |${DefaultPwd}   |
|Import System                      |system_import_bfer_6856.csv                                |
|Set User Permission on System Level|${CLI_user_1}    |    |Requestor      |   |k6856cisco      |
|Set Approvers Count                |k6856cisco       |    |ENABLE         |   |0               |
|Retrieve Password                  |k6856cisco       |    |ENABLE                              |
|Batch Delete System                |system_import_bfer_6856.csv                                |

