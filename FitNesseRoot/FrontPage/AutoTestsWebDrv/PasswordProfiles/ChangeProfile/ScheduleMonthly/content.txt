!*> Includes
''System''
!include -c <AutoTestsWebDrv.PlatformsTesting.WindowsLocalHost
''Libraries''
!include -c <AutoTestsWebDrv.UsersTests.UserTypes.ScenarioLibrary
!include -c <PasswordProfiles.ScenarioLibrary
*!

!define ChangeTimeout {20}
!define ChangeTimeoutMessage {Change Timeout: ${ChangeTimeout} seconds}

''Change Monthly First day schedule message only ''

!|script                                                                                                                                                                                     |
|Open             |${TPAMURL} ||${TPAMAdmin}                                                                                                                                  ||${DefaultPwd}|
|Add Account      |${CLIBatch}||--SystemName ${SystemName} --AccountName ${ManagedAccount} --Password \"${ManagedAccountPwd}\" --PasswordChangeProfile ${MonthlyFirstSchedule}||successfully |
|Management tab   |${ManagedAccount}                                                                                                                                                         |
|Change Schedule  |${MothlySchedule1}                                                                                                                                                        |
|Change Timeout   |${ChangeTimeoutMessage}                                                                                                                                                   |
|Change Retry Time|${ChangeRetryTimeMessage}                                                                                                                                                 |
|Update Account   |${CLIBatch}||--SystemName ${SystemName} --AccountName ${ManagedAccount} --PasswordChangeProfile "!NULL" --AutoFlag N                                       ||successfully |
|Delete Account   |${CLIBatch}||--SystemName ${SystemName}  --AccountName ${ManagedAccount}                                                                                   ||successfully |
|stop                                                                                                                                                                                        |

''Change Monthly Last day schedule message only ''

!|script                                                                                                                                                                                    |
|Open             |${TPAMURL} ||${TPAMAdmin}                                                                                                                                 ||${DefaultPwd}|
|Add Account      |${CLIBatch}||--SystemName ${SystemName} --AccountName ${ManagedAccount} --Password \"${ManagedAccountPwd}\" --PasswordChangeProfile ${MonthlyLastSchedule}||successfully |
|Management tab   |${ManagedAccount}                                                                                                                                                        |
|Change Schedule  |${MothlySchedule2}                                                                                                                                                       |
|Change Timeout   |${ChangeTimeoutMessage}                                                                                                                                                  |
|Change Retry Time|${ChangeRetryTimeMessage}                                                                                                                                                |
|Update Account   |${CLIBatch}||--SystemName ${SystemName} --AccountName ${ManagedAccount} --PasswordChangeProfile "!NULL" --AutoFlag N                                      ||successfully |
|Delete Account   |${CLIBatch}||--SystemName ${SystemName}  --AccountName ${ManagedAccount}                                                                                  ||successfully |
|stop                                                                                                                                                                                       |

''Change Monthly Days of month schedule message only ''

!|script                                                                                                                                                                                      |
|Open             |${TPAMURL} ||${TPAMAdmin}                                                                                                                                   ||${DefaultPwd}|
|Add Account      |${CLIBatch}||--SystemName ${SystemName} --AccountName ${ManagedAccount} --Password \"${ManagedAccountPwd}\" --PasswordChangeProfile ${MonthlyDaysOfSchedule}||successfully |
|Management tab   |${ManagedAccount}                                                                                                                                                          |
|Change Schedule  |${MothlySchedule3}                                                                                                                                                         |
|Change Timeout   |${ChangeTimeoutMessage}                                                                                                                                                    |
|Change Retry Time|${ChangeRetryTimeMessage}                                                                                                                                                  |
|Update Account   |${CLIBatch}||--SystemName ${SystemName} --AccountName ${ManagedAccount} --PasswordChangeProfile "!NULL" --AutoFlag N                                        ||successfully |
|Delete Account   |${CLIBatch}||--SystemName ${SystemName}  --AccountName ${ManagedAccount}                                                                                    ||successfully |
