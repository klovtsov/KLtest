!include -c <AutoTestsWebDrv.UsersTests.UserTypes.ScenarioLibrary

!define CSVEthalonFile {${ProjDir}\Scripts\Ethalons\ListOperations\Export\ExportGroups.csv}
!define ASPEthalonFile {${ProjDir}\Scripts\Ethalons\ListOperations\Export\ExportGroups.xls}
!define CSVResultFile {${ProjDir}\Scripts\Ethalons\ListOperations\ExportGroups.csv}
!define ASPResultFile {${ProjDir}\Scripts\Ethalons\ListOperations\ExportGroups.xls}
!define CSVMembersEthalonFile {${ProjDir}\Scripts\Ethalons\ListOperations\Export\ExportGroupMembers.csv}
!define ASPMembersEthalonFile {${ProjDir}\Scripts\Ethalons\ListOperations\Export\ExportGroupMembers.xls}
!define CSVMembersResultFile {${ProjDir}\Scripts\Ethalons\ListOperations\ExportGroupMembers.csv}
!define ASPMembersResultFile {${ProjDir}\Scripts\Ethalons\ListOperations\ExportGroupMembers.xls}
!define PathResultFile {${ProjDir}\Scripts\Ethalons\ListOperations\*.csv}

!define GroupIDRegExp {(\"\d+\")}

!define SystemName {${prefix}ListSystem}
!define SystemName1 {${SystemName}1}
!define SystemName2 {${SystemName}12}
!define SystemName3 {${SystemName}13}

!define UserName {${prefix}ListUser}
!define UserName1 {${UserName}1}
!define UserName2 {${UserName}2}
!define UserName3 {${UserName}3}

!define GroupName {${prefix}ListGroup}
!define GroupName1 {${GroupName}1}
!define GroupName2 {${GroupName}12}

!include -c <AutoTestsWebDrv.ListOperations.ScenarioLibrary

!|script                                                                                                                                                     |
|Add User         |${CLIBatch} ||--UserName ${UserName1} --FirstName Mr --LastName White                                       ||successfully                |
|Add User         |${CLIBatch} ||--UserName ${UserName2} --FirstName Mr --LastName Black                                       ||successfully                |
|Add Group        |${CLIBatch} ||--GroupName ${GroupName1}                                                                     ||successfully                |
|Add Grp member   |${CLIBatch} ||--GroupName ${GroupName1} --UserName ${UserName1}                                             ||successfully                |
|Add Grp member   |${CLIBatch} ||--GroupName ${GroupName1} --UserName ${UserName2}                                             ||successfully                |
|Add Group        |${CLIBatch} ||--GroupName ${GroupName2}                                                                     ||successfully                |
|Add Grp member   |${CLIBatch} ||--GroupName ${GroupName2} --UserName ${UserName1}                                             ||successfully                |
|Add Grp member   |${CLIBatch} ||--GroupName ${GroupName2} --UserName ${UserName2}                                             ||successfully                |
|Add System       |${CLIBatch} ||--SystemName ${SystemName1} --Platform Windows --NetworkAddress 1.1.1.1                       ||successfully                |
|Add System       |${CLIBatch} ||--SystemName ${SystemName2} --Platform Windows --NetworkAddress 1.1.1.1                       ||successfully                |
|Set Access Policy|${CLIBatch} ||--SystemName ${SystemName1} --Action ADD --AccessPolicyNam Approver --GroupName ${GroupName1} ||successfully                |
|Set Access Policy|${CLIBatch} ||--SystemName ${SystemName2} --Action ADD --AccessPolicyNam Requestor --GroupName ${GroupName1}||successfully                |
|pause            |30000                                                                                                                                     |
|List Groups                                                                                                                                                 |
|GroupID replacer                                                                                                                                            |
|Check Groups Export                                                                                                                                         |
|Open             |${TPAMURL}  ||${TPAMAdmin}                                                                                  ||${DefaultPwd}               |
|Group Listing    |${UserName}*||!=${GroupName2}                                                                               ||${GroupName1}||${GroupName2}|
|stop                                                                                                                                                        |
|Delete System    |${CLIBatch} ||--SystemName ${SystemName1}                                                                   ||successfully                |
|Delete System    |${CLIBatch} ||--SystemName ${SystemName2}                                                                   ||successfully                |
|Delete User      |${CLIBatch} ||--UserName ${UserName1}                                                                       ||successfully                |
|Delete User      |${CLIBatch} ||--UserName ${UserName2}                                                                       ||successfully                |
|Drop Group       |${CLIBatch} ||--GroupName ${GroupName1}                                                                     ||successfully                |
|Drop Group       |${CLIBatch} ||--GroupName ${GroupName2}                                                                     ||successfully                |


