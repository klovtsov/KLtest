!* Test Description
Windows platform specific flags checked
*!
!include <AutomatedTesting.PlatformsTesting.EdmzSpcwDc2
!define SystemName {${prefix}_winad}
!define SystemPlatform {Windows Active Dir}

!include -c  <PowerShellNetApiScenarios.ScenarioLibrary

!|script                                                                                                                                                                                                                                                                                                                                                                        |
|Add system             |${SystemName}                                                                                                                |with address|${SystemAddress}|platform    |"${SystemPlatform}"|managed by|${FunctAcct}|additional parameters|-functAcctPwd ${FunctAcctPwd} -domainName ${DomainName} -NetBiosName ${NETBIOSDomainName} -NonPrivFuncFlag Y|
|Add account            |${ManagedAccount}                                                                                                            |on system   |${SystemName}   |with options|-ChangeServiceFlag N -ChangeTaskFlag Y                                                                                                                                        |
|Add account            |${ManagedAccount}1                                                                                                           |on system   |${SystemName}   |with options|-ChangeServiceFlag Y -ChangeTaskFlag N -RestartServiceFlag N                                                                                                                  |
|Add account            |${ManagedAccount}2                                                                                                           |on system   |${SystemName}   |with options|-ChangeServiceFlag Y -ChangeTaskFlag N -RestartServiceFlag Y                                                                                                                  |
|List Accounts by filter|-systemName ${SystemName} -AccountName ${ManagedAccount} -propsToList accountname,chgSvcFl,changeTaskFlag                    |contains    |${ManagedAccount}.*N.*Y                                                                                                                                                                                     |
|List Accounts by filter|-systemName ${SystemName} -AccountName ${ManagedAccount}1 -propsToList accountname,chgSvcFl,changeTaskFlag,restartServiceFlag|contains    |${ManagedAccount}.*Y.*N.*N                                                                                                                                                                                  |
|List Accounts by filter|-systemName ${SystemName} -AccountName ${ManagedAccount}2 -propsToList accountname,chgSvcFl,changeTaskFlag,restartServiceFlag|contains    |${ManagedAccount}.*Y.*N.*Y                                                                                                                                                                                  |
|Delete System          |${SystemName}                                                                                                                                                                                                                                                                                                                                          |
