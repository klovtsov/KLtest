!* Test Description
If an account is set to reset password on login, TPAM will reset the password and flag is reset by virtue of the password change.
*!
!include <AutoTestsWebDrv.CliScenarios.WindowsActiveDirTwelve
!define dcName {kldozen}

#!include -c <AutoTestsWebDrv.PlatformsTesting.EdmzSpcwDc2
#!define SystemName {${prefix}_winad}
#!define SystemPlatform {Windows Active Dir}
#!define dcName {plitz}

!include -c  <PowerShellNetApiScenarios.ScenarioLibrary

!*> Create environment
!|script                                                                                                                                                                                                                                                           |
|Create Account on System                |                                                                                                                                                                                                                         |
|Set User must change pwd on logon flag                                                                                                                                                                                                                            |
|Check User must change pwd on logon flag|True                                                                                                                                                                                                                     |
|Add system                              |${SystemName}    |with address|${SystemAddress} |platform    |"${SystemPlatform}"|managed by|${FunctAcct}|additional parameters|-functAcctPwd ${FunctAcctPwd} -domainName ${DomainName} -NetBiosName ${NETBIOSDomainName}|
|Test System                             |${TestSystemSuccessful}                                                                                                                                                                                                  |
|Add account                             |${ManagedAccount}|on system   |${SystemName}    |with options|-Password ${ManagedAccountPwdNew} -MinimumApprovers 0                                                                                                      |
|Set Permissions                         |"PPM Requestor"  |on  account |${ManagedAccount}|for user    |${API_user_1}                                                                                                                                              |
*!
!|script                                                            |
|Reset Password                          |${ResetPasswordSuccessful}|
|Check User must change pwd on logon flag|False                     |
|Request Pwd by                          |${API_user_1}             |
|Get Login                                                          |

!*> Remove All
!|script                                   |
|Delete System           |${SystemName}    |
|Delete Account on System|${ManagedAccount}|
*!
