!include -c <AutoTestsWebDrv.ScenarioLibrary
!include -c <AutoTestsWebDrv.CliScenarios.ScenarioLibrary
!include -c <AutoTestsWebDrv.PlatformsTesting.EdmzSpcw2.PlatformSpecific
!include -c <FrontPage.AutomatedTesting.KnownIssues
!include -c <AutoTestsWebDrv.EspcwClientScenarios.DomainUser.ScenarioLibrary

!define FailedLogEntry {The specified network password is not correct}
!define SuccessLogEntry {The password change operation completed successfully}

!|script                                                                               |
|Change Account Password on System|${ManagedAccountPwdNew}                             |
|ClearClientLogFile on            |${SystemAddress}                                    |
|Check Checkbox on DC             |useoldpass        |for user|DEFAULT                 |
|Check Password                   |${ManagedAccount} |        |${CheckPasswordNotMatch}|
|pause                            |${ExecDelay}                                        |
|ClientLogFileContains            |${FailedLogEntry} |on      |${SystemAddress}        |
|ClearClientLogFile on            |${SystemAddress}                                    |
|Uncheck Checkbox on DC           |useoldpass        |for user|DEFAULT                 |
|Check Password                   |${ManagedAccount} |        |${CheckPasswordNotMatch}|
|pause                            |${ExecDelay}                                        |
|ClientLogFileContains            |${SuccessLogEntry}|on      |${SystemAddress}        |
#|Check Checkbox on DC             |useoldpass        |for user|DEFAULT                 |
