!contents

#!|scenario|Create logon script                                                         |
#|runBatch |logon;create;${SystemAddress};${FunctAcct};${FunctAcctPwd};${ManagedAccount};${OSType}|

!|scenario        |Create logon script                                                                                     |
|$res=            |RunBatchGetOutput|logon;create;${SystemAddress};${FunctAcct};${FunctAcctPwd};${ManagedAccount};${OSType}|
|Verify_Contain_OR|$res;;touch.*${ManagedAccount}.*successfully                                                            |

!|scenario        |Check logon script                                                                                     |
|$res=            |RunBatchGetOutput|logon;check;${SystemAddress};${FunctAcct};${FunctAcctPwd};${OSType};${ManagedAccount}|
|Verify_Contain_OR|$res;;successfully                                                                                     |


!|scenario|Delete logon script                                                                   |
|runBatch |logon;delete;${SystemAddress};${FunctAcct};${FunctAcctPwd};${ManagedAccount};${OSType}|

!|scenario            |Open Session Do Nothing|requestorName         |                       |systemName         |         |accountName         |         |responceAction        |
|$res=                |CLI                    |${CLIBatch} AddSessionRequest --SystemName @systemName --AccountName @accountName --ForUserName @requestorName --RequestNotes test|
|Verify_Contain_OR    |$res;;submitted                                                                                                                                           |
|$RequestID=          |get_session_RequestID  |$res                                                                                                                              |
|Login                |${TPAMURL}             |                      |@requestorName         |                   |${UserPwd}                                                     |
|pause                |5000                                                                                                                                                      |
|click                |id=CurrentRequests                                                                                                                                        |
|waitForElementPresent|link=$RequestID                                                                                                                                           |
|clickAndWait         |link=$RequestID                                                                                                                                           |
|waitForElementPresent|id=StartSessionButton                                                                                                                                     |
|click                |id=StartSessionButton                                                                                                                                     |
|pause                |30000                                                                                                                                                     |
|selectWindow         |Quest Software PSM Session (${SystemName}/${ManagedAccount}/$RequestID)                                                                                   |
|pause                |5000                                                                                                                                                      |
|windowMaximize                                                                                                                                                                  |
|windowFocus                                                                                                                                                                     |
|pause                |5000                                                                                                                                                      |
|SWaitMultipleV2      |60;Accept.png;Accept2.png                                                                                                                                 |
|SClickMultiple       |Accept.png;Accept2.png                                                                                                                                    |
|pause                |150000                                                                                                                                                    |
|Cancel Session Request                                                                                                                                                          |

