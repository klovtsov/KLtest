!define groupName {${prefix}testGrp}
!define groupDescription {la-la-la}

!include -c <AutoTestsWebDrv.PowerShellNetApiScenarios.ScenarioLibrary
!include -c <PropagateOptionsFromTemplate.ScenarioLibrary

!4 Create example user, group and add user to the group as member.
!|script                                         |
|Add User  |${TestUserName}                      |
|Add Group |${groupName}                         |
|Add Member|${TestUserName}|to group|${groupName}|

!3 "Retain Group Membership in the template" is checked.
!4 Create a template from the existing user. Then a new user is generated by a created template.
!|script                                                                                                         |
|Make User Template|${TemplateName}|from         |${TestUserName}|retain permissions|false|retain membership|true|
|Create User       |${newUserName} |from template|${TemplateName}                                                |

!4 Check group membership
!|script                                                                                                  |
|List Groups Membership by filter|-groupName ${groupName}|and result contains|${groupName}.*${newUserName}|

!4 Delete the new user and the template.
!|script                             |
|Delete User         |${newUserName} |
|Delete User Template|${TemplateName}|

!3 "Retain Group Membership in the template" is unchecked.
!|script                                                                                                          |
|Make User Template|${TemplateName}|from         |${TestUserName}|retain permissions|false|retain membership|false|
|Create User       |${newUserName} |from template|${TemplateName}                                                 |

!4 Check group membership
!|script                                                                                                  |
|List Groups Membership by filter|-groupName ${groupName}|and result does not contain|${newUserName}|

!4 Delete the group
!|script                  |
|Delete Group|${groupName}|
