!*> Includes
''System''
!include -c <AutoTestsWebDrv.PlatformsTesting.WindowsLocalHost
''Libraries''
!include -c <AutoTestsWebDrv.UsersTests.UserTypes.ScenarioLibrary
!include -c <PasswordProfiles.ScenarioLibrary
*!

''Mismatch - Lock''
!note Scheduled Check Password
!|script                                                                                                                                                                                                                                                                 |
|Open                     |${TPAMURL}       ||${TPAMAdmin}                                                                                                                        ||${DefaultPwd}                                                                        |
|Add Account              |${CLIBatch}      ||--SystemName ${SystemName} --AccountName ${ManagedAccount} --Password "WrongPWD" --PasswordCheckProfile ${CheckProfile4NismatchLock}||successfully                                                                         |
|pause                    |${defaultPause}                                                                                                                                                                                                                               |
|Check Test Log           |${ManagedAccount}||Failed - Password Mismatch                                                                                                                                                                                                 |
|Check Mismatch Mail      |${MailServer}    ||${SystemEMail}                                                                                                                      ||${SystemEMailPwd}||${FromMail}||${MailSubjectCheckMismatch}||${MailBodyCheckMismatch}|
|Check Account Lock Status|${ManagedAccount}||true                                                                                                                                                                                                                       |
|Check schedule disabled  |${ManagedAccount}||false                                                                                                                                                                                                                      |
|Management tab           |${ManagedAccount}                                                                                                                                                                                                                             |
|Check Schedule           |${DaylySchedule1}                                                                                                                                                                                                                             |
|Check Mismatch Action    |${MismatchLock}                                                                                                                                                                                                                               |
|Update Account           |${CLIBatch}      ||--SystemName ${SystemName} --AccountName ${ManagedAccount} --LockFlag N                                                             ||successfully                                                                         |
|Check Account Lock Status|${ManagedAccount}||false                                                                                                                                                                                                                      |
|Delete Mails             |${SystemEMail}                                                                                                                                                                                                                                |

!note Manual Check Password
!|script                                                                                                                                                                                                                                          |
|Check Password                  |${CLIBatch}      ||--SystemName ${SystemName} --AccountName ${ManagedAccount}                                            ||The stored password for ${ManagedAccount} DOES NOT MATCH the managed system          |
|Check Test Log                  |${ManagedAccount}||Failed - Password Mismatch                                                                                                                                                                   |
|pause                           |${defaultPause}                                                                                                                                                                                                 |
|Check Account Lock Status       |${ManagedAccount}||true                                                                                                                                                                                         |
|Check schedule disabled         |${ManagedAccount}||false                                                                                                                                                                                        |
|Check Mismatch Mail             |${MailServer}    ||${SystemEMail}                                                                                        ||${SystemEMailPwd}||${FromMail}||${MailSubjectCheckMismatch}||${MailBodyCheckMismatch}|
|Management tab                  |${ManagedAccount}                                                                                                                                                                                               |
|Check Consecutive Check Failures|0                                                                                                                                                                                                               |
|Update Account                  |${CLIBatch}      ||--SystemName ${SystemName} --AccountName ${ManagedAccount} --PasswordCheckProfile "!NULL" --AutoFlag N||successfully                                                                         |
|Delete Account                  |${CLIBatch}      ||--SystemName ${SystemName}  --AccountName ${ManagedAccount}                                           ||successfully                                                                         |
|Delete Mails                    |${SystemEMail}                                                                                                                                                                                                  |
|stop                                                                                                                                                                                                                                             |
