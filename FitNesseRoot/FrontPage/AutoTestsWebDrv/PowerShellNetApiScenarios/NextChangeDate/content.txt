!define ManagedAccount {${prefix}psAcnt}
!define pwdChangeProfile {First of Month}
!include -c <AutoTestsWebDrv.ScenarioLibrary
!include -c <PowerShellNetApiScenarios.ScenarioLibrary

!note The test is configured to work with a profile, which change an account password every first day of the month.

!*> Prepare Environment (creating system, account)
!|script                                                            |
|Create Account on System                                           |
|Add System                                                         |
|Test System|${TestSystemSuccessful}                                |
|Add account|${ManagedAccount}|with password|${ManagedAccountPwd}|
*!

!|script                                                                                                                                                                            |
|Set password Change Profile|"${pwdChangeProfile}"                                                                           |for account|${ManagedAccount}                         |
|Reset Password             |${ResetPasswordSuccessful}                                                                                                                           |
|Calculate next month                                                                                                                                                                                                                                                                          |
|List Accounts by filter    |-systemName ${SystemName} -AccountName ${ManagedAccount} -propsToList accountname,nextChangeDt|contains   |${ManagedAccount}.*$NextYear-$NextMonth-01|

!*> Clean Up
!|script                                   |
|Delete Account on System|${ManagedAccount}|
|Delete Account          |${ManagedAccount}|
|Delete System           |${SystemName}    |
*!
