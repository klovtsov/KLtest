!define ManagedAccount {${prefix}psAcnt}
!include -c <AutomatedTesting.ScenarioLibrary
!include -c <PowerShellNetApiScenarios.ScenarioLibrary

!*> Prepare Environment (creating system, account)
!|script                                                            |
|Create Account on System                                           |
|Add System                                                         |
|Test System|${TestSystemSuccessful}                                |
|Add account|${ManagedAccount}|with password|${ManagedAccountPwd}|
*!

!note Change Frequency 0 - First day of month
!3 List Accounts
!|script                                                                                                                                                                            |
|Set Change Frequency   |0                                                                                                                                                          |
|Schedule Reset Password|${CheckPasswordSuccessful}                                                                                                                                 |
|Calculate next month                                                                                                                                                                                                                                                                          |
|List Accounts by filter|-systemName ${SystemName} -AccountName ${ManagedAccount} -propsToList accountname,changefreq,nextChangeDt|contains|${ManagedAccount}.*0.*$NextYear-$NextMonth-01|

!*> Clean Up
!|script                                   |
|Delete Account on System|${ManagedAccount}|
|Delete Account          |${ManagedAccount}|
|Delete System           |${SystemName}    |
*!