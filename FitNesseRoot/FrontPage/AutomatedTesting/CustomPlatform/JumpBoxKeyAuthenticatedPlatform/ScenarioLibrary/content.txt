!contents





!|scenario      |Test UI Custom Platform      |
|Prepare UI Test                              |
|Check UI Tag Values Sent To Jump Box         |
|PPM UI Regular Activity                      |
|BFER 6457 Duplicate System Using Specific Key|
|PSM Activity                                 |
|Check Duplicated Platform                    |
|Batch Import System                          |
|Clear UI Test                                |




!|scenario                          |Prepare UI Test                                                    |
|Login                              |${TPAMURL}       ||${TPAMAdmin}        ||${DefaultPwd}             |
|Create Users                                                                                           |
|Login                              |${TPAMURL}       ||${TPAMAdmin}        ||${DefaultPwd}             |
|Add UI System                                                                                          |
|Update UI Account Description      |${FuncAcct}      ||${FuncAcctDescription}                          |
|Update Non-Managed Account Password|${FuncAcct}      ||${SystemRootPassword}                           |
|Create Account on System                                                                               |
|Add UI Account                     |${ManagedAccount}                                                  |
|Update UI Account Description      |${ManagedAccount}||${ManagedAccountDescription}                    |
|Prepare Batch Files                |${PathToBatch}   ||SystemPlaceholder   ||${BatchImportedSystemName}|
|Prepare Batch Files                |${PathToBatch}   ||PlatformPlaceholder ||${CustomPlatformName}     |
|Prepare Batch Files                |${PathToBatch}   ||IPAddressPlaceholder||${SystemAddress}          |



!|scenario         |Create Jump Box                                                                                                                            |
|Login             |${TPAMURL}                          |                   |${TPAMAdmin}                   |                  |${DefaultPwd}                  |
|pause             |5000                                                                                                                                       |
|clickAndWait      |link=Jump Box                                                                                                                              |
|pause             |3000                                                                                                                                       |
|click             |id=AddServerButton                                                                                                                         |
|pause             |5000                                                                                                                                       |
|type;             |id=JumpBoxName                      |${JumpBoxName}                                                                                        |
|type;             |id=NetworkAddress                   |${JumpBoxAddress}                                                                                     |
|type;             |id=Timeout                          |${JumpBoxTimeout}                                                                                     |
|type;             |id=Port                             |${JumpBoxPort}                                                                                        |
|type;             |id=AccountName                      |${JumpBoxAccount}                                                                                     |
|type;             |id=Comments                         |${JumpBoxDescription}                                                                                 |
|click             |id=SubmitChanges                                                                                                                           |
|waitForTextPresent|saved successfully                                                                                                                         |
|$res=             |getText                             |//div[@id='ResultsDiv']                                                                               |
|Verify_Contain_OR |$res;;saved successfully                                                                                                                   |
|pause             |1000                                                                                                                                       |
|click             |id=btGeneratePair1                                                                                                                         |
|waitForTextPresent|The key was successfully reset for ${JumpBoxName}                                                                                          |
|click             |id=TestButton                                                                                                                              |
|waitForTextPresent|Permission denied                                                                                                                          |
|$res=             |getText                             |//div[@id='resultsTab']                                                                               |
|Verify_Contain_OR |$res;;Permission denied                                                                                                                    |
|click             |id=btDnldSpcOpenSSH                                                                                                                        |
|pause             |10000                                                                                                                                      |
|runBatch          |UploadRootPublicSshKey.bat;${JumpBoxAddress};${JumpBoxRoot};${JumpBoxRootPassword};${BrowserDownloadDir};authorized_keys2;id_dsa.pub|
|pause             |10000                                                                                                                                      |
|click             |id=TestButton                                                                                                                              |
|waitForTextPresent|SUCCESS NOTIFICATION                                                                                                                       |
|$res=             |getText                             |//div[@id='resultsTab']                                                                               |
|Verify_Contain_OR |$res;;SUCCESS NOTIFICATION                                                                                                                 |
|runBatch          |UploadCustomScript.bat;${JumpBoxAddress};${JumpBoxRoot};${JumpBoxRootPassword};${JumpBoxScript};/usr/bin                                   |
|pause             |10000                                                                                                                                      |


!|scenario         |Create Custom Jump Box Platform                        |
|Login             |${TPAMURL}           |  |${TPAMAdmin} | |${DefaultPwd} |
|pause             |10000                                                  |
|clickAndWait      |link=Custom Platforms                                  |
|pause             |3000                                                   |
|click             |id=btnAddPlatform                                      |
|pause             |1000                                                   |
|type;             |id=CustomPlatformName|${CustomPlatformName}            |
|type;             |id=Description       |${CustomPlatformName} Description|
|select;           |id=PlatformTypeID    |label=Jump Box                   |
|pause             |1000                                                   |
|type;             |id=Port              |${WrongCustomPLatformPort}       |
|select;           |id=JumpBoxID         |label=${JumpBoxName}             |
|type;             |id=ScriptName        |${JumpBoxScript}                 |
|type;             |id=PlatSpecificLabel |My Label                         |
|click             |id=EnablePwdFl                                         |
|click             |id=NetBiosNameFl                                       |
|click             |id=DomainNameFl                                        |
|click             |id=ActiveFl                                            |
|pause             |1000                                                   |
|click             |id=AutomationActiveFl                                  |
|click             |id=btnSavePlatform                                     |
|waitForTextPresent|saved successfully                                     |
|$res=             |getText              |//div[@id='ResultsDiv']          |
|Verify_Contain_OR |$res;;saved successfully                               |

!|scenario         |Update Non-Managed Account Password|accountName||accountPassword|
|Choose Account    |@accountName                                                    |
|pause             |2000                                                            |
|click             |id=Details                         |                            |
|type;             |id=sPswd                           |@accountPassword            |
|pause             |1000                                                            |
|type;             |id=sConfPswd                       |@accountPassword            |
|pause             |1000                                                            |
|click             |id=SubmitChangesButton             |                            |
|waitForTextPresent|Changes saved successfully for                                  |



!|scenario            |Add UI System                                   |
|pause                |5000                                            |
|waitForElementPresent|link=Add System                                 |
|clickAndWait         |link=Add System                                 |
|waitForElementPresent|id=SystemName                                   |
|type;                |id=SystemName       |${SystemName}              |
|type;                |id=NetworkAddress   |${SystemAddress}           |
|select;              |id=PlatformID       |label=${CustomPlatformName}|
|type;                |id=PlatSpecificValue|${PlatformSpecificValue}   |
|click                |id=Connection       |                           |
|type;                |id=PARFuncAcct      |${FuncAcct}                |
|click                |id=rb_DSS                                       |
|pause                |1000                                            |
|click                |id=rb_Specific                                  |
|click                |id=btGeneratePair0                              |
|waitForTextPresent   |Successfully*generated*key pair                 |
|click                |id=btDnldSpcOpenSSH                             |
|pause                |20000                                           |
|Upload System Public Key                                              |
|type;                |id=EnablePwd        |${EnablePassword}          |
|type;                |id=ConfEnablePwd    |${EnablePassword}          |
|type;                |id=DomainName       |${DomainName}              |
|type;                |id=NetBiosName      |${NetBIOSDomainName}       |
|click                |id=bt_Save          |                           |
|waitForTextPresent   |System changes for * saved successfully         |
#|type;                |id=Port                                                        |${SystemPort}                                                        |

!| scenario      |Managed UI System|
|Test System     |successful       |
|Reset System Key|${SystemName}    |
|Test System     |failed;;timed out|
|Choose Account  |${FuncAcct}      |
|Check Password  |does not exist   |


!| scenario                       |Managed UI Account                  |
|Choose Account                   |${ManagedAccount}                   |
|Reset Password                   |error occurred changing the password|
|Schedule Reset Password          |Failed                              |
|Change Account Password on System|${ManagedAccountPwdNew}             |
|Upload System Public Key                                              |
|pause                            |${RestoreFunctAcctPasswordTimeout}  |
|Choose Account                   |${ManagedAccount}                   |
|Check Password                   |DOES NOT MATCH                      |
|pause                            |${RestoreFunctAcctPasswordTimeout}  |
|Check Status                     |Success   |for reason   |Mismatch   |
|Reset Password                   |successful                          |
|Choose Account                   |${ManagedAccount}                   |
|Schedule Reset Password          |Success                             |


!|scenario         |Reset System Key  |systemName  |
|Choose system     |@systemName                    |
|click             |id=Details                     |
|pause             |2000                           |
|click             |id=Connection                  |
|click             |id=btGeneratePair0             |
|waitForTextPresent|Successfully*generated*key pair|
|click             |id=btDnldSpcOpenSSH            |
|pause             |20000                          |



!|scenario|Upload System Public Key                                                                                                             |
|runBatch |UploadRootPublicSshKey.bat;${SystemAddress};${SystemRootName};${SystemRootPassword};${BrowserDownloadDir};authorized_keys;id_dsa.pub|


!|scenario          |Clear UI Test                                                   |
|Login              |${TPAMURL}    ||${TPAMAdmin}              ||${DefaultPwd}       |
|Remove Users                                                                        |
|Remove UI System                                                                    |
|Delete Account on System                                                            |
|Prepare Batch Files|${PathToBatch}||${BatchImportedSystemName}||SystemPlaceholder   |
|Prepare Batch Files|${PathToBatch}||${CustomPlatformName}     ||PlatformPlaceholder |
|Prepare Batch Files|${PathToBatch}||${SystemAddress}          ||IPAddressPlaceholder|
#|runBatch |DeleteFileByMask;${BrowserDownloadDir}id_dsa*;fake|


!|scenario    |Create Account on System                                                                                                           |
|accountAction|${SystemPlatform};;create;;${SystemAddress};;${SystemRootName};;${SystemRootPassword};;${ManagedAccount};;${ManagedAccountPassword}|

!|scenario    |Change Account Password on System                                      |NewPwd                                     |
|accountAction|${SystemPlatform};;password;;${SystemAddress};;${SystemRootName};;${SystemRootPassword};;${ManagedAccount};;@NewPwd|

!|scenario    |Login Account to System                    |ManPwd                    |
|accountAction|${SystemPlatform};;login;;${SystemAddress};;${ManagedAccount};;@ManPwd|

!|scenario    |Delete Account on System                                                                                |
|accountAction|${SystemPlatform};;delete;;${SystemAddress};;${SystemRootName};;${SystemRootPassword};;${ManagedAccount}|


!| scenario            |Test System Log                            |
|Check Log String      |OPERATION:CheckSystem                      |
|Check Log String      |FUNCTIONAL_ACCOUNT:${FuncAcct}             |
|Check Log String      |FUNC_ACC_PASSWORD:DSS                      |
|Check Regex Log String|KEY:-----BEGIN DSA PRIVATE KEY-----        |
|Check Log String      |SYSTEM_ADDRESS:${SystemAddress}            |
|Check Log String      |PORT:${SystemPort}                         |
|Check Log String      |PLATFORM_SPECIFIC:${PlatformSpecificValue} |
|Check Log String      |FUNC_ACC_DESCRIPTION:${FuncAcctDescription}|
|Check Log String      |ENABLE_PASSWORD:${EnablePassword}          |
|Check Log String      |DOMAIN:${DomainName}                       |
|Check Log String      |NETBIOS:${NetBIOSDomainName}               |


!| scenario            |Check Password Log                              |
|Check Log String      |OPERATION:CheckPassword                         |
|Check Log String      |FUNCTIONAL_ACCOUNT:${FuncAcct}                  |
|Check Log String      |FUNC_ACC_PASSWORD:DSS                           |
|Check Regex Log String|KEY:-----BEGIN DSA PRIVATE KEY-----             |
|Check Log String      |SYSTEM_ADDRESS:${SystemAddress}                 |
|Check Log String      |PORT:${SystemPort}                              |
|Check Log String      |PLATFORM_SPECIFIC:${PlatformSpecificValue}      |
|Check Log String      |FUNC_ACC_DESCRIPTION:${FuncAcctDescription}     |
|Check Log String      |ENABLE_PASSWORD:${EnablePassword}               |
|Check Log String      |DOMAIN:${DomainName}                            |
|Check Log String      |NETBIOS:${NetBIOSDomainName}                    |
|Check Log String      |MANAGED_ACCOUNT:${ManagedAccount}               |
|Check Log String      |MAN_ACC_PASSWORD:${ManagedAccountPassword}      |
|Check Log String      |MAN_ACC_DESCRIPTION:${ManagedAccountDescription}|


!| scenario            |Change Password Log                             |
|Check Log String      |OPERATION:ChangePassword                        |
|Check Log String      |FUNCTIONAL_ACCOUNT:${FuncAcct}                  |
|Check Log String      |FUNC_ACC_PASSWORD:DSS                           |
|Check Regex Log String|KEY:-----BEGIN DSA PRIVATE KEY-----             |
|Check Log String      |SYSTEM_ADDRESS:${SystemAddress}                 |
|Check Log String      |PORT:${SystemPort}                              |
|Check Log String      |PLATFORM_SPECIFIC:${PlatformSpecificValue}      |
|Check Log String      |FUNC_ACC_DESCRIPTION:${FuncAcctDescription}     |
|Check Log String      |ENABLE_PASSWORD:${EnablePassword}               |
|Check Log String      |DOMAIN:${DomainName}                            |
|Check Log String      |NETBIOS:${NetBIOSDomainName}                    |
|Check Log String      |MANAGED_ACCOUNT:${ManagedAccount}               |
|Check Log String      |OLD_MAN_ACC_PASSWORD:${ManagedAccountPassword}  |
|Check Regex Log String|NEW_MAN_ACC_PASSWORD:\w{6,10}                   |
|Check Log String      |MAN_ACC_DESCRIPTION:${ManagedAccountDescription}|



############# after fixing 6457 the first verifyText must be changed to "failed"

!| scenario        |BFER 6457 Duplicate System Using Specific Key            |
|Login             |${TPAMURL}                  ||${TPAMAdmin}||${DefaultPwd}|
|Choose system     |${SystemName}                                            |
|click             |id=Details                                               |
|click             |id=bt_Duplicate                                          |
|pause             |2000                                                     |
|type;             |id=SystemName               |${SystemName}New            |
|click             |id=bt_Save                                               |
|waitForTextPresent|System changes for ${SystemName}New saved successfully   |
|Choose system     |${SystemName}New                                         |
|click             |id=bt_Test                                               |
|waitForTextPresent|*from the test of system*                                |
|verifyText        |//div[@id='ResultDetailDiv']||failed                     |
|click             |id=Details                                               |
|pause             |1000                                                     |
|click             |id=Connection                                            |
|pause             |1000                                                     |
|click             |id=btDnldSpcOpenSSH                                      |
|pause             |20000                                                    |
|Upload System Public Key                                                    |
|pause             |10000                                                    |
|click             |id=bt_Test                                               |
|waitForTextPresent|*from the test of system*                                |
|verifyText        |//div[@id='ResultDetailDiv']||successful                 |
|Remove system     |${SystemName}New                                         |
|Hard-Delete System|${SystemName}New                                         |

!| scenario       |Prepare Batch Files  |path    |    |changeFrom   |   |changeTo   |
|$res=            |RunBatchGetOutputFull|PrepareEthalons;@path;@changeFrom;@changeTo|
|Verify_Contain_OR|$res;;write.*changes                                             |




!| scenario    |Batch Import System   |
|Standard Key System Import Failed    |
|Specific Key System Import Successful|

!| scenario           |Standard Key System Import Failed                                                                                                     |
|Login                |${TPAMURL}                         ||${TPAMAdmin}                        |                       |${DefaultPwd}                       |
|clickAndWait         |link=Import Systems                |                                                                                                  |
|pause                |2000                                                                                                                                  |
|click                |id=PAMUploadBtnSelect                                                                                                                 |
|SWait                |browse.PNG                                                                                                                            |
|SClick               |browse.PNG                                                                                                                            |
|pause                |1500                                                                                                                                  |
|SType                |${PathToBatch}\system_import_custom_platform_standard_key.csv                                                                         |
|pause                |1500                                                                                                                                  |
|SWait                |open.PNG                                                                                                                              |
|SClick               |open.PNG                                                                                                                              |
|pause                |2000                                                                                                                                  |
|SWait                |upload_small.PNG                                                                                                                      |
|SClick               |upload_small.PNG                                                                                                                      |
|pause                |2000                                                                                                                                  |
|click                |id=btnProcessFile                  |                                                                                                  |
|pause                |1500                                                                                                                                  |
|waitForElementPresent|//tr[@id='8']                                                                                                                         |
|pause                |30000                                                                                                                                 |
|verifyText           |//div[@id='divBatchResults']/table/||Custom Platform does not allow a DSS-authenticated functional account to use system standard keys|
|$res=                |CLI                                |${CLIBatch} ListSystems --SystemName ${BatchImportedSystemName}                                   |
|Verify_Contain_OR    |$res;;No Systems to list           |                                                                                                  |



!| scenario           |Specific Key System Import Successful                                                              |
|Login                |${TPAMURL}                         | |${TPAMAdmin}            |           |${DefaultPwd}           |
|clickAndWait         |link=Import Systems                |                                                               |
|pause                |2000                                                                                               |
|click                |id=PAMUploadBtnSelect                                                                              |
|SWait                |browse.PNG                                                                                         |
|SClick               |browse.PNG                                                                                         |
|pause                |1500                                                                                               |
|SType                |${PathToBatch}\system_import_custom_platform_specific_key.csv                                      |
|pause                |1500                                                                                               |
|SWait                |open.PNG                                                                                           |
|SClick               |open.PNG                                                                                           |
|pause                |2000                                                                                               |
|SWait                |upload_small.PNG                                                                                   |
|SClick               |upload_small.PNG                                                                                   |
|pause                |2000                                                                                               |
|click                |id=btnProcessFile                  |                                                               |
|pause                |1500                                                                                               |
|waitForElementPresent|//tr[@id='8']                                                                                      |
|pause                |20000                                                                                              |
|verifyText           |//div[@id='divBatchResults']/table/| |generated unique DSS key pair for ${BatchImportedSystemName} |
|$res=                |CLI                                |${CLIBatch} ListSystems --SystemName ${BatchImportedSystemName}|
|Verify_Contain_OR    |$res;;${BatchImportedSystemName}   |                                                               |
|Choose system        |${BatchImportedSystemName}                                                                         |
|click                |id=bt_Test                                                                                         |
|waitForTextPresent   |*from the test of system*                                                                          |
|verifyText           |//div[@id='ResultDetailDiv']       | |failed                                                       |
|click                |id=Details                                                                                         |
|pause                |1000                                                                                               |
|click                |id=Connection                                                                                      |
|pause                |1000                                                                                               |
|click                |id=btDnldSpcOpenSSH                                                                                |
|pause                |30000                                                                                              |
|Upload System Public Key                                                                                                 |
|pause                |10000                                                                                              |
|click                |id=bt_Test                                                                                         |
|waitForTextPresent   |*from the test of system*                                                                          |
|verifyText           |//div[@id='ResultDetailDiv']       | |successful                                                   |
|Remove system        |${BatchImportedSystemName}                                                                         |
|Hard-Delete System   |${BatchImportedSystemName}                                                                         |


!|scenario        |Check Duplicated Platform                                                                      |
|$res=            |GroovyWebDriver|CheckDuplicatedJumpBoxPLatform;${TPAMHost};${CustomPlatformName};${JumpBoxName}|
|Verify_Contain_OR|$res;;All controls are fine                                                                    |

