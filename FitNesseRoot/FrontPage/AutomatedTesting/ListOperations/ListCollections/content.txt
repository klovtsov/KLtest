!include -c <AutomatedTesting.UsersTests.UserTypes.ScenarioLibrary


!define CSVEthalonFile {${ProjDir}\Scripts\Ethalons\ListOperations\Export\ExportCollections.csv}
!define ASPEthalonFile {${ProjDir}\Scripts\Ethalons\ListOperations\Export\ExportCollections.xls}
!define CSVResultFile {${ProjDir}\Scripts\Ethalons\ListOperations\ExportCollections.csv}
!define ASPResultFile {${ProjDir}\Scripts\Ethalons\ListOperations\ExportCollections.xls}

!define CSVMembersEthalonFile {${ProjDir}\Scripts\Ethalons\ListOperations\Export\ExportCollectionMembers.csv}
!define ASPMembersEthalonFile {${ProjDir}\Scripts\Ethalons\ListOperations\Export\ExportCollectionMembers.xls}
!define CSVMembersResultFile {${ProjDir}\Scripts\Ethalons\ListOperations\ExportCollectionMembers.csv}
!define ASPMembersResultFile {${ProjDir}\Scripts\Ethalons\ListOperations\ExportCollectionMembers.xls}

!define PathResultFile {${ProjDir}\Scripts\Ethalons\ListOperations\}

!define SystemName {${prefix}ListSystem}
!define SystemName1 {${SystemName}1}
!define SystemName2 {${SystemName}12}
!define SystemName3 {${SystemName}13}

!define AccountName {${prefix}ListAccount}
!define AccountName1 {${AccountName}1}
!define AccountName2 {${AccountName}12}

!define CollectionName {${prefix}ListCollection}
!define CollectionName1 {${CollectionName}1}
!define CollectionName2 {${CollectionName}12}
!define CollectionName3 {${CollectionName}13}

!define UserName {${prefix}ListUser}
!define UserName1 {${UserName}1}
!define UserName2 {${UserName}2}
!define UserName3 {${UserName}3}

!define GroupName {${prefix}ListGroup}
!define GroupName1 {${GroupName}1}

!define FilePath {${ProjDir}\Scripts\Ethalons\ListOperations\}

!define FileName {${prefix}ListFile}
!define FileName1 {${FileName}1}
!define FileName2 {${FileName}12}

!define FileEmailAddr {${prefix}ListFile@email.com}

!include -c <AutomatedTesting.EmailScenarios.ScenarioLibrary
!include -c <AutomatedTesting.ListOperations.ScenarioLibrary
!include -c <AutomatedTesting.UsersTests.UserTypes.ScenarioLibrary

!|script                                                                                                                                                                    |
|Open                 |${TPAMURL}    ||${TPAMAdmin}                                                                                          ||${DefaultPwd}                |
|Add User             |${CLIBatch}   ||--UserName ${UserName1} --FirstName Mr --LastName White                                               ||successfully                 |
|Add User             |${CLIBatch}   ||--UserName ${UserName2} --FirstName Mr --LastName Black                                               ||successfully                 |
|Add User             |${CLIBatch}   ||--UserName ${UserName3} --FirstName Mr --LastName Red                                                 ||successfully                 |
|Add Group            |${CLIBatch}   ||--GroupName ${GroupName1}                                                                             ||successfully                 |
|Add Grp member       |${CLIBatch}   ||--GroupName ${GroupName1} --UserName ${UserName2}                                                     ||successfully                 |
|Add System           |${CLIBatch}   ||--SystemName ${SystemName1} --Platform Windows --NetworkAddress 1.1.1.1                               ||successfully                 |
|Add System           |${CLIBatch}   ||--SystemName ${SystemName2} --Platform Windows --NetworkAddress 1.1.1.1                               ||successfully                 |
|Add System           |${CLIBatch}   ||--SystemName ${SystemName3} --Platform Windows --NetworkAddress 1.1.1.1                               ||successfully                 |
|Add Account          |${CLIBatch}   ||--SystemName ${SystemName1} --AccountName ${AccountName1}                                             ||successfully                 |
|Add Account          |${CLIBatch}   ||--SystemName ${SystemName1} --AccountName ${AccountName2}                                             ||successfully                 |
|Add Collection       |${CLIBatch}   ||--CollectionName ${CollectionName1}                                                                   ||successfully                 |
|Add Collection member|${CLIBatch}   ||--CollectionName ${CollectionName1} --SystemName ${SystemName1} --AccountName ${AccountName1}         ||successfully                 |
|Add Collection member|${CLIBatch}   ||--CollectionName ${CollectionName1} --SystemName ${SystemName1} --AccountName ${AccountName2}         ||successfully                 |
|Add Collection       |${CLIBatch}   ||--CollectionName ${CollectionName2}                                                                   ||successfully                 |
|Add Collection member|${CLIBatch}   ||--CollectionName ${CollectionName2} --SystemName ${SystemName1} --AccountName ${AccountName1}         ||successfully                 |
|Add Collection member|${CLIBatch}   ||--CollectionName ${CollectionName2} --SystemName ${SystemName2}                                       ||successfully                 |
|Add Collection       |${CLIBatch}   ||--CollectionName ${CollectionName3}                                                                   ||successfully                 |
|Create File          |${FilePath}   ||${FileName1}                                                                                                                         |
|Add File             |${SystemName3)||${FileName1}.txt                                                                                      ||${FileEmailAddr}||${FilePath}|
|Add Collection member|${CLIBatch}   ||--CollectionName ${CollectionName3} --SystemName ${SystemName3} --FileName ${FileName1}.txt           ||successfully                 |
|Set Access Policy    |${CLIBatch}   ||--CollectionName ${CollectionName1} --Action ADD --AccessPolicyNam Approver --UserName ${UserName1}   ||successfully                 |
|Set Access Policy    |${CLIBatch}   ||--CollectionName ${CollectionName2} --Action ADD --AccessPolicyNam Requestor --GroupName ${GroupName1}||successfully                 |
|Set Access Policy    |${CLIBatch}   ||--CollectionName ${CollectionName2} --Action ADD --AccessPolicyNam ISA --UserName ${UserName3}        ||successfully                 |
|pause                |30000                                                                                                                                                |
|List Collections With Systems                                                                                                                                              |
|List Collections With Accounts                                                                                                                                             |
|List Collections With Files                                                                                                                                                |
|Check Collections Export                                                                                                                                                   |
|Delete System        |${CLIBatch}   ||--SystemName ${SystemName1}                                                                           ||successfully                 |
|Delete System        |${CLIBatch}   ||--SystemName ${SystemName2}                                                                           ||successfully                 |
|Delete System        |${CLIBatch}   ||--SystemName ${SystemName3}                                                                           ||successfully                 |
|Drop Collection      |${CLIBatch}   ||--CollectionName ${CollectionName1}                                                                   ||successfully                 |
|Drop Collection      |${CLIBatch}   ||--CollectionName ${CollectionName2}                                                                   ||successfully                 |
|Drop Collection      |${CLIBatch}   ||--CollectionName ${CollectionName3}                                                                   ||successfully                 |
|Delete User          |${CLIBatch}   ||--UserName ${UserName1}                                                                               ||successfully                 |
|Delete User          |${CLIBatch}   ||--UserName ${UserName2}                                                                               ||successfully                 |
|Delete User          |${CLIBatch}   ||--UserName ${UserName3}                                                                               ||successfully                 |
|Drop Group           |${CLIBatch}   ||--GroupName ${GroupName1}                                                                             ||successfully                 |


