!define SyncPasswordName {${prefix}Parole}
!define SincPwdInitialValue {T0PsecreT}
!define SyncPwdCheckProfile {${PpmCheckProfile}}
!define SyncPwdChangeProfile {${PpmChangeProfile}}
!define relNotifyEmail {aaa@bbb.info}
!define syncPwdDescr {Test}
!define newPwdCheckProfile {PersPassCheckProfile_1}
!define newPwdChangeProfile {Daily}

!include -c <PowerShellNetApiScenarios.ScenarioLibrary
#!include -c >BugWorkAround
!3 Profile Names
!|script                                                                                                                                           |
|Add Sync Password   |${SyncPasswordName}|with options|-passwordCheckProfile ${SyncPwdCheckProfile} -passwordChangeProfile  ${SyncPwdChangeProfile}|
|List Sync Password properties|syncPassName,PasswordCheckProfile,PasswordChangeProfile|contains    |${SyncPasswordName}\s+${SyncPwdCheckProfile}\s+${SyncPwdChangeProfile}                      |
|Delete Sync Password|${SyncPasswordName}                                                                                                          |

!|script                                                                                                                                                                                               |
|Add Sync Password            |${SyncPasswordName}                                                  |with options|-passwordChangeProfile  ${SyncPwdChangeProfile} -ReleaseNotifyEmail ${relNotifyEmail}|
|List Sync Password properties|syncPassName,UseAccountLevelCheckProfileFl,RelNotifyEmail,PwdRuleName|contains    |${SyncPasswordName}\s+Y\s+${relNotifyEmail}\s+Default                                |
|Delete Sync Password         |${SyncPasswordName}                                                                                                                                                     |

!|script                                                                                                                                                                          |
|Add Sync Password            |${SyncPasswordName}                  |with options|-passwordChangeProfile  ${SyncPwdChangeProfile} -ReleaseDuration 45 -Description ${syncPwdDescr}|
|List Sync Password properties|syncPassName,PostReqReset,Description|contains    |${SyncPasswordName}\s+45\s+${syncPwdDescr}                                                      |
|Delete Sync Password         |${SyncPasswordName}                                                                                                                                |

!3 Update Sync password command
!|script                                                                                                                                                                                                                       |
|Add Sync Password            |${SyncPasswordName}                                                                   |with options|-passwordCheckProfile ${SyncPwdCheckProfile} -passwordChangeProfile  ${SyncPwdChangeProfile}|
|Update Sync Password         |${SyncPasswordName}                                                                   |with options|-passwordCheckProfile ${newPwdCheckProfile} -passwordChangeProfile  ${newPwdChangeProfile}  |
|List Sync Password properties|syncPassName,passwordCheckProfile,passwordChangeProfile,UseAccountLevelCheckProfileFl|contains    |${SyncPasswordName}\s+${newPwdCheckProfile}\s+${newPwdChangeProfile}\s+N                    |
|Update Sync Password         |${SyncPasswordName}                                                                   |with options|-AccountLevelCheckProfile Y                                                                 |
|List Sync Password properties|syncPassName,UseAccountLevelCheckProfileFl                                            |contains    |${SyncPasswordName}\s+Y                                                                     |
|Delete Sync Password         |${SyncPasswordName}                                                                                                                                                                             |
