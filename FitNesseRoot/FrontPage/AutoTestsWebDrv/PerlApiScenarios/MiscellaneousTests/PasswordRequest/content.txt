!define SystemName {${prefix}PerlSystem1}
!define AccountName {${prefix}PerlAccount1}
!define Requestor {${prefix}PRequestor}
!define Approver {${prefix}PApprover}

!define authFile2 {${PathToKeys}${API_user_2}}
!define PerlAPIparams2 {--keyFileName=${authFile2};--apiuserName=${API_user_2};--host=${TPAMHost}}

!|script                                                                                                                |
|Add System |${PerlAPIparams}||--SystemName=${SystemName};--PlatformName=Windows;--NetworkAddress=x.x.x.x  ||successfull|
|Add Account|${PerlAPIparams}||--SystemName=${SystemName};--AccountName=${AccountName};--Password=PAssword1||successfull|


!|script                                                                                                                                       |
|NewAddUser       |${PerlAPIparams}||--UserName=${Requestor};--FirstName=fname;--LastName=lname                                   ||successfull|
|NewAddUser       |${PerlAPIparams}||--UserName=${Approver};--FirstName=fname;--LastName=lname                                    ||successfull|
|Set Access Policy|${PerlAPIparams}||--UserName=${Requestor};--Action=add;--accessPolicyName=Requestor;--systemname=${SystemName} ||successfull|
|Set Access Policy|${PerlAPIparams}||--UserName=${Approver};--Action=add;--accessPolicyName=Approver;--systemname=${SystemName}   ||successfull|
|Set Access Policy|${PerlAPIparams}||--UserName=${API_user_1};--Action=add;--accessPolicyName=Requestor;--systemname=${SystemName}||successfull|
|Set Access Policy|${PerlAPIparams}||--UserName=${API_user_2};--Action=add;--accessPolicyName=Approver;--systemname=${SystemName} ||successfull|



addPwdRequest, approve, cancel, getPwdRequest, listAcctsForPwdRequest, listRequest, listRequestDetails, retrieve

!|script                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|List Accts For Pwd Request|${PerlAPIparams} ||--SystemName=${SystemName};--AccountName=${AccountName}                                                                       ||systemName: ${SystemName}.*accountName: ${AccountName}.*nowFl: N.*details: Approval Required.*reqID: .*maxReleaseDuration: 10080.*requireTixForRequest: N.*ticketSystem: .*lastReleaseDt: .*description: .*totalRows: 1.*acctLockFl: N.*policyName: Requestor.*minApprovers: 1|
|Add Pwd Request           |${PerlAPIparams} ||--SystemName=${SystemName};--AccountName=${AccountName};--ForUser=${Requestor};--ReleaseDuration=60;--RequestNotes=checkonetwo||RequestID.*for password release of ${SystemName}.*${AccountName} has been submitted.*The current status is Pending Approval                                                                                                                                                   |
|Approve                   |${PerlAPIparams2}||--RequestID=$RequestID;--Comment=OK                                                                                           ||Approved.*The response for Password RequestID.*for ${SystemName}.*${AccountName} was submitted successfully                                                                                                                                                                   |
|Set Access Policy         |${PerlAPIparams} ||--UserName=${API_user_2};--Action=add;--accessPolicyName=ISA;--systemname=${SystemName}                                       ||successfull                                                                                                                                                                                                                                                                   |
|Get Pwd Request           |${PerlAPIparams2}||--RequestID=$RequestID                                                                                                        ||requestID: $RequestID.*requestorName: ${Requestor}.*systemName: ${SystemName}.*accountName: ${AccountName}.*minApprovers: 1.*releaseDuration: 60.*requestNotes: checkonetwo.*requestStatus: Active.*Approved.*accessPolicyName: Requestor                                    |
|List Request              |${PerlAPIparams2}||--status=All;--requestorName=${Requestor};--accountName=${AccountName};--SystemName=${SystemName}                             ||requestID: $RequestID.*userName: ${Requestor}.*userFullName: lname, fname.*systemName: ${SystemName}.*accountName: ${AccountName}.*status: Active.*Approved.*accessPolicyName: Requestor                                                                                      |
|List Request Details      |${PerlAPIparams2}||--status=All;--requestorName=${Requestor};--accountName=${AccountName};--SystemName=${SystemName}                             ||requestID: $RequestID.*userName: ${Requestor}.*userFullName: lname, fname.*systemName: ${SystemName}.*accountName: ${AccountName}.*status: Active.*Approved.*accessPolicyName: Requestor                                                                                      |
|Retrieve                  |${PerlAPIparams2}||--RequestID=$RequestID                                                                                                        ||PAssword1                                                                                                                                                                                                                                                                     |
|Retrieve                  |${PerlAPIparams2}||--accountName=${AccountName};--SystemName=${SystemName}                                                                       ||PAssword1                                                                                                                                                                                                                                                                     |
|Cancel                    |${PerlAPIparams2}||--RequestID=$RequestID;--Comment=OK                                                                                           ||Canceled.*The response for Password RequestID: $RequestID.*for ${SystemName}.*${AccountName} was submitted successfully                                                                                                                                                       |



!|script                                                             |
|NewDeleteUser|${PerlAPIparams}||--UserName=${Requestor}||successfull|
|NewDeleteUser|${PerlAPIparams}||--UserName=${Approver} ||successfull|

!|script                                                                |
|Delete System|${PerlAPIparams}||--SystemName=${SystemName}||successfull|

