!include -c <AutoTestsWebDrv.ScenarioLibrary
!include -c <AutoTestsWebDrv.CliScenarios.ScenarioLibrary
!include -c <AutoTestsWebDrv.EspcwClientScenarios.DomainUser.ScenarioLibrary
!include -c <AutoTestsWebDrv.EspcwClientScenarios.LocalUser.ExecuteCommandBefore.TestSpecific

!define FileName {before}

!|script                                                                                                                                                   |
|Create bat file on system|${FileName}      |on             |${DMSystemAddress}                                                                            |
|Check Checkbox           |preenabled       |for user       |DEFAULT                                                                                       |
|Set Pre Command          |cmd.exe          |with parameters|/c c:\test\${FileName}.bat|cmd path|C:\windows\system32|for user|DEFAULT|on|${DMSystemAddress}|
|Reset Password           |${ManagedAccount}|               |${ResetPasswordSuccessful}                                                                    |
|pause                    |${ExecDelay}                                                                                                                    |
|Check Log File           |${FileName}.log  |with result    |File exists               |on      |${DMSystemAddress}                                        |
|Delete files on          |${DMSystemAddress}                                                                                                              |
|Create bat file on system|${FileName}      |on             |${DMSystemAddress}                                                                            |
|Uncheck Checkbox         |preenabled       |for user       |DEFAULT                                                                                       |
|Reset Password           |${ManagedAccount}|               |${ResetPasswordSuccessful}                                                                    |
|pause                    |${ExecDelay}                                                                                                                    |
|Check Log File           |${FileName}.log  |with result    |File does not exist       |on      |${DMSystemAddress}                                        |
|Delete files on          |${DMSystemAddress}                                                                                                              |
