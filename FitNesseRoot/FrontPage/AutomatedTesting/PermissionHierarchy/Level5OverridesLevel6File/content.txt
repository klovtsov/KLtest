!* Test description
A group has permissions for a collection of files and for a file directly.
Permission on system should have a precedence
*!
!include <AutomatedTesting.PlatformsTesting.WindowsLocalHost
!define FileName {${UserPrefix}TestFile}
!define FilePath {c:\}
!define FileDesc {${UserPrefix}FileDesc} 
!define FileEmailAddr {${UserPrefix}FileEmailAddr0@tpam.spb.qsft}

!define GroupName {${prefix}grp}
!define CollectionName {${prefix}AccntColtn}

!define OverlappedPolicy {Requestor}
!define lowLevelType {collection}
!define lowLevelObjectName {${CollectionName}}
!define lowLevelSubjectType {group}
!define lowLevelSubjectName {${GroupName}}

!define OverlappingPolicy {Approver}
!define upLevelType {file}
!define upLevelObjectName {${FileName}}
!define upLevelSubjectType {group}
!define upLevelSubjectName {${GroupName}}

!*> Include section
!include -c <AutomatedTesting.ScenarioLibrary
!include -c <AutomatedTesting.EmailScenarios.ScenarioLibrary
!include -c <AutomatedTesting.EmailScenarios.FilesNotifications.ScenarioLibrary
!include -c <AutomatedTesting.CliScenarios.ScenarioLibrary
!include -c ScenarioLibrary
*!
!*> Create Environment
!|script                                                              |
|Add Group|${GroupName}|
|Add User To Group|${Requestor}||${GroupName}|
|Add system                                                           |
|Add Collection        |${CollectionName}                             |
|Create File           |${FilePath}  ||${FileName}                    |
|Add File                                                             |
|Add File To Collection|${SystemName}||${FileName} ||${CollectionName}|

*!
!|script                                                                                                                                 |
|Set policy            |${OverlappedPolicy} |on ${lowLevelType}|${lowLevelObjectName} |for ${lowLevelSubjectType} |${lowLevelSubjectName}|
|Request File by       |${Requestor}        |with result       |submitted                                                                |
|Cancel File Request by|${Requestor}                                                                                                     |
|Set policy            |${OverlappingPolicy}|on ${upLevelType} |${upLevelObjectName}  |for  ${upLevelSubjectType} |${upLevelSubjectName} |
|pause                 |${ApplyNewPoliciesInterval}                                                                                      |
|Try to Request File by|${Requestor}                                                                                                   |
|Revoke policy         |${OverlappingPolicy}|on ${upLevelType} |${upLevelObjectName}  |for  ${upLevelSubjectType} |${upLevelSubjectName} |
|pause                 |${ApplyNewPoliciesInterval}                                                                                      |
|Request File by       |${Requestor}        |with result       |submitted                                                                |
|Cancel File Request by|${Requestor}                                                                                                     |

!*> Clean environment
!|script                                   |
|Delete File      |${FilePath}||${FileName}|
|Remove system    |${SystemName}           |
|Delete Collection|${CollectionName}       |
|Delete Group     |${GroupName}            |
*!